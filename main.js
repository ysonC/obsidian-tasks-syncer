/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var $f=Object.create;var yo=Object.defineProperty;var Bf=Object.getOwnPropertyDescriptor;var Gf=Object.getOwnPropertyNames;var qf=Object.getPrototypeOf,Vf=Object.prototype.hasOwnProperty;var E=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Pe=(r,e)=>{for(var t in e)yo(r,t,{get:e[t],enumerable:!0})},Bc=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Gf(e))!Vf.call(r,o)&&o!==t&&yo(r,o,{get:()=>e[o],enumerable:!(n=Bf(e,o))||n.enumerable});return r};var Ce=(r,e,t)=>(t=r!=null?$f(qf(r)):{},Bc(e||!r||!r.__esModule?yo(t,"default",{value:r,enumerable:!0}):t,r)),jf=r=>Bc(yo({},"__esModule",{value:!0}),r);var Gc=E((aI,Kf)=>{Kf.exports={name:"dotenv",version:"16.4.7",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard",pretest:"npm run lint && npm run dts-check",test:"tap run --allow-empty-coverage --disable-coverage --timeout=60000","test:coverage":"tap run --show-full-coverage --timeout=60000 --coverage-report=lcov",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},funding:"https://dotenvx.com",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^18.11.3",decache:"^4.6.2",sinon:"^14.0.1",standard:"^17.0.0","standard-version":"^9.5.0",tap:"^19.2.0",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var Kc=E((cI,Ve)=>{var ds=require("fs"),ls=require("path"),Yf=require("os"),zf=require("crypto"),Wf=Gc(),us=Wf.version,Qf=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function Xf(r){let e={},t=r.toString();t=t.replace(/\r\n?/mg,`
`);let n;for(;(n=Qf.exec(t))!=null;){let o=n[1],i=n[2]||"";i=i.trim();let s=i[0];i=i.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),s==='"'&&(i=i.replace(/\\n/g,`
`),i=i.replace(/\\r/g,"\r")),e[o]=i}return e}function Jf(r){let e=jc(r),t=K.configDotenv({path:e});if(!t.parsed){let s=new Error(`MISSING_DATA: Cannot parse ${e} for an unknown reason`);throw s.code="MISSING_DATA",s}let n=Vc(r).split(","),o=n.length,i;for(let s=0;s<o;s++)try{let a=n[s].trim(),c=tp(t,a);i=K.decrypt(c.ciphertext,c.key);break}catch(a){if(s+1>=o)throw a}return K.parse(i)}function Zf(r){console.log(`[dotenv@${us}][INFO] ${r}`)}function ep(r){console.log(`[dotenv@${us}][WARN] ${r}`)}function Ao(r){console.log(`[dotenv@${us}][DEBUG] ${r}`)}function Vc(r){return r&&r.DOTENV_KEY&&r.DOTENV_KEY.length>0?r.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function tp(r,e){let t;try{t=new URL(e)}catch(a){if(a.code==="ERR_INVALID_URL"){let c=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw c.code="INVALID_DOTENV_KEY",c}throw a}let n=t.password;if(!n){let a=new Error("INVALID_DOTENV_KEY: Missing key part");throw a.code="INVALID_DOTENV_KEY",a}let o=t.searchParams.get("environment");if(!o){let a=new Error("INVALID_DOTENV_KEY: Missing environment part");throw a.code="INVALID_DOTENV_KEY",a}let i=`DOTENV_VAULT_${o.toUpperCase()}`,s=r.parsed[i];if(!s){let a=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${i} in your .env.vault file.`);throw a.code="NOT_FOUND_DOTENV_ENVIRONMENT",a}return{ciphertext:s,key:n}}function jc(r){let e=null;if(r&&r.path&&r.path.length>0)if(Array.isArray(r.path))for(let t of r.path)ds.existsSync(t)&&(e=t.endsWith(".vault")?t:`${t}.vault`);else e=r.path.endsWith(".vault")?r.path:`${r.path}.vault`;else e=ls.resolve(process.cwd(),".env.vault");return ds.existsSync(e)?e:null}function qc(r){return r[0]==="~"?ls.join(Yf.homedir(),r.slice(1)):r}function rp(r){Zf("Loading env from encrypted .env.vault");let e=K._parseVault(r),t=process.env;return r&&r.processEnv!=null&&(t=r.processEnv),K.populate(t,e,r),{parsed:e}}function np(r){let e=ls.resolve(process.cwd(),".env"),t="utf8",n=!!(r&&r.debug);r&&r.encoding?t=r.encoding:n&&Ao("No encoding is specified. UTF-8 is used by default");let o=[e];if(r&&r.path)if(!Array.isArray(r.path))o=[qc(r.path)];else{o=[];for(let c of r.path)o.push(qc(c))}let i,s={};for(let c of o)try{let d=K.parse(ds.readFileSync(c,{encoding:t}));K.populate(s,d,r)}catch(d){n&&Ao(`Failed to load ${c} ${d.message}`),i=d}let a=process.env;return r&&r.processEnv!=null&&(a=r.processEnv),K.populate(a,s,r),i?{parsed:s,error:i}:{parsed:s}}function op(r){if(Vc(r).length===0)return K.configDotenv(r);let e=jc(r);return e?K._configVault(r):(ep(`You set DOTENV_KEY but you are missing a .env.vault file at ${e}. Did you forget to build it?`),K.configDotenv(r))}function ip(r,e){let t=Buffer.from(e.slice(-64),"hex"),n=Buffer.from(r,"base64"),o=n.subarray(0,12),i=n.subarray(-16);n=n.subarray(12,-16);try{let s=zf.createDecipheriv("aes-256-gcm",t,o);return s.setAuthTag(i),`${s.update(n)}${s.final()}`}catch(s){let a=s instanceof RangeError,c=s.message==="Invalid key length",d=s.message==="Unsupported state or unable to authenticate data";if(a||c){let l=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw l.code="INVALID_DOTENV_KEY",l}else if(d){let l=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw l.code="DECRYPTION_FAILED",l}else throw s}}function sp(r,e,t={}){let n=!!(t&&t.debug),o=!!(t&&t.override);if(typeof e!="object"){let i=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw i.code="OBJECT_REQUIRED",i}for(let i of Object.keys(e))Object.prototype.hasOwnProperty.call(r,i)?(o===!0&&(r[i]=e[i]),n&&Ao(o===!0?`"${i}" is already defined and WAS overwritten`:`"${i}" is already defined and was NOT overwritten`)):r[i]=e[i]}var K={configDotenv:np,_configVault:rp,_parseVault:Jf,config:op,decrypt:ip,parse:Xf,populate:sp};Ve.exports.configDotenv=K.configDotenv;Ve.exports._configVault=K._configVault;Ve.exports._parseVault=K._parseVault;Ve.exports.config=K.config;Ve.exports.decrypt=K.decrypt;Ve.exports.parse=K.parse;Ve.exports.populate=K.populate;Ve.exports=K});var Gr=E((Ha,Fd)=>{var gi=require("buffer"),Fe=gi.Buffer;function Hd(r,e){for(var t in r)e[t]=r[t]}Fe.from&&Fe.alloc&&Fe.allocUnsafe&&Fe.allocUnsafeSlow?Fd.exports=gi:(Hd(gi,Ha),Ha.Buffer=lr);function lr(r,e,t){return Fe(r,e,t)}lr.prototype=Object.create(Fe.prototype);Hd(Fe,lr);lr.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return Fe(r,e,t)};lr.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=Fe(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};lr.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Fe(r)};lr.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return gi.SlowBuffer(r)}});var Fa=E((eN,$d)=>{var Ei=Gr().Buffer,_m=require("stream"),Rm=require("util");function Ti(r){if(this.buffer=null,this.writable=!0,this.readable=!0,!r)return this.buffer=Ei.alloc(0),this;if(typeof r.pipe=="function")return this.buffer=Ei.alloc(0),r.pipe(this),this;if(r.length||typeof r=="object")return this.buffer=r,this.writable=!1,process.nextTick(function(){this.emit("end",r),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof r+")")}Rm.inherits(Ti,_m);Ti.prototype.write=function(e){this.buffer=Ei.concat([this.buffer,Ei.from(e)]),this.emit("data",e)};Ti.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};$d.exports=Ti});var Gd=E((tN,Bd)=>{"use strict";var Xn=require("buffer").Buffer,$a=require("buffer").SlowBuffer;Bd.exports=yi;function yi(r,e){if(!Xn.isBuffer(r)||!Xn.isBuffer(e)||r.length!==e.length)return!1;for(var t=0,n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}yi.install=function(){Xn.prototype.equal=$a.prototype.equal=function(e){return yi(this,e)}};var km=Xn.prototype.equal,wm=$a.prototype.equal;yi.restore=function(){Xn.prototype.equal=km,$a.prototype.equal=wm}});var Vd=E((rN,qd)=>{"use strict";function Ba(r){var e=(r/8|0)+(r%8===0?0:1);return e}var Om={ES256:Ba(256),ES384:Ba(384),ES512:Ba(521)};function Nm(r){var e=Om[r];if(e)return e;throw new Error('Unknown algorithm "'+r+'"')}qd.exports=Nm});var Xd=E((nN,Qd)=>{"use strict";var Ai=Gr().Buffer,Kd=Vd(),Ci=128,Yd=0,vm=32,bm=16,Mm=2,zd=bm|vm|Yd<<6,Ii=Mm|Yd<<6;function Pm(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Wd(r){if(Ai.isBuffer(r))return r;if(typeof r=="string")return Ai.from(r,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function Dm(r,e){r=Wd(r);var t=Kd(e),n=t+1,o=r.length,i=0;if(r[i++]!==zd)throw new Error('Could not find expected "seq"');var s=r[i++];if(s===(Ci|1)&&(s=r[i++]),o-i<s)throw new Error('"seq" specified length of "'+s+'", only "'+(o-i)+'" remaining');if(r[i++]!==Ii)throw new Error('Could not find expected "int" for "r"');var a=r[i++];if(o-i-2<a)throw new Error('"r" specified length of "'+a+'", only "'+(o-i-2)+'" available');if(n<a)throw new Error('"r" specified length of "'+a+'", max of "'+n+'" is acceptable');var c=i;if(i+=a,r[i++]!==Ii)throw new Error('Could not find expected "int" for "s"');var d=r[i++];if(o-i!==d)throw new Error('"s" specified length of "'+d+'", expected "'+(o-i)+'"');if(n<d)throw new Error('"s" specified length of "'+d+'", max of "'+n+'" is acceptable');var l=i;if(i+=d,i!==o)throw new Error('Expected to consume entire buffer, but "'+(o-i)+'" bytes remain');var u=t-a,g=t-d,m=Ai.allocUnsafe(u+a+g+d);for(i=0;i<u;++i)m[i]=0;r.copy(m,i,c+Math.max(-u,0),c+a),i=t;for(var A=i;i<A+g;++i)m[i]=0;return r.copy(m,i,l+Math.max(-g,0),l+d),m=m.toString("base64"),m=Pm(m),m}function jd(r,e,t){for(var n=0;e+n<t&&r[e+n]===0;)++n;var o=r[e+n]>=Ci;return o&&--n,n}function xm(r,e){r=Wd(r);var t=Kd(e),n=r.length;if(n!==t*2)throw new TypeError('"'+e+'" signatures must be "'+t*2+'" bytes, saw "'+n+'"');var o=jd(r,0,t),i=jd(r,t,r.length),s=t-o,a=t-i,c=2+s+1+1+a,d=c<Ci,l=Ai.allocUnsafe((d?2:3)+c),u=0;return l[u++]=zd,d?l[u++]=c:(l[u++]=Ci|1,l[u++]=c&255),l[u++]=Ii,l[u++]=s,o<0?(l[u++]=0,u+=r.copy(l,u,0,t)):u+=r.copy(l,u,o,t),l[u++]=Ii,l[u++]=a,i<0?(l[u++]=0,r.copy(l,u,t)):r.copy(l,u,t+i),l}Qd.exports={derToJose:Dm,joseToDer:xm}});var Va=E((oN,sl)=>{var Lm=Gd(),Vr=Gr().Buffer,$e=require("crypto"),Zd=Xd(),Jd=require("util"),Um=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,Jn="secret must be a string or buffer",qr="key must be a string or a buffer",Hm="key must be a string, a buffer or an object",Ga=typeof $e.createPublicKey=="function";Ga&&(qr+=" or a KeyObject",Jn+="or a KeyObject");function el(r){if(!Vr.isBuffer(r)&&typeof r!="string"&&(!Ga||typeof r!="object"||typeof r.type!="string"||typeof r.asymmetricKeyType!="string"||typeof r.export!="function"))throw Me(qr)}function tl(r){if(!Vr.isBuffer(r)&&typeof r!="string"&&typeof r!="object")throw Me(Hm)}function Fm(r){if(!Vr.isBuffer(r)){if(typeof r=="string")return r;if(!Ga||typeof r!="object"||r.type!=="secret"||typeof r.export!="function")throw Me(Jn)}}function qa(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function rl(r){r=r.toString();var e=4-r.length%4;if(e!==4)for(var t=0;t<e;++t)r+="=";return r.replace(/\-/g,"+").replace(/_/g,"/")}function Me(r){var e=[].slice.call(arguments,1),t=Jd.format.bind(Jd,r).apply(null,e);return new TypeError(t)}function $m(r){return Vr.isBuffer(r)||typeof r=="string"}function Zn(r){return $m(r)||(r=JSON.stringify(r)),r}function nl(r){return function(t,n){Fm(n),t=Zn(t);var o=$e.createHmac("sha"+r,n),i=(o.update(t),o.digest("base64"));return qa(i)}}function Bm(r){return function(t,n,o){var i=nl(r)(t,o);return Lm(Vr.from(n),Vr.from(i))}}function ol(r){return function(t,n){tl(n),t=Zn(t);var o=$e.createSign("RSA-SHA"+r),i=(o.update(t),o.sign(n,"base64"));return qa(i)}}function il(r){return function(t,n,o){el(o),t=Zn(t),n=rl(n);var i=$e.createVerify("RSA-SHA"+r);return i.update(t),i.verify(o,n,"base64")}}function Gm(r){return function(t,n){tl(n),t=Zn(t);var o=$e.createSign("RSA-SHA"+r),i=(o.update(t),o.sign({key:n,padding:$e.constants.RSA_PKCS1_PSS_PADDING,saltLength:$e.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return qa(i)}}function qm(r){return function(t,n,o){el(o),t=Zn(t),n=rl(n);var i=$e.createVerify("RSA-SHA"+r);return i.update(t),i.verify({key:o,padding:$e.constants.RSA_PKCS1_PSS_PADDING,saltLength:$e.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function Vm(r){var e=ol(r);return function(){var n=e.apply(null,arguments);return n=Zd.derToJose(n,"ES"+r),n}}function jm(r){var e=il(r);return function(n,o,i){o=Zd.joseToDer(o,"ES"+r).toString("base64");var s=e(n,o,i);return s}}function Km(){return function(){return""}}function Ym(){return function(e,t){return t===""}}sl.exports=function(e){var t={hs:nl,rs:ol,ps:Gm,es:Vm,none:Km},n={hs:Bm,rs:il,ps:qm,es:jm,none:Ym},o=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!o)throw Me(Um,e);var i=(o[1]||o[3]).toLowerCase(),s=o[2];return{sign:t[i](s),verify:n[i](s)}}});var ja=E((iN,al)=>{var zm=require("buffer").Buffer;al.exports=function(e){return typeof e=="string"?e:typeof e=="number"||zm.isBuffer(e)?e.toString():JSON.stringify(e)}});var fl=E((sN,hl)=>{var Wm=Gr().Buffer,cl=Fa(),Qm=Va(),Xm=require("stream"),dl=ja(),Ka=require("util");function ll(r,e){return Wm.from(r,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Jm(r,e,t){t=t||"utf8";var n=ll(dl(r),"binary"),o=ll(dl(e),t);return Ka.format("%s.%s",n,o)}function ul(r){var e=r.header,t=r.payload,n=r.secret||r.privateKey,o=r.encoding,i=Qm(e.alg),s=Jm(e,t,o),a=i.sign(s,n);return Ka.format("%s.%s",s,a)}function Si(r){var e=r.secret||r.privateKey||r.key,t=new cl(e);this.readable=!0,this.header=r.header,this.encoding=r.encoding,this.secret=this.privateKey=this.key=t,this.payload=new cl(r.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}Ka.inherits(Si,Xm);Si.prototype.sign=function(){try{var e=ul({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}};Si.sign=ul;hl.exports=Si});var Sl=E((aN,Il)=>{var ml=Gr().Buffer,pl=Fa(),Zm=Va(),eg=require("stream"),gl=ja(),tg=require("util"),rg=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function ng(r){return Object.prototype.toString.call(r)==="[object Object]"}function og(r){if(ng(r))return r;try{return JSON.parse(r)}catch(e){return}}function El(r){var e=r.split(".",1)[0];return og(ml.from(e,"base64").toString("binary"))}function ig(r){return r.split(".",2).join(".")}function Tl(r){return r.split(".")[2]}function sg(r,e){e=e||"utf8";var t=r.split(".")[1];return ml.from(t,"base64").toString(e)}function yl(r){return rg.test(r)&&!!El(r)}function Al(r,e,t){if(!e){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}r=gl(r);var o=Tl(r),i=ig(r),s=Zm(e);return s.verify(i,o,t)}function Cl(r,e){if(e=e||{},r=gl(r),!yl(r))return null;var t=El(r);if(!t)return null;var n=sg(r);return(t.typ==="JWT"||e.json)&&(n=JSON.parse(n,e.encoding)),{header:t,payload:n,signature:Tl(r)}}function jr(r){r=r||{};var e=r.secret||r.publicKey||r.key,t=new pl(e);this.readable=!0,this.algorithm=r.algorithm,this.encoding=r.encoding,this.secret=this.publicKey=this.key=t,this.signature=new pl(r.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}tg.inherits(jr,eg);jr.prototype.verify=function(){try{var e=Al(this.signature.buffer,this.algorithm,this.key.buffer),t=Cl(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};jr.decode=Cl;jr.isValid=yl;jr.verify=Al;Il.exports=jr});var Ri=E(St=>{var _l=fl(),_i=Sl(),ag=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];St.ALGORITHMS=ag;St.sign=_l.sign;St.verify=_i.verify;St.decode=_i.decode;St.isValid=_i.isValid;St.createSign=function(e){return new _l(e)};St.createVerify=function(e){return new _i(e)}});var Ya=E((dN,Rl)=>{var cg=Ri();Rl.exports=function(r,e){e=e||{};var t=cg.decode(r,e);if(!t)return null;var n=t.payload;if(typeof n=="string")try{var o=JSON.parse(n);o!==null&&typeof o=="object"&&(n=o)}catch(i){}return e.complete===!0?{header:t.header,payload:n,signature:t.signature}:n}});var eo=E((lN,kl)=>{var ki=function(r,e){Error.call(this,r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=r,e&&(this.inner=e)};ki.prototype=Object.create(Error.prototype);ki.prototype.constructor=ki;kl.exports=ki});var za=E((uN,Ol)=>{var wl=eo(),wi=function(r,e){wl.call(this,r),this.name="NotBeforeError",this.date=e};wi.prototype=Object.create(wl.prototype);wi.prototype.constructor=wi;Ol.exports=wi});var Wa=E((hN,vl)=>{var Nl=eo(),Oi=function(r,e){Nl.call(this,r),this.name="TokenExpiredError",this.expiredAt=e};Oi.prototype=Object.create(Nl.prototype);Oi.prototype.constructor=Oi;vl.exports=Oi});var Ml=E((fN,bl)=>{var Kr=1e3,Yr=Kr*60,zr=Yr*60,ur=zr*24,dg=ur*7,lg=ur*365.25;bl.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return ug(r);if(t==="number"&&isFinite(r))return e.long?fg(r):hg(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function ug(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*lg;case"weeks":case"week":case"w":return t*dg;case"days":case"day":case"d":return t*ur;case"hours":case"hour":case"hrs":case"hr":case"h":return t*zr;case"minutes":case"minute":case"mins":case"min":case"m":return t*Yr;case"seconds":case"second":case"secs":case"sec":case"s":return t*Kr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function hg(r){var e=Math.abs(r);return e>=ur?Math.round(r/ur)+"d":e>=zr?Math.round(r/zr)+"h":e>=Yr?Math.round(r/Yr)+"m":e>=Kr?Math.round(r/Kr)+"s":r+"ms"}function fg(r){var e=Math.abs(r);return e>=ur?Ni(r,e,ur,"day"):e>=zr?Ni(r,e,zr,"hour"):e>=Yr?Ni(r,e,Yr,"minute"):e>=Kr?Ni(r,e,Kr,"second"):r+" ms"}function Ni(r,e,t,n){var o=e>=t*1.5;return Math.round(r/t)+" "+n+(o?"s":"")}});var Qa=E((pN,Pl)=>{var pg=Ml();Pl.exports=function(r,e){var t=e||Math.floor(Date.now()/1e3);if(typeof r=="string"){var n=pg(r);return typeof n=="undefined"?void 0:Math.floor(t+n/1e3)}else return typeof r=="number"?t+r:void 0}});var to=E((mN,Dl)=>{var mg="2.0.0",gg=Number.MAX_SAFE_INTEGER||9007199254740991,Eg=16,Tg=250,yg=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Dl.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Eg,MAX_SAFE_BUILD_LENGTH:Tg,MAX_SAFE_INTEGER:gg,RELEASE_TYPES:yg,SEMVER_SPEC_VERSION:mg,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var ro=E((gN,xl)=>{var Ag=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};xl.exports=Ag});var Wr=E((Be,Ll)=>{var{MAX_SAFE_COMPONENT_LENGTH:Xa,MAX_SAFE_BUILD_LENGTH:Cg,MAX_LENGTH:Ig}=to(),Sg=ro();Be=Ll.exports={};var _g=Be.re=[],Rg=Be.safeRe=[],T=Be.src=[],kg=Be.safeSrc=[],y=Be.t={},wg=0,Ja="[a-zA-Z0-9-]",Og=[["\\s",1],["\\d",Ig],[Ja,Cg]],Ng=r=>{for(let[e,t]of Og)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},_=(r,e,t)=>{let n=Ng(e),o=wg++;Sg(r,o,e),y[r]=o,T[o]=e,kg[o]=n,_g[o]=new RegExp(e,t?"g":void 0),Rg[o]=new RegExp(n,t?"g":void 0)};_("NUMERICIDENTIFIER","0|[1-9]\\d*");_("NUMERICIDENTIFIERLOOSE","\\d+");_("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Ja}*`);_("MAINVERSION",`(${T[y.NUMERICIDENTIFIER]})\\.(${T[y.NUMERICIDENTIFIER]})\\.(${T[y.NUMERICIDENTIFIER]})`);_("MAINVERSIONLOOSE",`(${T[y.NUMERICIDENTIFIERLOOSE]})\\.(${T[y.NUMERICIDENTIFIERLOOSE]})\\.(${T[y.NUMERICIDENTIFIERLOOSE]})`);_("PRERELEASEIDENTIFIER",`(?:${T[y.NUMERICIDENTIFIER]}|${T[y.NONNUMERICIDENTIFIER]})`);_("PRERELEASEIDENTIFIERLOOSE",`(?:${T[y.NUMERICIDENTIFIERLOOSE]}|${T[y.NONNUMERICIDENTIFIER]})`);_("PRERELEASE",`(?:-(${T[y.PRERELEASEIDENTIFIER]}(?:\\.${T[y.PRERELEASEIDENTIFIER]})*))`);_("PRERELEASELOOSE",`(?:-?(${T[y.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${T[y.PRERELEASEIDENTIFIERLOOSE]})*))`);_("BUILDIDENTIFIER",`${Ja}+`);_("BUILD",`(?:\\+(${T[y.BUILDIDENTIFIER]}(?:\\.${T[y.BUILDIDENTIFIER]})*))`);_("FULLPLAIN",`v?${T[y.MAINVERSION]}${T[y.PRERELEASE]}?${T[y.BUILD]}?`);_("FULL",`^${T[y.FULLPLAIN]}$`);_("LOOSEPLAIN",`[v=\\s]*${T[y.MAINVERSIONLOOSE]}${T[y.PRERELEASELOOSE]}?${T[y.BUILD]}?`);_("LOOSE",`^${T[y.LOOSEPLAIN]}$`);_("GTLT","((?:<|>)?=?)");_("XRANGEIDENTIFIERLOOSE",`${T[y.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);_("XRANGEIDENTIFIER",`${T[y.NUMERICIDENTIFIER]}|x|X|\\*`);_("XRANGEPLAIN",`[v=\\s]*(${T[y.XRANGEIDENTIFIER]})(?:\\.(${T[y.XRANGEIDENTIFIER]})(?:\\.(${T[y.XRANGEIDENTIFIER]})(?:${T[y.PRERELEASE]})?${T[y.BUILD]}?)?)?`);_("XRANGEPLAINLOOSE",`[v=\\s]*(${T[y.XRANGEIDENTIFIERLOOSE]})(?:\\.(${T[y.XRANGEIDENTIFIERLOOSE]})(?:\\.(${T[y.XRANGEIDENTIFIERLOOSE]})(?:${T[y.PRERELEASELOOSE]})?${T[y.BUILD]}?)?)?`);_("XRANGE",`^${T[y.GTLT]}\\s*${T[y.XRANGEPLAIN]}$`);_("XRANGELOOSE",`^${T[y.GTLT]}\\s*${T[y.XRANGEPLAINLOOSE]}$`);_("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Xa}})(?:\\.(\\d{1,${Xa}}))?(?:\\.(\\d{1,${Xa}}))?`);_("COERCE",`${T[y.COERCEPLAIN]}(?:$|[^\\d])`);_("COERCEFULL",T[y.COERCEPLAIN]+`(?:${T[y.PRERELEASE]})?(?:${T[y.BUILD]})?(?:$|[^\\d])`);_("COERCERTL",T[y.COERCE],!0);_("COERCERTLFULL",T[y.COERCEFULL],!0);_("LONETILDE","(?:~>?)");_("TILDETRIM",`(\\s*)${T[y.LONETILDE]}\\s+`,!0);Be.tildeTrimReplace="$1~";_("TILDE",`^${T[y.LONETILDE]}${T[y.XRANGEPLAIN]}$`);_("TILDELOOSE",`^${T[y.LONETILDE]}${T[y.XRANGEPLAINLOOSE]}$`);_("LONECARET","(?:\\^)");_("CARETTRIM",`(\\s*)${T[y.LONECARET]}\\s+`,!0);Be.caretTrimReplace="$1^";_("CARET",`^${T[y.LONECARET]}${T[y.XRANGEPLAIN]}$`);_("CARETLOOSE",`^${T[y.LONECARET]}${T[y.XRANGEPLAINLOOSE]}$`);_("COMPARATORLOOSE",`^${T[y.GTLT]}\\s*(${T[y.LOOSEPLAIN]})$|^$`);_("COMPARATOR",`^${T[y.GTLT]}\\s*(${T[y.FULLPLAIN]})$|^$`);_("COMPARATORTRIM",`(\\s*)${T[y.GTLT]}\\s*(${T[y.LOOSEPLAIN]}|${T[y.XRANGEPLAIN]})`,!0);Be.comparatorTrimReplace="$1$2$3";_("HYPHENRANGE",`^\\s*(${T[y.XRANGEPLAIN]})\\s+-\\s+(${T[y.XRANGEPLAIN]})\\s*$`);_("HYPHENRANGELOOSE",`^\\s*(${T[y.XRANGEPLAINLOOSE]})\\s+-\\s+(${T[y.XRANGEPLAINLOOSE]})\\s*$`);_("STAR","(<|>)?=?\\s*\\*");_("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");_("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var vi=E((EN,Ul)=>{var vg=Object.freeze({loose:!0}),bg=Object.freeze({}),Mg=r=>r?typeof r!="object"?vg:r:bg;Ul.exports=Mg});var Za=E((TN,$l)=>{var Hl=/^[0-9]+$/,Fl=(r,e)=>{let t=Hl.test(r),n=Hl.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},Pg=(r,e)=>Fl(e,r);$l.exports={compareIdentifiers:Fl,rcompareIdentifiers:Pg}});var oe=E((yN,Vl)=>{var bi=ro(),{MAX_LENGTH:Bl,MAX_SAFE_INTEGER:Mi}=to(),{safeRe:Gl,safeSrc:ql,t:Pi}=Wr(),Dg=vi(),{compareIdentifiers:Qr}=Za(),ec=class r{constructor(e,t){if(t=Dg(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Bl)throw new TypeError(`version is longer than ${Bl} characters`);bi("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?Gl[Pi.LOOSE]:Gl[Pi.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Mi||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Mi||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Mi||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let i=+o;if(i>=0&&i<Mi)return i}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(bi("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),Qr(this.major,e.major)||Qr(this.minor,e.minor)||Qr(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],o=e.prerelease[t];if(bi("prerelease compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Qr(n,o)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],o=e.build[t];if(bi("build compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return Qr(n,o)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let o=new RegExp(`^${this.options.loose?ql[Pi.PRERELEASELOOSE]:ql[Pi.PRERELEASE]}$`),i=`-${t}`.match(o);if(!i||i[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[o];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(t){let i=[t,o];n===!1&&(i=[t]),Qr(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Vl.exports=ec});var hr=E((AN,Kl)=>{var jl=oe(),xg=(r,e,t=!1)=>{if(r instanceof jl)return r;try{return new jl(r,e)}catch(n){if(!t)return null;throw n}};Kl.exports=xg});var zl=E((CN,Yl)=>{var Lg=hr(),Ug=(r,e)=>{let t=Lg(r,e);return t?t.version:null};Yl.exports=Ug});var Ql=E((IN,Wl)=>{var Hg=hr(),Fg=(r,e)=>{let t=Hg(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};Wl.exports=Fg});var Zl=E((SN,Jl)=>{var Xl=oe(),$g=(r,e,t,n,o)=>{typeof t=="string"&&(o=n,n=t,t=void 0);try{return new Xl(r instanceof Xl?r.version:r,t).inc(e,n,o).version}catch(i){return null}};Jl.exports=$g});var ru=E((_N,tu)=>{var eu=hr(),Bg=(r,e)=>{let t=eu(r,null,!0),n=eu(e,null,!0),o=t.compare(n);if(o===0)return null;let i=o>0,s=i?t:n,a=i?n:t,c=!!s.prerelease.length;if(!!a.prerelease.length&&!c){if(!a.patch&&!a.minor)return"major";if(a.compareMain(s)===0)return a.minor&&!a.patch?"minor":"patch"}let l=c?"pre":"";return t.major!==n.major?l+"major":t.minor!==n.minor?l+"minor":t.patch!==n.patch?l+"patch":"prerelease"};tu.exports=Bg});var ou=E((RN,nu)=>{var Gg=oe(),qg=(r,e)=>new Gg(r,e).major;nu.exports=qg});var su=E((kN,iu)=>{var Vg=oe(),jg=(r,e)=>new Vg(r,e).minor;iu.exports=jg});var cu=E((wN,au)=>{var Kg=oe(),Yg=(r,e)=>new Kg(r,e).patch;au.exports=Yg});var lu=E((ON,du)=>{var zg=hr(),Wg=(r,e)=>{let t=zg(r,e);return t&&t.prerelease.length?t.prerelease:null};du.exports=Wg});var ke=E((NN,hu)=>{var uu=oe(),Qg=(r,e,t)=>new uu(r,t).compare(new uu(e,t));hu.exports=Qg});var pu=E((vN,fu)=>{var Xg=ke(),Jg=(r,e,t)=>Xg(e,r,t);fu.exports=Jg});var gu=E((bN,mu)=>{var Zg=ke(),eE=(r,e)=>Zg(r,e,!0);mu.exports=eE});var Di=E((MN,Tu)=>{var Eu=oe(),tE=(r,e,t)=>{let n=new Eu(r,t),o=new Eu(e,t);return n.compare(o)||n.compareBuild(o)};Tu.exports=tE});var Au=E((PN,yu)=>{var rE=Di(),nE=(r,e)=>r.sort((t,n)=>rE(t,n,e));yu.exports=nE});var Iu=E((DN,Cu)=>{var oE=Di(),iE=(r,e)=>r.sort((t,n)=>oE(n,t,e));Cu.exports=iE});var no=E((xN,Su)=>{var sE=ke(),aE=(r,e,t)=>sE(r,e,t)>0;Su.exports=aE});var xi=E((LN,_u)=>{var cE=ke(),dE=(r,e,t)=>cE(r,e,t)<0;_u.exports=dE});var tc=E((UN,Ru)=>{var lE=ke(),uE=(r,e,t)=>lE(r,e,t)===0;Ru.exports=uE});var rc=E((HN,ku)=>{var hE=ke(),fE=(r,e,t)=>hE(r,e,t)!==0;ku.exports=fE});var Li=E((FN,wu)=>{var pE=ke(),mE=(r,e,t)=>pE(r,e,t)>=0;wu.exports=mE});var Ui=E(($N,Ou)=>{var gE=ke(),EE=(r,e,t)=>gE(r,e,t)<=0;Ou.exports=EE});var nc=E((BN,Nu)=>{var TE=tc(),yE=rc(),AE=no(),CE=Li(),IE=xi(),SE=Ui(),_E=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return TE(r,t,n);case"!=":return yE(r,t,n);case">":return AE(r,t,n);case">=":return CE(r,t,n);case"<":return IE(r,t,n);case"<=":return SE(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};Nu.exports=_E});var bu=E((GN,vu)=>{var RE=oe(),kE=hr(),{safeRe:Hi,t:Fi}=Wr(),wE=(r,e)=>{if(r instanceof RE)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?Hi[Fi.COERCEFULL]:Hi[Fi.COERCE]);else{let c=e.includePrerelease?Hi[Fi.COERCERTLFULL]:Hi[Fi.COERCERTL],d;for(;(d=c.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||d.index+d[0].length!==t.index+t[0].length)&&(t=d),c.lastIndex=d.index+d[1].length+d[2].length;c.lastIndex=-1}if(t===null)return null;let n=t[2],o=t[3]||"0",i=t[4]||"0",s=e.includePrerelease&&t[5]?`-${t[5]}`:"",a=e.includePrerelease&&t[6]?`+${t[6]}`:"";return kE(`${n}.${o}.${i}${s}${a}`,e)};vu.exports=wE});var Pu=E((qN,Mu)=>{var oc=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(e,t)}return this}};Mu.exports=oc});var we=E((VN,Uu)=>{var OE=/\s+/g,ic=class r{constructor(e,t){if(t=vE(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof sc)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(OE," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!xu(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&UE(o[0])){this.set=[o];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&xE)|(this.options.loose&&LE))+":"+e,o=Du.get(n);if(o)return o;let i=this.options.loose,s=i?pe[ue.HYPHENRANGELOOSE]:pe[ue.HYPHENRANGE];e=e.replace(s,YE(this.options.includePrerelease)),L("hyphen replace",e),e=e.replace(pe[ue.COMPARATORTRIM],ME),L("comparator trim",e),e=e.replace(pe[ue.TILDETRIM],PE),L("tilde trim",e),e=e.replace(pe[ue.CARETTRIM],DE),L("caret trim",e);let a=e.split(" ").map(u=>HE(u,this.options)).join(" ").split(/\s+/).map(u=>KE(u,this.options));i&&(a=a.filter(u=>(L("loose invalid filter",u,this.options),!!u.match(pe[ue.COMPARATORLOOSE])))),L("range list",a);let c=new Map,d=a.map(u=>new sc(u,this.options));for(let u of d){if(xu(u))return[u];c.set(u.value,u)}c.size>1&&c.has("")&&c.delete("");let l=[...c.values()];return Du.set(n,l),l}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>Lu(n,t)&&e.set.some(o=>Lu(o,t)&&n.every(i=>o.every(s=>i.intersects(s,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new bE(e,this.options)}catch(t){return!1}for(let t=0;t<this.set.length;t++)if(zE(this.set[t],e,this.options))return!0;return!1}};Uu.exports=ic;var NE=Pu(),Du=new NE,vE=vi(),sc=oo(),L=ro(),bE=oe(),{safeRe:pe,t:ue,comparatorTrimReplace:ME,tildeTrimReplace:PE,caretTrimReplace:DE}=Wr(),{FLAG_INCLUDE_PRERELEASE:xE,FLAG_LOOSE:LE}=to(),xu=r=>r.value==="<0.0.0-0",UE=r=>r.value==="",Lu=(r,e)=>{let t=!0,n=r.slice(),o=n.pop();for(;t&&n.length;)t=n.every(i=>o.intersects(i,e)),o=n.pop();return t},HE=(r,e)=>(L("comp",r,e),r=BE(r,e),L("caret",r),r=FE(r,e),L("tildes",r),r=qE(r,e),L("xrange",r),r=jE(r,e),L("stars",r),r),he=r=>!r||r.toLowerCase()==="x"||r==="*",FE=(r,e)=>r.trim().split(/\s+/).map(t=>$E(t,e)).join(" "),$E=(r,e)=>{let t=e.loose?pe[ue.TILDELOOSE]:pe[ue.TILDE];return r.replace(t,(n,o,i,s,a)=>{L("tilde",r,n,o,i,s,a);let c;return he(o)?c="":he(i)?c=`>=${o}.0.0 <${+o+1}.0.0-0`:he(s)?c=`>=${o}.${i}.0 <${o}.${+i+1}.0-0`:a?(L("replaceTilde pr",a),c=`>=${o}.${i}.${s}-${a} <${o}.${+i+1}.0-0`):c=`>=${o}.${i}.${s} <${o}.${+i+1}.0-0`,L("tilde return",c),c})},BE=(r,e)=>r.trim().split(/\s+/).map(t=>GE(t,e)).join(" "),GE=(r,e)=>{L("caret",r,e);let t=e.loose?pe[ue.CARETLOOSE]:pe[ue.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(o,i,s,a,c)=>{L("caret",r,o,i,s,a,c);let d;return he(i)?d="":he(s)?d=`>=${i}.0.0${n} <${+i+1}.0.0-0`:he(a)?i==="0"?d=`>=${i}.${s}.0${n} <${i}.${+s+1}.0-0`:d=`>=${i}.${s}.0${n} <${+i+1}.0.0-0`:c?(L("replaceCaret pr",c),i==="0"?s==="0"?d=`>=${i}.${s}.${a}-${c} <${i}.${s}.${+a+1}-0`:d=`>=${i}.${s}.${a}-${c} <${i}.${+s+1}.0-0`:d=`>=${i}.${s}.${a}-${c} <${+i+1}.0.0-0`):(L("no pr"),i==="0"?s==="0"?d=`>=${i}.${s}.${a}${n} <${i}.${s}.${+a+1}-0`:d=`>=${i}.${s}.${a}${n} <${i}.${+s+1}.0-0`:d=`>=${i}.${s}.${a} <${+i+1}.0.0-0`),L("caret return",d),d})},qE=(r,e)=>(L("replaceXRanges",r,e),r.split(/\s+/).map(t=>VE(t,e)).join(" ")),VE=(r,e)=>{r=r.trim();let t=e.loose?pe[ue.XRANGELOOSE]:pe[ue.XRANGE];return r.replace(t,(n,o,i,s,a,c)=>{L("xRange",r,n,o,i,s,a,c);let d=he(i),l=d||he(s),u=l||he(a),g=u;return o==="="&&g&&(o=""),c=e.includePrerelease?"-0":"",d?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&g?(l&&(s=0),a=0,o===">"?(o=">=",l?(i=+i+1,s=0,a=0):(s=+s+1,a=0)):o==="<="&&(o="<",l?i=+i+1:s=+s+1),o==="<"&&(c="-0"),n=`${o+i}.${s}.${a}${c}`):l?n=`>=${i}.0.0${c} <${+i+1}.0.0-0`:u&&(n=`>=${i}.${s}.0${c} <${i}.${+s+1}.0-0`),L("xRange return",n),n})},jE=(r,e)=>(L("replaceStars",r,e),r.trim().replace(pe[ue.STAR],"")),KE=(r,e)=>(L("replaceGTE0",r,e),r.trim().replace(pe[e.includePrerelease?ue.GTE0PRE:ue.GTE0],"")),YE=r=>(e,t,n,o,i,s,a,c,d,l,u,g)=>(he(n)?t="":he(o)?t=`>=${n}.0.0${r?"-0":""}`:he(i)?t=`>=${n}.${o}.0${r?"-0":""}`:s?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,he(d)?c="":he(l)?c=`<${+d+1}.0.0-0`:he(u)?c=`<${d}.${+l+1}.0-0`:g?c=`<=${d}.${l}.${u}-${g}`:r?c=`<${d}.${l}.${+u+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),zE=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(L(r[n].semver),r[n].semver!==sc.ANY&&r[n].semver.prerelease.length>0){let o=r[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}});var oo=E((jN,qu)=>{var io=Symbol("SemVer ANY"),dc=class r{static get ANY(){return io}constructor(e,t){if(t=Hu(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),cc("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===io?this.value="":this.value=this.operator+this.semver.version,cc("comp",this)}parse(e){let t=this.options.loose?Fu[$u.COMPARATORLOOSE]:Fu[$u.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Bu(n[2],this.options.loose):this.semver=io}toString(){return this.value}test(e){if(cc("Comparator.test",e,this.options.loose),this.semver===io||e===io)return!0;if(typeof e=="string")try{e=new Bu(e,this.options)}catch(t){return!1}return ac(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Gu(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new Gu(this.value,t).test(e.semver):(t=Hu(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||ac(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||ac(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};qu.exports=dc;var Hu=vi(),{safeRe:Fu,t:$u}=Wr(),ac=nc(),cc=ro(),Bu=oe(),Gu=we()});var so=E((KN,Vu)=>{var WE=we(),QE=(r,e,t)=>{try{e=new WE(e,t)}catch(n){return!1}return e.test(r)};Vu.exports=QE});var Ku=E((YN,ju)=>{var XE=we(),JE=(r,e)=>new XE(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));ju.exports=JE});var zu=E((zN,Yu)=>{var ZE=oe(),eT=we(),tT=(r,e,t)=>{let n=null,o=null,i=null;try{i=new eT(e,t)}catch(s){return null}return r.forEach(s=>{i.test(s)&&(!n||o.compare(s)===-1)&&(n=s,o=new ZE(n,t))}),n};Yu.exports=tT});var Qu=E((WN,Wu)=>{var rT=oe(),nT=we(),oT=(r,e,t)=>{let n=null,o=null,i=null;try{i=new nT(e,t)}catch(s){return null}return r.forEach(s=>{i.test(s)&&(!n||o.compare(s)===1)&&(n=s,o=new rT(n,t))}),n};Wu.exports=oT});var Zu=E((QN,Ju)=>{var lc=oe(),iT=we(),Xu=no(),sT=(r,e)=>{r=new iT(r,e);let t=new lc("0.0.0");if(r.test(t)||(t=new lc("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let o=r.set[n],i=null;o.forEach(s=>{let a=new lc(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||Xu(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),i&&(!t||Xu(t,i))&&(t=i)}return t&&r.test(t)?t:null};Ju.exports=sT});var th=E((XN,eh)=>{var aT=we(),cT=(r,e)=>{try{return new aT(r,e).range||"*"}catch(t){return null}};eh.exports=cT});var $i=E((JN,ih)=>{var dT=oe(),oh=oo(),{ANY:lT}=oh,uT=we(),hT=so(),rh=no(),nh=xi(),fT=Ui(),pT=Li(),mT=(r,e,t,n)=>{r=new dT(r,n),e=new uT(e,n);let o,i,s,a,c;switch(t){case">":o=rh,i=fT,s=nh,a=">",c=">=";break;case"<":o=nh,i=pT,s=rh,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(hT(r,e,n))return!1;for(let d=0;d<e.set.length;++d){let l=e.set[d],u=null,g=null;if(l.forEach(m=>{m.semver===lT&&(m=new oh(">=0.0.0")),u=u||m,g=g||m,o(m.semver,u.semver,n)?u=m:s(m.semver,g.semver,n)&&(g=m)}),u.operator===a||u.operator===c||(!g.operator||g.operator===a)&&i(r,g.semver))return!1;if(g.operator===c&&s(r,g.semver))return!1}return!0};ih.exports=mT});var ah=E((ZN,sh)=>{var gT=$i(),ET=(r,e,t)=>gT(r,e,">",t);sh.exports=ET});var dh=E((ev,ch)=>{var TT=$i(),yT=(r,e,t)=>TT(r,e,"<",t);ch.exports=yT});var hh=E((tv,uh)=>{var lh=we(),AT=(r,e,t)=>(r=new lh(r,t),e=new lh(e,t),r.intersects(e,t));uh.exports=AT});var ph=E((rv,fh)=>{var CT=so(),IT=ke();fh.exports=(r,e,t)=>{let n=[],o=null,i=null,s=r.sort((l,u)=>IT(l,u,t));for(let l of s)CT(l,e,t)?(i=l,o||(o=l)):(i&&n.push([o,i]),i=null,o=null);o&&n.push([o,null]);let a=[];for(let[l,u]of n)l===u?a.push(l):!u&&l===s[0]?a.push("*"):u?l===s[0]?a.push(`<=${u}`):a.push(`${l} - ${u}`):a.push(`>=${l}`);let c=a.join(" || "),d=typeof e.raw=="string"?e.raw:String(e);return c.length<d.length?c:e}});var Ah=E((nv,yh)=>{var mh=we(),hc=oo(),{ANY:uc}=hc,ao=so(),fc=ke(),ST=(r,e,t={})=>{if(r===e)return!0;r=new mh(r,t),e=new mh(e,t);let n=!1;e:for(let o of r.set){for(let i of e.set){let s=RT(o,i,t);if(n=n||s!==null,s)continue e}if(n)return!1}return!0},_T=[new hc(">=0.0.0-0")],gh=[new hc(">=0.0.0")],RT=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===uc){if(e.length===1&&e[0].semver===uc)return!0;t.includePrerelease?r=_T:r=gh}if(e.length===1&&e[0].semver===uc){if(t.includePrerelease)return!0;e=gh}let n=new Set,o,i;for(let m of r)m.operator===">"||m.operator===">="?o=Eh(o,m,t):m.operator==="<"||m.operator==="<="?i=Th(i,m,t):n.add(m.semver);if(n.size>1)return null;let s;if(o&&i){if(s=fc(o.semver,i.semver,t),s>0)return null;if(s===0&&(o.operator!==">="||i.operator!=="<="))return null}for(let m of n){if(o&&!ao(m,String(o),t)||i&&!ao(m,String(i),t))return null;for(let A of e)if(!ao(m,String(A),t))return!1;return!0}let a,c,d,l,u=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,g=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1;u&&u.prerelease.length===1&&i.operator==="<"&&u.prerelease[0]===0&&(u=!1);for(let m of e){if(l=l||m.operator===">"||m.operator===">=",d=d||m.operator==="<"||m.operator==="<=",o){if(g&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===g.major&&m.semver.minor===g.minor&&m.semver.patch===g.patch&&(g=!1),m.operator===">"||m.operator===">="){if(a=Eh(o,m,t),a===m&&a!==o)return!1}else if(o.operator===">="&&!ao(o.semver,String(m),t))return!1}if(i){if(u&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===u.major&&m.semver.minor===u.minor&&m.semver.patch===u.patch&&(u=!1),m.operator==="<"||m.operator==="<="){if(c=Th(i,m,t),c===m&&c!==i)return!1}else if(i.operator==="<="&&!ao(i.semver,String(m),t))return!1}if(!m.operator&&(i||o)&&s!==0)return!1}return!(o&&d&&!i&&s!==0||i&&l&&!o&&s!==0||g||u)},Eh=(r,e,t)=>{if(!r)return e;let n=fc(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},Th=(r,e,t)=>{if(!r)return e;let n=fc(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};yh.exports=ST});var Bi=E((ov,Sh)=>{var pc=Wr(),Ch=to(),kT=oe(),Ih=Za(),wT=hr(),OT=zl(),NT=Ql(),vT=Zl(),bT=ru(),MT=ou(),PT=su(),DT=cu(),xT=lu(),LT=ke(),UT=pu(),HT=gu(),FT=Di(),$T=Au(),BT=Iu(),GT=no(),qT=xi(),VT=tc(),jT=rc(),KT=Li(),YT=Ui(),zT=nc(),WT=bu(),QT=oo(),XT=we(),JT=so(),ZT=Ku(),ey=zu(),ty=Qu(),ry=Zu(),ny=th(),oy=$i(),iy=ah(),sy=dh(),ay=hh(),cy=ph(),dy=Ah();Sh.exports={parse:wT,valid:OT,clean:NT,inc:vT,diff:bT,major:MT,minor:PT,patch:DT,prerelease:xT,compare:LT,rcompare:UT,compareLoose:HT,compareBuild:FT,sort:$T,rsort:BT,gt:GT,lt:qT,eq:VT,neq:jT,gte:KT,lte:YT,cmp:zT,coerce:WT,Comparator:QT,Range:XT,satisfies:JT,toComparators:ZT,maxSatisfying:ey,minSatisfying:ty,minVersion:ry,validRange:ny,outside:oy,gtr:iy,ltr:sy,intersects:ay,simplifyRange:cy,subset:dy,SemVer:kT,re:pc.re,src:pc.src,tokens:pc.t,SEMVER_SPEC_VERSION:Ch.SEMVER_SPEC_VERSION,RELEASE_TYPES:Ch.RELEASE_TYPES,compareIdentifiers:Ih.compareIdentifiers,rcompareIdentifiers:Ih.rcompareIdentifiers}});var Rh=E((iv,_h)=>{var ly=Bi();_h.exports=ly.satisfies(process.version,">=15.7.0")});var wh=E((sv,kh)=>{var uy=Bi();kh.exports=uy.satisfies(process.version,">=16.9.0")});var mc=E((av,Oh)=>{var hy=Rh(),fy=wh(),py={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},my={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};Oh.exports=function(r,e){if(!r||!e)return;let t=e.asymmetricKeyType;if(!t)return;let n=py[t];if(!n)throw new Error(`Unknown key type "${t}".`);if(!n.includes(r))throw new Error(`"alg" parameter for "${t}" key type must be one of: ${n.join(", ")}.`);if(hy)switch(t){case"ec":let o=e.asymmetricKeyDetails.namedCurve,i=my[r];if(o!==i)throw new Error(`"alg" parameter "${r}" requires curve "${i}".`);break;case"rsa-pss":if(fy){let s=parseInt(r.slice(-3),10),{hashAlgorithm:a,mgf1HashAlgorithm:c,saltLength:d}=e.asymmetricKeyDetails;if(a!==`sha${s}`||c!==a)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${r}.`);if(d!==void 0&&d>s>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${r}.`)}break}}});var gc=E((cv,Nh)=>{var gy=Bi();Nh.exports=gy.satisfies(process.version,"^6.12.0 || >=8.0.0")});var Mh=E((dv,bh)=>{var D=eo(),Ey=za(),vh=Wa(),Ty=Ya(),yy=Qa(),Ay=mc(),Cy=gc(),Iy=Ri(),{KeyObject:Sy,createSecretKey:_y,createPublicKey:Ry}=require("crypto"),Ec=["RS256","RS384","RS512"],ky=["ES256","ES384","ES512"],Tc=["RS256","RS384","RS512"],wy=["HS256","HS384","HS512"];Cy&&(Ec.splice(Ec.length,0,"PS256","PS384","PS512"),Tc.splice(Tc.length,0,"PS256","PS384","PS512"));bh.exports=function(r,e,t,n){typeof t=="function"&&!n&&(n=t,t={}),t||(t={}),t=Object.assign({},t);let o;if(n?o=n:o=function(l,u){if(l)throw l;return u},t.clockTimestamp&&typeof t.clockTimestamp!="number")return o(new D("clockTimestamp must be a number"));if(t.nonce!==void 0&&(typeof t.nonce!="string"||t.nonce.trim()===""))return o(new D("nonce must be a non-empty string"));if(t.allowInvalidAsymmetricKeyTypes!==void 0&&typeof t.allowInvalidAsymmetricKeyTypes!="boolean")return o(new D("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!r)return o(new D("jwt must be provided"));if(typeof r!="string")return o(new D("jwt must be a string"));let s=r.split(".");if(s.length!==3)return o(new D("jwt malformed"));let a;try{a=Ty(r,{complete:!0})}catch(l){return o(l)}if(!a)return o(new D("invalid token"));let c=a.header,d;if(typeof e=="function"){if(!n)return o(new D("verify must be called asynchronous if secret or public key is provided as a callback"));d=e}else d=function(l,u){return u(null,e)};return d(c,function(l,u){if(l)return o(new D("error in secret or public key callback: "+l.message));let g=s[2].trim()!=="";if(!g&&u)return o(new D("jwt signature is required"));if(g&&!u)return o(new D("secret or public key must be provided"));if(!g&&!t.algorithms)return o(new D('please specify "none" in "algorithms" to verify unsigned tokens'));if(u!=null&&!(u instanceof Sy))try{u=Ry(u)}catch(C){try{u=_y(typeof u=="string"?Buffer.from(u):u)}catch(U){return o(new D("secretOrPublicKey is not valid key material"))}}if(t.algorithms||(u.type==="secret"?t.algorithms=wy:["rsa","rsa-pss"].includes(u.asymmetricKeyType)?t.algorithms=Tc:u.asymmetricKeyType==="ec"?t.algorithms=ky:t.algorithms=Ec),t.algorithms.indexOf(a.header.alg)===-1)return o(new D("invalid algorithm"));if(c.alg.startsWith("HS")&&u.type!=="secret")return o(new D(`secretOrPublicKey must be a symmetric key when using ${c.alg}`));if(/^(?:RS|PS|ES)/.test(c.alg)&&u.type!=="public")return o(new D(`secretOrPublicKey must be an asymmetric key when using ${c.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{Ay(c.alg,u)}catch(C){return o(C)}let m;try{m=Iy.verify(r,a.header.alg,u)}catch(C){return o(C)}if(!m)return o(new D("invalid signature"));let A=a.payload;if(typeof A.nbf!="undefined"&&!t.ignoreNotBefore){if(typeof A.nbf!="number")return o(new D("invalid nbf value"));if(A.nbf>i+(t.clockTolerance||0))return o(new Ey("jwt not active",new Date(A.nbf*1e3)))}if(typeof A.exp!="undefined"&&!t.ignoreExpiration){if(typeof A.exp!="number")return o(new D("invalid exp value"));if(i>=A.exp+(t.clockTolerance||0))return o(new vh("jwt expired",new Date(A.exp*1e3)))}if(t.audience){let C=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(A.aud)?A.aud:[A.aud]).some(function(q){return C.some(function(Z){return Z instanceof RegExp?Z.test(q):Z===q})}))return o(new D("jwt audience invalid. expected: "+C.join(" or ")))}if(t.issuer&&(typeof t.issuer=="string"&&A.iss!==t.issuer||Array.isArray(t.issuer)&&t.issuer.indexOf(A.iss)===-1))return o(new D("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&A.sub!==t.subject)return o(new D("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&A.jti!==t.jwtid)return o(new D("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&A.nonce!==t.nonce)return o(new D("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if(typeof A.iat!="number")return o(new D("iat required when maxAge is specified"));let C=yy(t.maxAge,A.iat);if(typeof C=="undefined")return o(new D('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=C+(t.clockTolerance||0))return o(new vh("maxAge exceeded",new Date(C*1e3)))}if(t.complete===!0){let C=a.signature;return o(null,{header:c,payload:A,signature:C})}return o(null,A)})}});var Hh=E((lv,Uh)=>{var Ph=1/0,xh=9007199254740991,Oy=17976931348623157e292,Dh=NaN,Ny="[object Arguments]",vy="[object Function]",by="[object GeneratorFunction]",My="[object String]",Py="[object Symbol]",Dy=/^\s+|\s+$/g,xy=/^[-+]0x[0-9a-f]+$/i,Ly=/^0b[01]+$/i,Uy=/^0o[0-7]+$/i,Hy=/^(?:0|[1-9]\d*)$/,Fy=parseInt;function $y(r,e){for(var t=-1,n=r?r.length:0,o=Array(n);++t<n;)o[t]=e(r[t],t,r);return o}function By(r,e,t,n){for(var o=r.length,i=t+(n?1:-1);n?i--:++i<o;)if(e(r[i],i,r))return i;return-1}function Gy(r,e,t){if(e!==e)return By(r,qy,t);for(var n=t-1,o=r.length;++n<o;)if(r[n]===e)return n;return-1}function qy(r){return r!==r}function Vy(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}function jy(r,e){return $y(e,function(t){return r[t]})}function Ky(r,e){return function(t){return r(e(t))}}var Gi=Object.prototype,Ac=Gi.hasOwnProperty,qi=Gi.toString,Yy=Gi.propertyIsEnumerable,zy=Ky(Object.keys,Object),Wy=Math.max;function Qy(r,e){var t=Lh(r)||tA(r)?Vy(r.length,String):[],n=t.length,o=!!n;for(var i in r)(e||Ac.call(r,i))&&!(o&&(i=="length"||Jy(i,n)))&&t.push(i);return t}function Xy(r){if(!Zy(r))return zy(r);var e=[];for(var t in Object(r))Ac.call(r,t)&&t!="constructor"&&e.push(t);return e}function Jy(r,e){return e=e==null?xh:e,!!e&&(typeof r=="number"||Hy.test(r))&&r>-1&&r%1==0&&r<e}function Zy(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||Gi;return r===t}function eA(r,e,t,n){r=Cc(r)?r:uA(r),t=t&&!n?cA(t):0;var o=r.length;return t<0&&(t=Wy(o+t,0)),iA(r)?t<=o&&r.indexOf(e,t)>-1:!!o&&Gy(r,e,t)>-1}function tA(r){return rA(r)&&Ac.call(r,"callee")&&(!Yy.call(r,"callee")||qi.call(r)==Ny)}var Lh=Array.isArray;function Cc(r){return r!=null&&oA(r.length)&&!nA(r)}function rA(r){return Ic(r)&&Cc(r)}function nA(r){var e=yc(r)?qi.call(r):"";return e==vy||e==by}function oA(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=xh}function yc(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function Ic(r){return!!r&&typeof r=="object"}function iA(r){return typeof r=="string"||!Lh(r)&&Ic(r)&&qi.call(r)==My}function sA(r){return typeof r=="symbol"||Ic(r)&&qi.call(r)==Py}function aA(r){if(!r)return r===0?r:0;if(r=dA(r),r===Ph||r===-Ph){var e=r<0?-1:1;return e*Oy}return r===r?r:0}function cA(r){var e=aA(r),t=e%1;return e===e?t?e-t:e:0}function dA(r){if(typeof r=="number")return r;if(sA(r))return Dh;if(yc(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=yc(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(Dy,"");var t=Ly.test(r);return t||Uy.test(r)?Fy(r.slice(2),t?2:8):xy.test(r)?Dh:+r}function lA(r){return Cc(r)?Qy(r):Xy(r)}function uA(r){return r?jy(r,lA(r)):[]}Uh.exports=eA});var $h=E((uv,Fh)=>{var hA="[object Boolean]",fA=Object.prototype,pA=fA.toString;function mA(r){return r===!0||r===!1||gA(r)&&pA.call(r)==hA}function gA(r){return!!r&&typeof r=="object"}Fh.exports=mA});var jh=E((hv,Vh)=>{var Bh=1/0,EA=17976931348623157e292,Gh=NaN,TA="[object Symbol]",yA=/^\s+|\s+$/g,AA=/^[-+]0x[0-9a-f]+$/i,CA=/^0b[01]+$/i,IA=/^0o[0-7]+$/i,SA=parseInt,_A=Object.prototype,RA=_A.toString;function kA(r){return typeof r=="number"&&r==vA(r)}function qh(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function wA(r){return!!r&&typeof r=="object"}function OA(r){return typeof r=="symbol"||wA(r)&&RA.call(r)==TA}function NA(r){if(!r)return r===0?r:0;if(r=bA(r),r===Bh||r===-Bh){var e=r<0?-1:1;return e*EA}return r===r?r:0}function vA(r){var e=NA(r),t=e%1;return e===e?t?e-t:e:0}function bA(r){if(typeof r=="number")return r;if(OA(r))return Gh;if(qh(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=qh(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(yA,"");var t=CA.test(r);return t||IA.test(r)?SA(r.slice(2),t?2:8):AA.test(r)?Gh:+r}Vh.exports=kA});var Yh=E((fv,Kh)=>{var MA="[object Number]",PA=Object.prototype,DA=PA.toString;function xA(r){return!!r&&typeof r=="object"}function LA(r){return typeof r=="number"||xA(r)&&DA.call(r)==MA}Kh.exports=LA});var Xh=E((pv,Qh)=>{var UA="[object Object]";function HA(r){var e=!1;if(r!=null&&typeof r.toString!="function")try{e=!!(r+"")}catch(t){}return e}function FA(r,e){return function(t){return r(e(t))}}var $A=Function.prototype,zh=Object.prototype,Wh=$A.toString,BA=zh.hasOwnProperty,GA=Wh.call(Object),qA=zh.toString,VA=FA(Object.getPrototypeOf,Object);function jA(r){return!!r&&typeof r=="object"}function KA(r){if(!jA(r)||qA.call(r)!=UA||HA(r))return!1;var e=VA(r);if(e===null)return!0;var t=BA.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&Wh.call(t)==GA}Qh.exports=KA});var Zh=E((mv,Jh)=>{var YA="[object String]",zA=Object.prototype,WA=zA.toString,QA=Array.isArray;function XA(r){return!!r&&typeof r=="object"}function JA(r){return typeof r=="string"||!QA(r)&&XA(r)&&WA.call(r)==YA}Jh.exports=JA});var of=E((gv,nf)=>{var ZA="Expected a function",ef=1/0,eC=17976931348623157e292,tf=NaN,tC="[object Symbol]",rC=/^\s+|\s+$/g,nC=/^[-+]0x[0-9a-f]+$/i,oC=/^0b[01]+$/i,iC=/^0o[0-7]+$/i,sC=parseInt,aC=Object.prototype,cC=aC.toString;function dC(r,e){var t;if(typeof e!="function")throw new TypeError(ZA);return r=pC(r),function(){return--r>0&&(t=e.apply(this,arguments)),r<=1&&(e=void 0),t}}function lC(r){return dC(2,r)}function rf(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function uC(r){return!!r&&typeof r=="object"}function hC(r){return typeof r=="symbol"||uC(r)&&cC.call(r)==tC}function fC(r){if(!r)return r===0?r:0;if(r=mC(r),r===ef||r===-ef){var e=r<0?-1:1;return e*eC}return r===r?r:0}function pC(r){var e=fC(r),t=e%1;return e===e?t?e-t:e:0}function mC(r){if(typeof r=="number")return r;if(hC(r))return tf;if(rf(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=rf(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(rC,"");var t=oC.test(r);return t||iC.test(r)?sC(r.slice(2),t?2:8):nC.test(r)?tf:+r}nf.exports=lC});var pf=E((Ev,ff)=>{var sf=Qa(),gC=gc(),EC=mc(),af=Ri(),TC=Hh(),Vi=$h(),cf=jh(),Sc=Yh(),lf=Xh(),_t=Zh(),yC=of(),{KeyObject:AC,createSecretKey:CC,createPrivateKey:IC}=require("crypto"),uf=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];gC&&uf.splice(3,0,"PS256","PS384","PS512");var SC={expiresIn:{isValid:function(r){return cf(r)||_t(r)&&r},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(r){return cf(r)||_t(r)&&r},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(r){return _t(r)||Array.isArray(r)},message:'"audience" must be a string or array'},algorithm:{isValid:TC.bind(null,uf),message:'"algorithm" must be a valid string enum value'},header:{isValid:lf,message:'"header" must be an object'},encoding:{isValid:_t,message:'"encoding" must be a string'},issuer:{isValid:_t,message:'"issuer" must be a string'},subject:{isValid:_t,message:'"subject" must be a string'},jwtid:{isValid:_t,message:'"jwtid" must be a string'},noTimestamp:{isValid:Vi,message:'"noTimestamp" must be a boolean'},keyid:{isValid:_t,message:'"keyid" must be a string'},mutatePayload:{isValid:Vi,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Vi,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Vi,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},_C={iat:{isValid:Sc,message:'"iat" should be a number of seconds'},exp:{isValid:Sc,message:'"exp" should be a number of seconds'},nbf:{isValid:Sc,message:'"nbf" should be a number of seconds'}};function hf(r,e,t,n){if(!lf(t))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(o){let i=r[o];if(!i){if(!e)throw new Error('"'+o+'" is not allowed in "'+n+'"');return}if(!i.isValid(t[o]))throw new Error(i.message)})}function RC(r){return hf(SC,!1,r,"options")}function kC(r){return hf(_C,!0,r,"payload")}var df={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},wC=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];ff.exports=function(r,e,t,n){typeof t=="function"?(n=t,t={}):t=t||{};let o=typeof r=="object"&&!Buffer.isBuffer(r),i=Object.assign({alg:t.algorithm||"HS256",typ:o?"JWT":void 0,kid:t.keyid},t.header);function s(d){if(n)return n(d);throw d}if(!e&&t.algorithm!=="none")return s(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof AC))try{e=IC(e)}catch(d){try{e=CC(typeof e=="string"?Buffer.from(e):e)}catch(l){return s(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&e.type!=="secret")return s(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(e.type!=="private")return s(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!t.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return s(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof r=="undefined")return s(new Error("payload is required"));if(o){try{kC(r)}catch(d){return s(d)}t.mutatePayload||(r=Object.assign({},r))}else{let d=wC.filter(function(l){return typeof t[l]!="undefined"});if(d.length>0)return s(new Error("invalid "+d.join(",")+" option for "+typeof r+" payload"))}if(typeof r.exp!="undefined"&&typeof t.expiresIn!="undefined")return s(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof r.nbf!="undefined"&&typeof t.notBefore!="undefined")return s(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{RC(t)}catch(d){return s(d)}if(!t.allowInvalidAsymmetricKeyTypes)try{EC(i.alg,e)}catch(d){return s(d)}let a=r.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete r.iat:o&&(r.iat=a),typeof t.notBefore!="undefined"){try{r.nbf=sf(t.notBefore,a)}catch(d){return s(d)}if(typeof r.nbf=="undefined")return s(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof t.expiresIn!="undefined"&&typeof r=="object"){try{r.exp=sf(t.expiresIn,a)}catch(d){return s(d)}if(typeof r.exp=="undefined")return s(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(df).forEach(function(d){let l=df[d];if(typeof t[d]!="undefined"){if(typeof r[l]!="undefined")return s(new Error('Bad "options.'+d+'" option. The payload already has an "'+l+'" property.'));r[l]=t[d]}});let c=t.encoding||"utf8";if(typeof n=="function")n=n&&yC(n),af.createSign({header:i,privateKey:e,payload:r,encoding:c}).once("error",n).once("done",function(d){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&d.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,d)});else{let d=af.sign({header:i,payload:r,secret:e,encoding:c});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&d.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return d}}});var gf=E((Tv,mf)=>{mf.exports={decode:Ya(),verify:Mh(),sign:pf(),JsonWebTokenError:eo(),NotBeforeError:za(),TokenExpiredError:Wa()}});var Af=E(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});Wi.CallbacksRegistry=void 0;var kc=class{constructor(){this.nextId=0,this.callbacks={},this.callbackIds=new WeakMap,this.locationInfo=new WeakMap}add(e){let t=this.callbackIds.get(e);if(t!=null)return t;t=this.nextId+=1,this.callbacks[t]=e,this.callbackIds.set(e,t);let n=/at (.*)/gi,o=new Error().stack;if(!o)return t;let i,s;for(;(s=n.exec(o))!==null;){let a=s[1];if(a.includes("(native)")||a.includes("(<anonymous>)")||a.includes("callbacks-registry.js")||a.includes("remote.js")||a.includes("@electron/remote/dist"))continue;let c=/([^/^)]*)\)?$/gi.exec(a);c&&(i=c[1]);break}return this.locationInfo.set(e,i),t}get(e){return this.callbacks[e]||function(){}}getLocation(e){return this.locationInfo.get(e)}apply(e,...t){return this.get(e).apply(global,...t)}remove(e){let t=this.callbacks[e];t&&(this.callbackIds.delete(t),delete this.callbacks[e])}};Wi.CallbacksRegistry=kc});var If=E(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.deserialize=Ge.serialize=Ge.isSerializableObject=Ge.isPromise=void 0;var PC=require("electron");function DC(r){return r&&r.then&&r.then instanceof Function&&r.constructor&&r.constructor.reject&&r.constructor.reject instanceof Function&&r.constructor.resolve&&r.constructor.resolve instanceof Function}Ge.isPromise=DC;var xC=[Boolean,Number,String,Date,Error,RegExp,ArrayBuffer];function Nc(r){return r===null||ArrayBuffer.isView(r)||xC.some(e=>r instanceof e)}Ge.isSerializableObject=Nc;var Cf=function(r,e){let n=Object.entries(r).map(([o,i])=>[o,e(i)]);return Object.fromEntries(n)};function LC(r){let e=[],t=r.getScaleFactors();if(t.length===1){let n=t[0],o=r.getSize(n),i=r.toBitmap({scaleFactor:n});e.push({scaleFactor:n,size:o,buffer:i})}else for(let n of t){let o=r.getSize(n),i=r.toDataURL({scaleFactor:n});e.push({scaleFactor:n,size:o,dataURL:i})}return{__ELECTRON_SERIALIZED_NativeImage__:!0,representations:e}}function UC(r){let e=PC.nativeImage.createEmpty();if(r.representations.length===1){let{buffer:t,size:n,scaleFactor:o}=r.representations[0],{width:i,height:s}=n;e.addRepresentation({buffer:t,scaleFactor:o,width:i,height:s})}else for(let t of r.representations){let{dataURL:n,size:o,scaleFactor:i}=t,{width:s,height:a}=o;e.addRepresentation({dataURL:n,scaleFactor:i,width:s,height:a})}return e}function wc(r){return r&&r.constructor&&r.constructor.name==="NativeImage"?LC(r):Array.isArray(r)?r.map(wc):Nc(r)?r:r instanceof Object?Cf(r,wc):r}Ge.serialize=wc;function Oc(r){return r&&r.__ELECTRON_SERIALIZED_NativeImage__?UC(r):Array.isArray(r)?r.map(Oc):Nc(r)?r:r instanceof Object?Cf(r,Oc):r}Ge.deserialize=Oc});var vc=E(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.getElectronBinding=void 0;var HC=r=>process._linkedBinding?process._linkedBinding("electron_common_"+r):process.electronBinding?process.electronBinding(r):null;Qi.getElectronBinding=HC});var Sf=E(st=>{"use strict";var bc,Mc;Object.defineProperty(st,"__esModule",{value:!0});st.browserModuleNames=st.commonModuleNames=void 0;var FC=vc();st.commonModuleNames=["clipboard","nativeImage","shell"];st.browserModuleNames=["app","autoUpdater","BaseWindow","BrowserView","BrowserWindow","contentTracing","crashReporter","dialog","globalShortcut","ipcMain","inAppPurchase","Menu","MenuItem","nativeTheme","net","netLog","MessageChannelMain","Notification","powerMonitor","powerSaveBlocker","protocol","pushNotifications","safeStorage","screen","session","ShareMenu","systemPreferences","TopLevelWindow","TouchBar","Tray","utilityProcess","View","webContents","WebContentsView","webFrameMain"].concat(st.commonModuleNames);var wt=FC.getElectronBinding("features");((bc=wt==null?void 0:wt.isDesktopCapturerEnabled)===null||bc===void 0?void 0:bc.call(wt))!==!1&&st.browserModuleNames.push("desktopCapturer");((Mc=wt==null?void 0:wt.isViewApiEnabled)===null||Mc===void 0?void 0:Mc.call(wt))!==!1&&st.browserModuleNames.push("ImageView")});var Nf=E(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.createFunctionWithReturnValue=re.getGlobal=re.getCurrentWebContents=re.getCurrentWindow=re.getBuiltin=void 0;var $C=Af(),Xi=If(),me=require("electron"),BC=Sf(),GC=vc(),{Promise:qC}=global,Ji=new $C.CallbacksRegistry,Zi=new Map,VC=new FinalizationRegistry(r=>{let e=Zi.get(r);e!==void 0&&e.deref()===void 0&&(Zi.delete(r),me.ipcRenderer.send("REMOTE_BROWSER_DEREFERENCE",ge,r,0))}),Pc=new WeakMap,Rf=new WeakSet;function jC(r){let e=Zi.get(r);if(e!==void 0){let t=e.deref();if(t!==void 0)return t}}function KC(r,e){let t=new WeakRef(e);return Zi.set(r,t),VC.register(e,r),e}function YC(){let r=GC.getElectronBinding("v8_util");if(r)return r.getHiddenValue(global,"contextId");throw new Error("Electron >=v13.0.0-beta.6 required to support sandboxed renderers")}var ge=process.contextId||YC();process.on("exit",()=>{me.ipcRenderer.send("REMOTE_BROWSER_CONTEXT_RELEASE",ge)});var kf=Symbol("is-remote-proxy");function es(r,e=new Set){let t=n=>{if(e.has(n))return{type:"value",value:null};if(n&&n.constructor&&n.constructor.name==="NativeImage")return{type:"nativeimage",value:Xi.serialize(n)};if(Array.isArray(n)){e.add(n);let o={type:"array",value:es(n,e)};return e.delete(n),o}else{if(n instanceof Buffer)return{type:"buffer",value:n};if(Xi.isSerializableObject(n))return{type:"value",value:n};if(typeof n=="object"){if(Xi.isPromise(n))return{type:"promise",then:t(function(i,s){n.then(i,s)})};if(Pc.has(n))return{type:"remote-object",id:Pc.get(n)};let o={type:"object",name:n.constructor?n.constructor.name:"",members:[]};e.add(n);for(let i in n)o.members.push({name:i,value:t(n[i])});return e.delete(n),o}else return typeof n=="function"&&Rf.has(n)?{type:"function-with-return-value",value:t(n())}:typeof n=="function"?{type:"function",id:Ji.add(n),location:Ji.getLocation(n),length:n.length}:{type:"value",value:n}}};return r.map(t)}function Dc(r,e,t,n){if(Array.isArray(n))for(let o of n){if(Object.prototype.hasOwnProperty.call(e,o.name))continue;let i={enumerable:o.enumerable};if(o.type==="method"){let s=function(...c){let d;this&&this.constructor===s?d="REMOTE_BROWSER_MEMBER_CONSTRUCTOR":d="REMOTE_BROWSER_MEMBER_CALL";let l=me.ipcRenderer.sendSync(d,ge,t,o.name,es(c));return Ae(l)},a=zC(s,t,o.name);i.get=()=>(a.ref=r,a),i.set=c=>(a=c,c),i.configurable=!0}else o.type==="get"&&(i.get=()=>{let a=me.ipcRenderer.sendSync("REMOTE_BROWSER_MEMBER_GET",ge,t,o.name);return Ae(a)},o.writable&&(i.set=s=>{let a=es([s]),d=me.ipcRenderer.sendSync("REMOTE_BROWSER_MEMBER_SET",ge,t,o.name,a);return d!=null&&Ae(d),s}));Object.defineProperty(e,o.name,i)}}function wf(r,e,t,n){if(n===null)return;let o={};Dc(r,o,t,n.members),wf(r,o,t,n.proto),Object.setPrototypeOf(e,o)}function zC(r,e,t){let n=!1,o=()=>{if(n)return;n=!0;let s=me.ipcRenderer.sendSync("REMOTE_BROWSER_MEMBER_GET",ge,e,t);Dc(r,r,s.id,s.members)};return new Proxy(r,{set:(i,s,a)=>(s!=="ref"&&o(),i[s]=a,!0),get:(i,s)=>{if(s===kf)return!0;Object.prototype.hasOwnProperty.call(i,s)||o();let a=i[s];return s==="toString"&&typeof a=="function"?a.bind(i):a},ownKeys:i=>(o(),Object.getOwnPropertyNames(i)),getOwnPropertyDescriptor:(i,s)=>{let a=Object.getOwnPropertyDescriptor(i,s);return a||(o(),Object.getOwnPropertyDescriptor(i,s))}})}function Ae(r){if(!r)return{};if(r.type==="value")return r.value;if(r.type==="array")return r.members.map(e=>Ae(e));if(r.type==="nativeimage")return Xi.deserialize(r.value);if(r.type==="buffer")return Buffer.from(r.value.buffer,r.value.byteOffset,r.value.byteLength);if(r.type==="promise")return qC.resolve({then:Ae(r.then)});if(r.type==="error")return _f(r);if(r.type==="exception")throw r.value.type==="error"?_f(r.value):new Error(`Unexpected value type in exception: ${r.value.type}`);{let e;if("id"in r){let t=jC(r.id);if(t!==void 0)return t}if(r.type==="function"){let t=function(...n){let o;this&&this.constructor===t?o="REMOTE_BROWSER_CONSTRUCTOR":o="REMOTE_BROWSER_FUNCTION_CALL";let i=me.ipcRenderer.sendSync(o,ge,r.id,es(n));return Ae(i)};e=t}else e={};return Dc(e,e,r.id,r.members),wf(e,e,r.id,r.proto),e.constructor&&e.constructor[kf]&&Object.defineProperty(e.constructor,"name",{value:r.name}),Pc.set(e,r.id),KC(r.id,e),e}}function _f(r){let e=r.value;for(let{name:t,value:n}of r.members)e[t]=Ae(n);return e}function WC(r){return typeof r.senderId=="number"}function Of(r,e){me.ipcRenderer.on(r,(t,n,o,...i)=>{if(WC(t)&&t.senderId!==0&&t.senderId!==void 0){console.error(`Message ${r} sent by unexpected WebContents (${t.senderId})`);return}n===ge?e(o,...i):me.ipcRenderer.send("REMOTE_BROWSER_WRONG_CONTEXT_ERROR",ge,n,o)})}var QC=process.argv.includes("--enable-api-filtering-logging");function Zr(){let r={stack:void 0};return QC&&Error.captureStackTrace(r,Zr),r.stack}Of("REMOTE_RENDERER_CALLBACK",(r,e)=>{Ji.apply(r,Ae(e))});Of("REMOTE_RENDERER_RELEASE_CALLBACK",r=>{Ji.remove(r)});re.require=r=>{let t=me.ipcRenderer.sendSync("REMOTE_BROWSER_REQUIRE",ge,r,Zr());return Ae(t)};function XC(r){let t=me.ipcRenderer.sendSync("REMOTE_BROWSER_GET_BUILTIN",ge,r,Zr());return Ae(t)}re.getBuiltin=XC;function JC(){let e=me.ipcRenderer.sendSync("REMOTE_BROWSER_GET_CURRENT_WINDOW",ge,Zr());return Ae(e)}re.getCurrentWindow=JC;function ZC(){let e=me.ipcRenderer.sendSync("REMOTE_BROWSER_GET_CURRENT_WEB_CONTENTS",ge,Zr());return Ae(e)}re.getCurrentWebContents=ZC;function eI(r){let t=me.ipcRenderer.sendSync("REMOTE_BROWSER_GET_GLOBAL",ge,r,Zr());return Ae(t)}re.getGlobal=eI;Object.defineProperty(re,"process",{enumerable:!0,get:()=>re.getGlobal("process")});function tI(r){let e=()=>r;return Rf.add(e),e}re.createFunctionWithReturnValue=tI;var rI=r=>{Object.defineProperty(re,r,{enumerable:!0,get:()=>re.getBuiltin(r)})};BC.browserModuleNames.forEach(rI)});var vf=E(pr=>{"use strict";var nI=pr&&pr.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),oI=pr&&pr.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&nI(e,r,t)};Object.defineProperty(pr,"__esModule",{value:!0});if(process.type==="browser")throw new Error('"@electron/remote" cannot be required in the browser process. Instead require("@electron/remote/main").');oI(Nf(),pr)});var Mf=E((cP,bf)=>{bf.exports=vf()});var iI={};Pe(iI,{default:()=>ns});module.exports=jf(iI);var os=require("obsidian"),is=Ce(require("fs")),Uf=Ce(Kc()),Uc=Ce(require("path"));var Ot=require("obsidian"),Yc={selectedTaskListId:"",taskLists:[],clientId:"",clientSecret:"",redirectUrl:"http://localhost:5000"},Co=class extends Ot.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t,this.settings=t.settings}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Microsoft To\u2011Do Settings"}),new Ot.Setting(e).setName("Client Details").setDesc("Enter the client ID and client secret of your Azure AD app.").addText(t=>t.setPlaceholder("Client ID").setValue(this.plugin.settings.clientId).onChange(async n=>{this.plugin.settings.clientId=n,await this.plugin.saveSettings()})).addText(t=>t.setPlaceholder("Client Secret").setValue(this.plugin.settings.clientSecret).onChange(async n=>{this.plugin.settings.clientSecret=n,await this.plugin.saveSettings()})),new Ot.Setting(e).setName("Redirect URL").setDesc("Enter the URL to redirect to after authentication.").addText(t=>t.setPlaceholder("http://localhost:5000").setValue(this.plugin.settings.redirectUrl).onChange(async n=>{this.plugin.settings.redirectUrl=n,await this.plugin.saveSettings()})),new Ot.Setting(e).setName("Get Task Lists").setDesc("Click to get the list of available task lists.").addButton(t=>{t.setButtonText("Get Task Lists").onClick(async()=>{await this.plugin.loadAvailableTaskLists(),this.display()})}),new Ot.Setting(e).setName("Task List").setDesc("Select the Microsoft To\u2011Do list to store your Obsidian tasks.").addDropdown(t=>{t.addOption("","Select a task list"),this.settings.taskLists.length>0?this.settings.taskLists.forEach(n=>{t.addOption(n.id,n.title)}):t.addOption("none","No task lists available"),t.setValue(this.settings.selectedTaskListId),t.onChange(async n=>{this.settings.selectedTaskListId=n,await this.plugin.saveSettings()})})}};var Wc=require("obsidian");var zc=require("obsidian");function b(r,e="info"){let t="";switch(e){case"error":t="\u274C ";break;case"warning":t="\u26A0\uFE0F ";break;case"success":t="\u2705 ";break}new zc.Notice(`${t}${r}`)}var So="tasks-syncer-sidebar",Io=class extends Wc.ItemView{constructor(e,t){super(e),this.plugin=t}getViewType(){return So}getDisplayText(){return"To-Do Tasks"}getIcon(){return"list-todo"}async onOpen(){this.injectStyles(),this.render(null),this.plugin.getTasksFromSelectedList().then(e=>this.render(e)).catch(e=>{console.error("Error loading tasks in sidebar:",e),b("Error loading tasks in sidebar",e)})}async setupRefreshButton(e){let t=e.createEl("button",{text:"Refresh Tasks"});t.onclick=async()=>{this.render(null);try{let n=await this.plugin.refreshTaskCache();this.render(n)}catch(n){console.log("Error refreshing tasks:",n),b("Failed to refresh tasks","error")}}}async render(e){let t=this.containerEl.children[1];if(t.empty(),this.setupRefreshButton(t),t.createEl("h3",{text:"Tasks"}),e===null){let n=t.createDiv({cls:"spinner-wrapper"});n.createDiv({cls:"loading-spinner"}),n.createEl("p",{text:"Loading tasks..."});return}if(e.size===0){t.createEl("p",{text:"No tasks found"});return}Array.from(e.values()).sort((n,o)=>n.status==="completed"&&o.status!=="completed"?1:n.status!=="completed"&&o.status==="completed"?-1:0).forEach(n=>{let o=t.createEl("div",{cls:"task-line"}),i=o.createEl("input",{type:"checkbox"});i.checked=n.status==="completed",i.disabled=!0,o.createEl("span",{text:n.title})})}async onClose(){}injectStyles(){let e=document.createElement("style");e.textContent=`
	.spinner-wrapper {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		padding: 1em;
	}

	.loading-spinner {
		width: 24px;
		height: 24px;
		border: 3px solid var(--background-modifier-border);
		border-top: 3px solid var(--text-accent);
		border-radius: 50%;
		animation: spin 1s linear infinite;
		margin-bottom: 0.5em;
	}

	@keyframes spin {
		0% { transform: rotate(0deg); }
		100% { transform: rotate(360deg); }
	}
	`,document.head.appendChild(e)}};var gr=require("obsidian");async function _o(r,e){let t=new Map,n=await(0,gr.requestUrl)({url:`https://graph.microsoft.com/v1.0/me/todo/lists/${r.selectedTaskListId}/tasks`,method:"GET",headers:{Authorization:`Bearer ${e}`}});if(n.status!==200)throw new Error("Failed to fetch tasks: "+n.text);let o=n.json;if(o.value&&Array.isArray(o.value))for(let i of o.value){let s=i.title.trim();t.set(s,{title:s,status:i.status,id:i.id})}return t}async function hs(r,e,t,n="notStarted"){let o=await(0,gr.requestUrl)({url:`https://graph.microsoft.com/v1.0/me/todo/lists/${r.selectedTaskListId}/tasks`,method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({title:t,status:n})});if(o.status!==201)throw new Error(`Failed to create task: ${o.text}`)}async function fs(r,e,t,n){let o=n?"completed":"notStarted",i=await(0,gr.requestUrl)({url:`https://graph.microsoft.com/v1.0/me/todo/lists/${r.selectedTaskListId}/tasks/${t}`,method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({status:o})});if(i.status!==200)throw new Error(`Failed to update task: ${i.text}`)}async function ps(r){let e=await(0,gr.requestUrl)({url:"https://graph.microsoft.com/v1.0/me/todo/lists",method:"GET",headers:{Authorization:`Bearer ${r}`}});if(e.status!==200)throw new Error("Failed to fetch task lists: "+e.text);let t=e.json,n=new Array;if(console.log("Task lists data:",t),t.value&&Array.isArray(t.value))for(let o of t.value)n.push({title:o.displayName,id:o.id});return n}async function Qc(r,e,t){let n=await(0,gr.requestUrl)({url:`https://graph.microsoft.com/v1.0/me/todo/lists/${r.selectedTaskListId}/tasks/${t}`,method:"DELETE",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(n.status!==204)throw new Error(`Failed to delete task: ${n.text}`)}var Nt=class{static serializeJSONBlob(e){return JSON.stringify(e)}static serializeAccounts(e){let t={};return Object.keys(e).map(function(n){var i;let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,realm:o.realm,local_account_id:o.localAccountId,username:o.username,authority_type:o.authorityType,name:o.name,client_info:o.clientInfo,last_modification_time:o.lastModificationTime,last_modification_app:o.lastModificationApp,tenantProfiles:(i=o.tenantProfiles)==null?void 0:i.map(s=>JSON.stringify(s))}}),t}static serializeIdTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm}}),t}static serializeAccessTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm,target:o.target,cached_at:o.cachedAt,expires_on:o.expiresOn,extended_expires_on:o.extendedExpiresOn,refresh_on:o.refreshOn,key_id:o.keyId,token_type:o.tokenType,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash}}),t}static serializeRefreshTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,family_id:o.familyId,target:o.target,realm:o.realm}}),t}static serializeAppMetadata(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={client_id:o.clientId,environment:o.environment,family_id:o.familyId}}),t}static serializeAllCache(e){return{Account:this.serializeAccounts(e.accounts),IdToken:this.serializeIdTokens(e.idTokens),AccessToken:this.serializeAccessTokens(e.accessTokens),RefreshToken:this.serializeRefreshTokens(e.refreshTokens),AppMetadata:this.serializeAppMetadata(e.appMetadata)}}};var f={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},P={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},je=[f.OPENID_SCOPE,f.PROFILE_SCOPE,f.OFFLINE_ACCESS_SCOPE],ms=[...je,f.EMAIL_SCOPE],x={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"};var Ee={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Er={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},at={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Ro={PLAIN:"plain",S256:"S256"},en={CODE:"code",IDTOKEN_TOKEN:"id_token token",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"};var tn={QUERY:"query",FRAGMENT:"fragment",FORM_POST:"form_post"},Oe={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},Tr={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},$={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},N={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var rn="appmetadata",Xc="client_info",ct="1",yr={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},ie={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Y={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},w={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Ke={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},ko={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},wo={username:"username",password:"password"},nn={httpSuccess:200,httpBadRequest:400},vt={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Oo={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},H={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"};var on=300;var No="unexpected_error",vo="post_request_failed";var Jc={[No]:"Unexpected error in authentication.",[vo]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},ap={unexpectedError:{code:No,desc:Jc[No]},postRequestFailed:{code:vo,desc:Jc[vo]}},v=class r extends Error{constructor(e,t,n){let o=t?`${e}: ${t}`:e;super(o),Object.setPrototypeOf(this,r.prototype),this.errorCode=e||f.EMPTY_STRING,this.errorMessage=t||f.EMPTY_STRING,this.subError=n||f.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};var z={};Pe(z,{authTimeNotFound:()=>Ye,authorizationCodeMissingFromServerResponse:()=>jt,bindingKeyNotRemoved:()=>Kt,cannotAppendScopeSet:()=>Gt,cannotRemoveEmptyScope:()=>Bt,clientInfoDecodingError:()=>dt,clientInfoEmptyError:()=>bt,deviceCodeExpired:()=>dn,deviceCodePollingCancelled:()=>cn,deviceCodeUnknownError:()=>ln,emptyInputScopeSet:()=>ht,endSessionEndpointNotSupported:()=>Yt,endpointResolutionError:()=>se,hashNotDeserialized:()=>xt,invalidAssertion:()=>fn,invalidCacheEnvironment:()=>We,invalidCacheRecord:()=>qt,invalidClientCredential:()=>pn,invalidState:()=>Ne,keyIdMissing:()=>zt,maxAgeTranspired:()=>Ht,methodNotImplemented:()=>R,missingTenantIdError:()=>Tn,multipleMatchingAccounts:()=>an,multipleMatchingAppMetadata:()=>Ft,multipleMatchingTokens:()=>sn,nestedAppAuthBridgeDisabled:()=>yn,networkError:()=>Pt,noAccountFound:()=>un,noAccountInSilentRequest:()=>ze,noCryptoObject:()=>ft,noNetworkConnectivity:()=>gn,nonceMismatch:()=>Ut,nullOrEmptyToken:()=>Mt,openIdConfigError:()=>Dt,requestCannotBeMade:()=>$t,stateMismatch:()=>Lt,stateNotFound:()=>ut,tokenClaimsCnfRequiredForSignedJwt:()=>Vt,tokenParsingError:()=>lt,tokenRefreshRequired:()=>Qe,unexpectedCredentialType:()=>hn,userCanceled:()=>En,userTimeoutReached:()=>mn});var dt="client_info_decoding_error",bt="client_info_empty_error",lt="token_parsing_error",Mt="null_or_empty_token",se="endpoints_resolution_error",Pt="network_error",Dt="openid_config_error",xt="hash_not_deserialized",Ne="invalid_state",Lt="state_mismatch",ut="state_not_found",Ut="nonce_mismatch",Ye="auth_time_not_found",Ht="max_age_transpired",sn="multiple_matching_tokens",an="multiple_matching_accounts",Ft="multiple_matching_appMetadata",$t="request_cannot_be_made",Bt="cannot_remove_empty_scope",Gt="cannot_append_scopeset",ht="empty_input_scopeset",cn="device_code_polling_cancelled",dn="device_code_expired",ln="device_code_unknown_error",ze="no_account_in_silent_request",qt="invalid_cache_record",We="invalid_cache_environment",un="no_account_found",ft="no_crypto_object",hn="unexpected_credential_type",fn="invalid_assertion",pn="invalid_client_credential",Qe="token_refresh_required",mn="user_timeout_reached",Vt="token_claims_cnf_required_for_signedjwt",jt="authorization_code_missing_from_server_response",Kt="binding_key_not_removed",Yt="end_session_endpoint_not_supported",zt="key_id_missing",gn="no_network_connectivity",En="user_canceled",Tn="missing_tenant_id_error",R="method_not_implemented",yn="nested_app_auth_bridge_disabled";var S={[dt]:"The client info could not be parsed/decoded correctly",[bt]:"The client info was empty",[lt]:"Token cannot be parsed",[Mt]:"The token is null or empty",[se]:"Endpoints cannot be resolved",[Pt]:"Network request failed",[Dt]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[xt]:"The hash parameters could not be deserialized",[Ne]:"State was not the expected format",[Lt]:"State mismatch error",[ut]:"State not found",[Ut]:"Nonce mismatch error",[Ye]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Ht]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[sn]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[an]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Ft]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[$t]:"Token request cannot be made without authorization code or refresh token.",[Bt]:"Cannot remove null or empty scope from ScopeSet",[Gt]:"Cannot append ScopeSet",[ht]:"Empty input ScopeSet cannot be processed",[cn]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[dn]:"Device code is expired.",[ln]:"Device code stopped polling for unknown reasons.",[ze]:"Please pass an account object, silent flow is not supported without account information",[qt]:"Cache record object was null or undefined.",[We]:"Invalid environment when attempting to create cache entry",[un]:"No account found in cache for given key.",[ft]:"No crypto object detected.",[hn]:"Unexpected credential type.",[fn]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[pn]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Qe]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[mn]:"User defined timeout for device code polling reached",[Vt]:"Cannot generate a POP jwt if the token_claims are not populated",[jt]:"Server response does not contain an authorization code to proceed",[Kt]:"Could not remove the credential's binding key from storage.",[Yt]:"The provided authority does not support logout",[zt]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[gn]:"No network connectivity. Check your internet connection.",[En]:"User cancelled the flow.",[Tn]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[R]:"This method has not been implemented",[yn]:"The nested app auth bridge is disabled"},cp={clientInfoDecodingError:{code:dt,desc:S[dt]},clientInfoEmptyError:{code:bt,desc:S[bt]},tokenParsingError:{code:lt,desc:S[lt]},nullOrEmptyToken:{code:Mt,desc:S[Mt]},endpointResolutionError:{code:se,desc:S[se]},networkError:{code:Pt,desc:S[Pt]},unableToGetOpenidConfigError:{code:Dt,desc:S[Dt]},hashNotDeserialized:{code:xt,desc:S[xt]},invalidStateError:{code:Ne,desc:S[Ne]},stateMismatchError:{code:Lt,desc:S[Lt]},stateNotFoundError:{code:ut,desc:S[ut]},nonceMismatchError:{code:Ut,desc:S[Ut]},authTimeNotFoundError:{code:Ye,desc:S[Ye]},maxAgeTranspired:{code:Ht,desc:S[Ht]},multipleMatchingTokens:{code:sn,desc:S[sn]},multipleMatchingAccounts:{code:an,desc:S[an]},multipleMatchingAppMetadata:{code:Ft,desc:S[Ft]},tokenRequestCannotBeMade:{code:$t,desc:S[$t]},removeEmptyScopeError:{code:Bt,desc:S[Bt]},appendScopeSetError:{code:Gt,desc:S[Gt]},emptyInputScopeSetError:{code:ht,desc:S[ht]},DeviceCodePollingCancelled:{code:cn,desc:S[cn]},DeviceCodeExpired:{code:dn,desc:S[dn]},DeviceCodeUnknownError:{code:ln,desc:S[ln]},NoAccountInSilentRequest:{code:ze,desc:S[ze]},invalidCacheRecord:{code:qt,desc:S[qt]},invalidCacheEnvironment:{code:We,desc:S[We]},noAccountFound:{code:un,desc:S[un]},noCryptoObj:{code:ft,desc:S[ft]},unexpectedCredentialType:{code:hn,desc:S[hn]},invalidAssertion:{code:fn,desc:S[fn]},invalidClientCredential:{code:pn,desc:S[pn]},tokenRefreshRequired:{code:Qe,desc:S[Qe]},userTimeoutReached:{code:mn,desc:S[mn]},tokenClaimsRequired:{code:Vt,desc:S[Vt]},noAuthorizationCodeFromServer:{code:jt,desc:S[jt]},bindingKeyNotRemovedError:{code:Kt,desc:S[Kt]},logoutNotSupported:{code:Yt,desc:S[Yt]},keyIdMissing:{code:zt,desc:S[zt]},noNetworkConnectivity:{code:gn,desc:S[gn]},userCanceledError:{code:En,desc:S[En]},missingTenantIdError:{code:Tn,desc:S[Tn]},nestedAppAuthBridgeDisabled:{code:yn,desc:S[yn]}},Ar=class r extends v{constructor(e,t){super(e,t?`${S[e]}: ${t}`:S[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,r.prototype)}};function p(r,e){return new Ar(r,e)}var gs={createNewGuid:()=>{throw p(R)},base64Decode:()=>{throw p(R)},base64Encode:()=>{throw p(R)},base64UrlEncode:()=>{throw p(R)},encodeKid:()=>{throw p(R)},async getPublicKeyThumbprint(){throw p(R)},async removeTokenBindingKey(){throw p(R)},async clearKeystore(){throw p(R)},async signJwt(){throw p(R)},async hashString(){throw p(R)}};var G;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace"})(G||(G={}));var Xe=class r{constructor(e,t,n){this.level=G.Info;let o=()=>{},i=e||r.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:G.Info,this.correlationId=i.correlationId||f.EMPTY_STRING,this.packageName=t||f.EMPTY_STRING,this.packageVersion=n||f.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:G.Info}}clone(e,t,n){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let i=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${G[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:G.Error,containsPii:!1,correlationId:t||f.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:G.Error,containsPii:!0,correlationId:t||f.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:G.Warning,containsPii:!1,correlationId:t||f.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:G.Warning,containsPii:!0,correlationId:t||f.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:G.Info,containsPii:!1,correlationId:t||f.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:G.Info,containsPii:!0,correlationId:t||f.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:G.Verbose,containsPii:!1,correlationId:t||f.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:G.Verbose,containsPii:!0,correlationId:t||f.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:G.Trace,containsPii:!1,correlationId:t||f.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:G.Trace,containsPii:!0,correlationId:t||f.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};var bo="@azure/msal-common",Cr="15.4.0";var Wt={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};var W={};Pe(W,{createAccessTokenEntity:()=>ys,createIdTokenEntity:()=>Ts,createRefreshTokenEntity:()=>As,generateAppMetadataKey:()=>Cp,generateAuthorityMetadataExpiresAt:()=>Do,generateCredentialKey:()=>In,isAccessTokenEntity:()=>up,isAppMetadataEntity:()=>Ip,isAuthorityMetadataEntity:()=>Sp,isAuthorityMetadataExpired:()=>xo,isCredentialEntity:()=>Po,isIdTokenEntity:()=>hp,isRefreshTokenEntity:()=>fp,isServerTelemetryEntity:()=>yp,isThrottlingEntity:()=>Ap,updateAuthorityEndpointMetadata:()=>Sr,updateCloudDiscoveryMetadata:()=>Sn});var Mo={};Pe(Mo,{checkMaxAge:()=>An,extractTokenClaims:()=>Je,getJWSPayload:()=>Zc});function Je(r,e){let t=Zc(r);try{let n=e(t);return JSON.parse(n)}catch(n){throw p(lt)}}function Zc(r){if(!r)throw p(Mt);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(r);if(!t||t.length<4)throw p(lt);return t[2]}function An(r,e){if(e===0||Date.now()-3e5>r+e)throw p(Ht)}var J={};Pe(J,{delay:()=>lp,isTokenExpired:()=>Ir,nowSeconds:()=>Te,toDateFromSeconds:()=>Cn,toSecondsFromDate:()=>dp,wasClockTurnedBack:()=>Es});function Te(){return Math.round(new Date().getTime()/1e3)}function dp(r){return r.getTime()/1e3}function Cn(r){return r?new Date(Number(r)*1e3):new Date}function Ir(r,e){let t=Number(r)||0;return Te()+e>t}function Es(r){return Number(r)>Te()}function lp(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}function In(r){return[pp(r),mp(r),gp(r),Ep(r),Tp(r)].join($.CACHE_KEY_SEPARATOR).toLowerCase()}function Ts(r,e,t,n,o){return{credentialType:N.ID_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t,realm:o}}function ys(r,e,t,n,o,i,s,a,c,d,l,u,g,m,A){var U,j;let C={homeAccountId:r,credentialType:N.ACCESS_TOKEN,secret:t,cachedAt:Te().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:n,realm:o,target:i,tokenType:l||w.BEARER};if(u&&(C.userAssertionHash=u),d&&(C.refreshOn=d.toString()),m&&(C.requestedClaims=m,C.requestedClaimsHash=A),((U=C.tokenType)==null?void 0:U.toLowerCase())!==w.BEARER.toLowerCase())switch(C.credentialType=N.ACCESS_TOKEN_WITH_AUTH_SCHEME,C.tokenType){case w.POP:let q=Je(t,c);if(!((j=q==null?void 0:q.cnf)!=null&&j.kid))throw p(Vt);C.keyId=q.cnf.kid;break;case w.SSH:C.keyId=g}return C}function As(r,e,t,n,o,i,s){let a={credentialType:N.REFRESH_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t};return i&&(a.userAssertionHash=i),o&&(a.familyId=o),s&&(a.expiresOn=s.toString()),a}function Po(r){return r.hasOwnProperty("homeAccountId")&&r.hasOwnProperty("environment")&&r.hasOwnProperty("credentialType")&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("secret")}function up(r){return r?Po(r)&&r.hasOwnProperty("realm")&&r.hasOwnProperty("target")&&(r.credentialType===N.ACCESS_TOKEN||r.credentialType===N.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function hp(r){return r?Po(r)&&r.hasOwnProperty("realm")&&r.credentialType===N.ID_TOKEN:!1}function fp(r){return r?Po(r)&&r.credentialType===N.REFRESH_TOKEN:!1}function pp(r){return[r.homeAccountId,r.environment].join($.CACHE_KEY_SEPARATOR).toLowerCase()}function mp(r){let e=r.credentialType===N.REFRESH_TOKEN&&r.familyId||r.clientId;return[r.credentialType,e,r.realm||""].join($.CACHE_KEY_SEPARATOR).toLowerCase()}function gp(r){return(r.target||"").toLowerCase()}function Ep(r){return(r.requestedClaimsHash||"").toLowerCase()}function Tp(r){return r.tokenType&&r.tokenType.toLowerCase()!==w.BEARER.toLowerCase()?r.tokenType.toLowerCase():""}function yp(r,e){let t=r.indexOf(Y.CACHE_KEY)===0,n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&n}function Ap(r,e){let t=!1;r&&(t=r.indexOf(Ke.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),t&&n}function Cp({environment:r,clientId:e}){return[rn,r,e].join($.CACHE_KEY_SEPARATOR).toLowerCase()}function Ip(r,e){return e?r.indexOf(rn)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function Sp(r,e){return e?r.indexOf(yr.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function Do(){return Te()+yr.REFRESH_TIME_SECONDS}function Sr(r,e,t){r.authorization_endpoint=e.authorization_endpoint,r.token_endpoint=e.token_endpoint,r.end_session_endpoint=e.end_session_endpoint,r.issuer=e.issuer,r.endpointsFromNetwork=t,r.jwks_uri=e.jwks_uri}function Sn(r,e,t){r.aliases=e.aliases,r.preferred_cache=e.preferred_cache,r.preferred_network=e.preferred_network,r.aliasesFromNetwork=t}function xo(r){return r.expiresAt<=Te()}var _r="redirect_uri_empty",Lo="claims_request_parsing_error",Rr="authority_uri_insecure",Ze="url_parse_error",kr="empty_url_error",wr="empty_input_scopes_error",Or="invalid_prompt_value",et="invalid_claims",Nr="token_request_empty",vr="logout_request_empty",br="invalid_code_challenge_method",pt="pkce_params_missing",Qt="invalid_cloud_discovery_metadata",Mr="invalid_authority_metadata",Pr="untrusted_authority",mt="missing_ssh_jwk",Uo="missing_ssh_kid",Ho="missing_nonce_authentication_header",Fo="invalid_authentication_header",$o="cannot_set_OIDCOptions",Bo="cannot_allow_platform_broker",Go="authority_mismatch";var F={[_r]:"A redirect URI is required for all calls, and none has been set.",[Lo]:"Could not parse the given claims request object.",[Rr]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Ze]:"URL could not be parsed into appropriate segments.",[kr]:"URL was empty or null.",[wr]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Or]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[et]:"Given claims parameter must be a stringified JSON object.",[Nr]:"Token request was empty and not found in cache.",[vr]:"The logout request was null or undefined.",[br]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[pt]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Qt]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Mr]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Pr]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[mt]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Uo]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Ho]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Fo]:"Invalid authentication header provided",[$o]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Bo]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Go]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},GI={redirectUriNotSet:{code:_r,desc:F[_r]},claimsRequestParsingError:{code:Lo,desc:F[Lo]},authorityUriInsecure:{code:Rr,desc:F[Rr]},urlParseError:{code:Ze,desc:F[Ze]},urlEmptyError:{code:kr,desc:F[kr]},emptyScopesError:{code:wr,desc:F[wr]},invalidPrompt:{code:Or,desc:F[Or]},invalidClaimsRequest:{code:et,desc:F[et]},tokenRequestEmptyError:{code:Nr,desc:F[Nr]},logoutRequestEmptyError:{code:vr,desc:F[vr]},invalidCodeChallengeMethod:{code:br,desc:F[br]},invalidCodeChallengeParams:{code:pt,desc:F[pt]},invalidCloudDiscoveryMetadata:{code:Qt,desc:F[Qt]},invalidAuthorityMetadata:{code:Mr,desc:F[Mr]},untrustedAuthority:{code:Pr,desc:F[Pr]},missingSshJwk:{code:mt,desc:F[mt]},missingSshKid:{code:Uo,desc:F[Uo]},missingNonceAuthenticationHeader:{code:Ho,desc:F[Ho]},invalidAuthenticationHeader:{code:Fo,desc:F[Fo]},cannotSetOIDCOptions:{code:$o,desc:F[$o]},cannotAllowPlatformBroker:{code:Bo,desc:F[Bo]},authorityMismatch:{code:Go,desc:F[Go]}},Cs=class r extends v{constructor(e){super(e,F[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,r.prototype)}};function M(r){return new Cs(r)}var B=class{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return Object.keys(t).length===0}catch(t){}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},n=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return n.forEach(i=>{if(i.trim()){let[s,a]=i.split(/=(.+)/g,2);s&&a&&(t[o(s)]=o(a))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(t){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}};var V=class r{constructor(e){let t=e?B.trimArrayEntries([...e]):[],n=t?B.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw M(wr);this.scopes=new Set,n.forEach(o=>this.scopes.add(o))}static fromString(e){let n=(e||f.EMPTY_STRING).split(" ");return new r(n)}static createSearchScopes(e){let t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(f.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){let t=this.printScopesLowerCase().split(" "),n=new r(t);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return ms.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch(t){throw p(Gt)}}removeScope(e){if(!e)throw p(Bt);this.scopes.delete(e.trim())}removeOIDCScopes(){ms.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw p(ht);let t=new Set;return e.scopes.forEach(n=>t.add(n.toLowerCase())),this.scopes.forEach(n=>t.add(n.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw p(ht);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),n=e.getScopeCount(),o=this.getScopeCount();return t.size<o+n}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):f.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};function Dr(r,e){if(!r)throw p(bt);try{let t=e(r);return JSON.parse(t)}catch(t){throw p(dt)}}function De(r){if(!r)throw p(dt);let e=r.split($.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?f.EMPTY_STRING:e[1]}}function ed(r,e){return!!r&&!!e&&r===e.split(".")[1]}function _n(r,e,t,n){if(n){let{oid:o,sub:i,tid:s,name:a,tfp:c,acr:d}=n,l=s||c||d||"";return{tenantId:l,localAccountId:o||i||"",name:a,isHomeTenant:ed(l,r)}}else return{tenantId:t,localAccountId:e,isHomeTenant:ed(t,r)}}function qo(r,e,t,n){let o=r;if(e){let{isHomeTenant:i,...s}=e;o={...r,...s}}if(t){let{isHomeTenant:i,...s}=_n(r.homeAccountId,r.localAccountId,r.tenantId,t);return o={...o,...s,idTokenClaims:t,idToken:n},o}return o}var Ie={Default:0,Adfs:1,Dsts:2,Ciam:3};function Vo(r){return r&&(r.tid||r.tfp||r.acr)||null}var Se={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};var ae=class r{generateAccountId(){return[this.homeAccountId,this.environment].join($.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join($.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){var d,l,u,g,m,A;let o=new r;t.authorityType===Ie.Adfs?o.authorityType=Tr.ADFS_ACCOUNT_TYPE:t.protocolMode===Se.OIDC?o.authorityType=Tr.GENERIC_ACCOUNT_TYPE:o.authorityType=Tr.MSSTS_ACCOUNT_TYPE;let i;e.clientInfo&&n&&(i=Dr(e.clientInfo,n)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;let s=e.environment||t&&t.getPreferredCache();if(!s)throw p(We);o.environment=s,o.realm=(i==null?void 0:i.utid)||Vo(e.idTokenClaims)||"",o.localAccountId=(i==null?void 0:i.uid)||((d=e.idTokenClaims)==null?void 0:d.oid)||((l=e.idTokenClaims)==null?void 0:l.sub)||"";let a=((u=e.idTokenClaims)==null?void 0:u.preferred_username)||((g=e.idTokenClaims)==null?void 0:g.upn),c=(m=e.idTokenClaims)!=null&&m.emails?e.idTokenClaims.emails[0]:null;if(o.username=a||c||"",o.name=((A=e.idTokenClaims)==null?void 0:A.name)||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{let C=_n(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[C]}return o}static createFromAccountInfo(e,t,n){var i;let o=new r;return o.authorityType=e.authorityType||Tr.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=t,o.msGraphHost=n,o.tenantProfiles=Array.from(((i=e.tenantProfiles)==null?void 0:i.values())||[]),o}static generateHomeAccountId(e,t,n,o,i){if(!(t===Ie.Adfs||t===Ie.Dsts)){if(e)try{let s=Dr(e,o.base64Decode);if(s.uid&&s.utid)return`${s.uid}.${s.utid}`}catch(s){}n.warning("No client info in response")}return(i==null?void 0:i.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let o=!0;if(n){let i=e.idTokenClaims||{},s=t.idTokenClaims||{};o=i.iat===s.iat&&i.nonce===s.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o}};var gt={};Pe(gt,{getDeserializedResponse:()=>Is,mapToQueryString:()=>xe,stripLeadingHashOrQuery:()=>td});function td(r){return r.startsWith("#/")?r.substring(2):r.startsWith("#")||r.startsWith("?")?r.substring(1):r}function Is(r){if(!r||r.indexOf("=")<0)return null;try{let e=td(r),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.ear_jwe||t.error||t.error_description||t.state)return t}catch(e){throw p(xt)}return null}function xe(r){let e=new Array;return r.forEach((t,n)=>{e.push(`${n}=${encodeURIComponent(t)}`)}),e.join("&")}var O=class r{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw M(kr);e.includes("#")||(this._urlString=r.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return B.endsWith(t,"?")?t=t.slice(0,-1):B.endsWith(t,"?/")&&(t=t.slice(0,-2)),B.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(t){throw M(Ze)}if(!e.HostNameAndPort||!e.PathSegments)throw M(Ze);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw M(Rr)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return r.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),n=t.PathSegments;return e&&n.length!==0&&(n[0]===Ee.COMMON||n[0]===Ee.ORGANIZATIONS)&&(n[0]=e),r.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw M(Ze);let n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=n.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),n.PathSegments=o,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw M(Ze);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===f.FORWARD_SLASH){let o=new r(t).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Is(e)}};var nd={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Ss=nd.endpointMetadata,_s=nd.instanceDiscoveryMetadata,Rs=new Set;_s.metadata.forEach(r=>{r.aliases.forEach(e=>{Rs.add(e)})});function od(r,e){var o;let t,n=r.canonicalAuthority;if(n){let i=new O(n).getUrlComponents().HostNameAndPort;t=rd(i,(o=r.cloudDiscoveryMetadata)==null?void 0:o.metadata,ie.CONFIG,e)||rd(i,_s.metadata,ie.HARDCODED_VALUES,e)||r.knownAuthorities}return t||[]}function rd(r,e,t,n){if(n==null||n.trace(`getAliasesFromMetadata called with source: ${t}`),r&&e){let o=Rn(e,r);if(o)return n==null||n.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),o.aliases;n==null||n.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function id(r){return Rn(_s.metadata,r)}function Rn(r,e){for(let t=0;t<r.length;t++){let n=r[t];if(n.aliases.includes(e))return n}return null}var jo="cache_quota_exceeded",kn="cache_error_unknown";var ks={[jo]:"Exceeded cache storage capacity.",[kn]:"Unexpected error occurred when using cache storage."},xr=class r extends Error{constructor(e,t){let n=t||(ks[e]?ks[e]:ks[kn]);super(`${e}: ${n}`),Object.setPrototypeOf(this,r.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}};var Et=class{constructor(e,t,n,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(bo,Cr),this.staticAuthorityOptions=o}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){let t=this.getAllAccounts(e);return t.length>1?t.sort(o=>o.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){let t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(n=>this.getTenantProfilesFromAccountEntity(n,t==null?void 0:t.tenantId,t))}getTenantedAccountInfoByFilter(e,t,n,o){let i=null,s;if(o&&!this.tenantProfileMatchesFilter(n,o))return null;let a=this.getIdToken(e,t,n.tenantId);return a&&(s=Je(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,o))?null:(i=qo(e,n,s,a==null?void 0:a.secret),i)}getTenantProfilesFromAccountEntity(e,t,n){let o=e.getAccountInfo(),i=o.tenantProfiles||new Map,s=this.getTokenKeys();if(t){let c=i.get(t);if(c)i=new Map([[t,c]]);else return[]}let a=[];return i.forEach(c=>{let d=this.getTenantedAccountInfoByFilter(o,s,c,n);d&&a.push(d)}),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,n){var o,i,s,a;if(!e)throw p(qt);try{e.account&&await this.setAccount(e.account,t),e.idToken&&(n==null?void 0:n.idToken)!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&(n==null?void 0:n.accessToken)!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&(n==null?void 0:n.refreshToken)!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(c){throw(o=this.commonLogger)==null||o.error("CacheManager.saveCacheRecord: failed"),c instanceof Error?((i=this.commonLogger)==null||i.errorPii(`CacheManager.saveCacheRecord: ${c.message}`,t),c.name==="QuotaExceededError"||c.name==="NS_ERROR_DOM_QUOTA_REACHED"||c.message.includes("exceeded the quota")?((s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new xr(jo)):new xr(c.name,c.message)):((a=this.commonLogger)==null||a.errorPii(`CacheManager.saveCacheRecord: ${c}`,t),new xr(kn))}}async saveAccessToken(e,t){let n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},o=this.getTokenKeys(),i=V.fromString(e.target),s=[];o.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,n,!1))return;let c=this.getAccessTokenCredential(a);c&&this.credentialMatchesFilter(c,n)&&V.fromString(c.target).intersectingScopeSets(i)&&s.push(this.removeAccessToken(a))}),await Promise.all(s),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){let t=this.getAccountKeys(),n=[];return t.forEach(o=>{var c;if(!this.isAccountKey(o,e.homeAccountId))return;let i=this.getAccount(o,this.commonLogger);if(!i||e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId)||e.username&&!this.matchUsername(i.username,e.username)||e.environment&&!this.matchEnvironment(i,e.environment)||e.realm&&!this.matchRealm(i,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;let s={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},a=(c=i.tenantProfiles)==null?void 0:c.filter(d=>this.tenantProfileMatchesFilter(d,s));a&&a.length===0||n.push(i)}),n}isAccountKey(e,t,n){return!(e.split($.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split($.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(t.indexOf(N.ID_TOKEN.toLowerCase())===-1&&t.indexOf(N.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(N.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(N.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(N.REFRESH_TOKEN.toLowerCase())>-1){let n=`${N.REFRESH_TOKEN}${$.CACHE_KEY_SEPARATOR}${this.clientId}${$.CACHE_KEY_SEPARATOR}`,o=`${N.REFRESH_TOKEN}${$.CACHE_KEY_SEPARATOR}${ct}${$.CACHE_KEY_SEPARATOR}`;if(t.indexOf(n.toLowerCase())===-1&&t.indexOf(o.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===N.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===w.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),n={};return t.forEach(o=>{if(!this.isAppMetadata(o))return;let i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(n[o]=i))}),n}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),n=null;return t.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;let i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(n=i)}),n}async removeAllAccounts(){let e=this.getAccountKeys(),t=[];e.forEach(n=>{t.push(this.removeAccount(n))}),await Promise.all(t)}async removeAccount(e){let t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){let t=this.getTokenKeys(),n=e.generateAccountId(),o=[];t.idToken.forEach(i=>{i.indexOf(n)===0&&this.removeIdToken(i)}),t.accessToken.forEach(i=>{i.indexOf(n)===0&&o.push(this.removeAccessToken(i))}),t.refreshToken.forEach(i=>{i.indexOf(n)===0&&this.removeRefreshToken(i)}),await Promise.all(o)}async removeAccessToken(e){let t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===N.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===w.POP){let o=t.keyId;if(o)try{await this.cryptoImpl.removeTokenBindingKey(o)}catch(i){throw p(Kt)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){let t=ae.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getIdToken called");let s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:N.ID_TOKEN,clientId:this.clientId,realm:n},a=this.getIdTokensByFilter(s,t),c=a.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let d=a;if(!n){let l=new Map;a.forEach((g,m)=>{g.realm===e.tenantId&&l.set(m,g)});let u=l.size;if(u<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(u===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),l.values().next().value;d=l}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),d.forEach((l,u)=>{this.removeIdToken(u)}),o&&i&&o.addFields({multiMatchedID:a.size},i),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){let n=t&&t.idToken||this.getTokenKeys().idToken,o=new Map;return n.forEach(i=>{if(!this.idTokenKeyMatchesFilter(i,{clientId:this.clientId,...e}))return;let s=this.getIdTokenCredential(i);s&&this.credentialMatchesFilter(s,e)&&o.set(i,s)}),o}idTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,n,o,i,s){this.commonLogger.trace("CacheManager - getAccessToken called");let a=V.createSearchScopes(t.scopes),c=t.authenticationScheme||w.BEARER,d=c&&c.toLowerCase()!==w.BEARER.toLowerCase()?N.ACCESS_TOKEN_WITH_AUTH_SCHEME:N.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:d,clientId:this.clientId,realm:o||e.tenantId,target:a,tokenType:c,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=n&&n.accessToken||this.getTokenKeys().accessToken,g=[];u.forEach(A=>{if(this.accessTokenKeyMatchesFilter(A,l,!0)){let C=this.getAccessTokenCredential(A);C&&this.credentialMatchesFilter(C,l)&&g.push(C)}});let m=g.length;return m<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):m>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),g.forEach(A=>{this.removeAccessToken(In(A))}),i&&s&&i.addFields({multiMatchedAT:g.length},s),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),g[0])}accessTokenKeyMatchesFilter(e,t,n){let o=e.toLowerCase();if(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&o.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&o.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){let i=t.target.asArray();for(let s=0;s<i.length;s++){if(n&&!o.includes(i[s].toLowerCase()))return!1;if(!n&&o.includes(i[s].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){let t=this.getTokenKeys(),n=[];return t.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,e,!0))return;let i=this.getAccessTokenCredential(o);i&&this.credentialMatchesFilter(i,e)&&n.push(i)}),n}getRefreshToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");let s=t?ct:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:N.REFRESH_TOKEN,clientId:this.clientId,familyId:s},c=n&&n.refreshToken||this.getTokenKeys().refreshToken,d=[];c.forEach(u=>{if(this.refreshTokenKeyMatchesFilter(u,a)){let g=this.getRefreshTokenCredential(u);g&&this.credentialMatchesFilter(g,a)&&d.push(g)}});let l=d.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&o&&i&&o.addFields({multiMatchedRT:l},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),d[0])}refreshTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.familyId&&n.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),o=Object.keys(n).map(s=>n[s]),i=o.length;if(i<1)return null;if(i>1)throw p(Ft);return o[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===ct)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){let n=e.oid||e.sub;return t===n}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var n;return t.toLowerCase()===((n=e.name)==null?void 0:n.toLowerCase())}matchUsername(e,t){return!!(e&&typeof e=="string"&&(t==null?void 0:t.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let o=od(this.staticAuthorityOptions,this.commonLogger);if(o.includes(t)&&o.includes(e.environment))return!0}let n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){var n;return((n=e.realm)==null?void 0:n.toLowerCase())===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==N.ACCESS_TOKEN&&e.credentialType!==N.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:V.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(rn)!==-1}isAuthorityMetadata(e){return e.indexOf(yr.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${yr.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(let n in t)e[n]=t[n];return e}},wn=class extends Et{async setAccount(){throw p(R)}getAccount(){throw p(R)}async setIdTokenCredential(){throw p(R)}getIdTokenCredential(){throw p(R)}async setAccessTokenCredential(){throw p(R)}getAccessTokenCredential(){throw p(R)}async setRefreshTokenCredential(){throw p(R)}getRefreshTokenCredential(){throw p(R)}setAppMetadata(){throw p(R)}getAppMetadata(){throw p(R)}setServerTelemetry(){throw p(R)}getServerTelemetry(){throw p(R)}setAuthorityMetadata(){throw p(R)}getAuthorityMetadata(){throw p(R)}getAuthorityMetadataKeys(){throw p(R)}setThrottlingCache(){throw p(R)}getThrottlingCache(){throw p(R)}removeItem(){throw p(R)}getKeys(){throw p(R)}getAccountKeys(){throw p(R)}getTokenKeys(){throw p(R)}};var _p={tokenRenewalOffsetSeconds:on,preventCorsPreflight:!1},Rp={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:G.Info,correlationId:f.EMPTY_STRING},kp={claimsBasedCachingEnabled:!1},wp={async sendGetRequestAsync(){throw p(R)},async sendPostRequestAsync(){throw p(R)}},Op={sku:f.SKU,version:Cr,cpu:f.EMPTY_STRING,os:f.EMPTY_STRING},Np={clientSecret:f.EMPTY_STRING,clientAssertion:void 0},vp={azureCloudInstance:Wt.None,tenant:`${f.DEFAULT_COMMON_TENANT}`},bp={application:{appName:"",appVersion:""}};function sd({authOptions:r,systemOptions:e,loggerOptions:t,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:s,clientCredentials:a,libraryInfo:c,telemetry:d,serverTelemetryManager:l,persistencePlugin:u,serializableCache:g}){let m={...Rp,...t};return{authOptions:Mp(r),systemOptions:{..._p,...e},loggerOptions:m,cacheOptions:{...kp,...n},storageInterface:o||new wn(r.clientId,gs,new Xe(m)),networkInterface:i||wp,cryptoInterface:s||gs,clientCredentials:a||Np,libraryInfo:{...Op,...c},telemetry:{...bp,...d},serverTelemetryManager:l||null,persistencePlugin:u||null,serializableCache:g||null}}function Mp(r){return{clientCapabilities:[],azureCloudOptions:vp,skipAuthorityMetadataCache:!1,instanceAware:!1,...r}}function Ko(r){return r.authOptions.authority.options.protocolMode===Se.OIDC}var ce={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var I={};Pe(I,{addApplicationTelemetry:()=>vn,addAuthorizationCode:()=>Ea,addBrokerParameters:()=>nt,addCcsOid:()=>tt,addCcsUpn:()=>Tt,addClaims:()=>tr,addClientAssertion:()=>Pn,addClientAssertionType:()=>Dn,addClientCapabilitiesToClaims:()=>ad,addClientId:()=>Zt,addClientInfo:()=>nr,addClientSecret:()=>Mn,addCodeChallengeParams:()=>Yp,addCodeVerifier:()=>ya,addCorrelationId:()=>rr,addDeviceCode:()=>zp,addDomainHint:()=>pa,addEARParameters:()=>Zp,addExtraQueryParameters:()=>rt,addGrantType:()=>xn,addIdTokenHint:()=>fa,addInstanceAware:()=>Ln,addLibraryInfo:()=>Nn,addLoginHint:()=>Ur,addLogoutHint:()=>Aa,addNativeBroker:()=>Kp,addNonce:()=>ga,addOboAssertion:()=>Wp,addPassword:()=>Jp,addPopToken:()=>Un,addPostLogoutRedirectUri:()=>ha,addPrompt:()=>ma,addRedirectUri:()=>er,addRefreshToken:()=>Ta,addRequestTokenUse:()=>Qp,addResponseMode:()=>ua,addResponseType:()=>jp,addScopes:()=>Jt,addServerTelemetry:()=>Fn,addSid:()=>Zo,addSshJwk:()=>Hn,addState:()=>bn,addThrottling:()=>$n,addUsername:()=>Xp,instrumentBrokerParams:()=>Xt});var Jo={};Pe(Jo,{ACCESS_TOKEN:()=>xp,BROKER_CLIENT_ID:()=>On,BROKER_REDIRECT_URI:()=>Xo,CCS_HEADER:()=>qp,CLAIMS:()=>vs,CLIENT_ASSERTION:()=>ea,CLIENT_ASSERTION_TYPE:()=>ta,CLIENT_ID:()=>Le,CLIENT_INFO:()=>$p,CLIENT_REQUEST_ID:()=>$s,CLIENT_SECRET:()=>Zs,CODE:()=>Ls,CODE_CHALLENGE:()=>Us,CODE_CHALLENGE_METHOD:()=>Hs,CODE_VERIFIER:()=>Fs,DEVICE_CODE:()=>Js,DOMAIN_HINT:()=>ca,EAR_JWE_CRYPTO:()=>la,EAR_JWK:()=>da,ERROR:()=>Pp,ERROR_DESCRIPTION:()=>Dp,EXPIRES_IN:()=>Up,FOCI:()=>Gp,GRANT_TYPE:()=>Ns,ID_TOKEN:()=>Lp,ID_TOKEN_HINT:()=>Xs,INSTANCE_AWARE:()=>Lr,LOGIN_HINT:()=>aa,LOGOUT_HINT:()=>ia,NATIVE_BROKER:()=>oa,NONCE:()=>Ds,OBO_ASSERTION:()=>ra,ON_BEHALF_OF:()=>Bp,POST_LOGOUT_URI:()=>Qs,PROMPT:()=>xs,REDIRECT_URI:()=>Yo,REFRESH_TOKEN:()=>Ms,REFRESH_TOKEN_EXPIRES_IN:()=>Hp,REQUESTED_TOKEN_USE:()=>na,REQ_CNF:()=>Wo,RESPONSE_MODE:()=>Os,RESPONSE_TYPE:()=>ws,RETURN_SPA_CODE:()=>Qo,SCOPE:()=>bs,SESSION_STATE:()=>Fp,SID:()=>sa,STATE:()=>Ps,TOKEN_TYPE:()=>zo,X_APP_NAME:()=>zs,X_APP_VER:()=>Ws,X_CLIENT_CPU:()=>Vs,X_CLIENT_CURR_TELEM:()=>js,X_CLIENT_EXTRA_SKU:()=>Vp,X_CLIENT_LAST_TELEM:()=>Ks,X_CLIENT_OS:()=>qs,X_CLIENT_SKU:()=>Bs,X_CLIENT_VER:()=>Gs,X_MS_LIB_CAPABILITY:()=>Ys});var Le="client_id",Yo="redirect_uri",ws="response_type",Os="response_mode",Ns="grant_type",vs="claims",bs="scope",Pp="error",Dp="error_description",xp="access_token",Lp="id_token",Ms="refresh_token",Up="expires_in",Hp="refresh_token_expires_in",Ps="state",Ds="nonce",xs="prompt",Fp="session_state",$p="client_info",Ls="code",Us="code_challenge",Hs="code_challenge_method",Fs="code_verifier",$s="client-request-id",Bs="x-client-SKU",Gs="x-client-VER",qs="x-client-OS",Vs="x-client-CPU",js="x-client-current-telemetry",Ks="x-client-last-telemetry",Ys="x-ms-lib-capability",zs="x-app-name",Ws="x-app-ver",Qs="post_logout_redirect_uri",Xs="id_token_hint",Js="device_code",Zs="client_secret",ea="client_assertion",ta="client_assertion_type",zo="token_type",Wo="req_cnf",ra="assertion",na="requested_token_use",Bp="on_behalf_of",Gp="foci",qp="X-AnchorMailbox",Qo="return_spa_code",oa="nativebroker",ia="logout_hint",sa="sid",aa="login_hint",ca="domain_hint",Vp="x-client-xtra-sku",On="brk_client_id",Xo="brk_redirect_uri",Lr="instance_aware",da="ear_jwk",la="ear_jwe_crypto";function Xt(r,e,t){if(!e)return;let n=r.get(Le);n&&r.has(On)&&(t==null||t.addFields({embeddedClientId:n,embeddedRedirectUri:r.get(Yo)},e))}function jp(r,e){r.set(ws,e)}function ua(r,e){r.set(Os,e||tn.QUERY)}function Kp(r){r.set(oa,"1")}function Jt(r,e,t=!0,n=je){t&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");let o=t?[...e||[],...n]:e||[],i=new V(o);r.set(bs,i.printScopes())}function Zt(r,e){r.set(Le,e)}function er(r,e){r.set(Yo,e)}function ha(r,e){r.set(Qs,e)}function fa(r,e){r.set(Xs,e)}function pa(r,e){r.set(ca,e)}function Ur(r,e){r.set(aa,e)}function Tt(r,e){r.set(x.CCS_HEADER,`UPN:${e}`)}function tt(r,e){r.set(x.CCS_HEADER,`Oid:${e.uid}@${e.utid}`)}function Zo(r,e){r.set(sa,e)}function tr(r,e,t){let n=ad(e,t);try{JSON.parse(n)}catch(o){throw M(et)}r.set(vs,n)}function rr(r,e){r.set($s,e)}function Nn(r,e){r.set(Bs,e.sku),r.set(Gs,e.version),e.os&&r.set(qs,e.os),e.cpu&&r.set(Vs,e.cpu)}function vn(r,e){e!=null&&e.appName&&r.set(zs,e.appName),e!=null&&e.appVersion&&r.set(Ws,e.appVersion)}function ma(r,e){r.set(xs,e)}function bn(r,e){e&&r.set(Ps,e)}function ga(r,e){r.set(Ds,e)}function Yp(r,e,t){if(e&&t)r.set(Us,e),r.set(Hs,t);else throw M(pt)}function Ea(r,e){r.set(Ls,e)}function zp(r,e){r.set(Js,e)}function Ta(r,e){r.set(Ms,e)}function ya(r,e){r.set(Fs,e)}function Mn(r,e){r.set(Zs,e)}function Pn(r,e){e&&r.set(ea,e)}function Dn(r,e){e&&r.set(ta,e)}function Wp(r,e){r.set(ra,e)}function Qp(r,e){r.set(na,e)}function xn(r,e){r.set(Ns,e)}function nr(r){r.set(Xc,"1")}function Ln(r){r.has(Lr)||r.set(Lr,"true")}function rt(r,e){Object.entries(e).forEach(([t,n])=>{!r.has(t)&&n&&r.set(t,n)})}function ad(r,e){let t;if(!r)t={};else try{t=JSON.parse(r)}catch(n){throw M(et)}return e&&e.length>0&&(t.hasOwnProperty(Er.ACCESS_TOKEN)||(t[Er.ACCESS_TOKEN]={}),t[Er.ACCESS_TOKEN][Er.XMS_CC]={values:e}),JSON.stringify(t)}function Xp(r,e){r.set(wo.username,e)}function Jp(r,e){r.set(wo.password,e)}function Un(r,e){e&&(r.set(zo,w.POP),r.set(Wo,e))}function Hn(r,e){e&&(r.set(zo,w.SSH),r.set(Wo,e))}function Fn(r,e){r.set(js,e.generateCurrentRequestHeaderValue()),r.set(Ks,e.generateLastRequestHeaderValue())}function $n(r){r.set(Ys,Ke.X_MS_LIB_CAPABILITY_VALUE)}function Aa(r,e){r.set(ia,e)}function nt(r,e,t){r.has(On)||r.set(On,e),r.has(Xo)||r.set(Xo,t)}function Zp(r,e){r.set(da,encodeURIComponent(e)),r.set(la,"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}var ti={};Pe(ti,{createDiscoveredInstance:()=>Ia});function cd(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}function dd(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}function ld(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}var h={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},a_=new Map([[h.AcquireTokenByCode,"ATByCode"],[h.AcquireTokenByRefreshToken,"ATByRT"],[h.AcquireTokenSilent,"ATS"],[h.AcquireTokenSilentAsync,"ATSAsync"],[h.AcquireTokenPopup,"ATPopup"],[h.AcquireTokenRedirect,"ATRedirect"],[h.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[h.CryptoOptsSignJwt,"CryptoSignJwt"],[h.SilentCacheClientAcquireToken,"SltCacheClientAT"],[h.SilentIframeClientAcquireToken,"SltIframeClientAT"],[h.SilentRefreshClientAcquireToken,"SltRClientAT"],[h.SsoSilent,"SsoSlt"],[h.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[h.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[h.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[h.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[h.NetworkClientSendPostRequestAsync,"NetClientSendPost"],[h.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[h.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[h.BrokerHandhshake,"BrokerHandshake"],[h.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[h.AcquireTokenByBroker,"ATByBroker"],[h.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[h.RefreshTokenClientAcquireToken,"RTClientAT"],[h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[h.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[h.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[h.AcquireTokenFromCache,"ATFromCache"],[h.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[h.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[h.AcquireTokenBySilentIframe,"ATBySltIframe"],[h.InitializeBaseRequest,"InitBaseReq"],[h.InitializeSilentRequest,"InitSltReq"],[h.InitializeClientApplication,"InitClientApplication"],[h.InitializeCache,"InitCache"],[h.ImportExistingCache,"importCache"],[h.SetUserData,"setUserData"],[h.LocalStorageUpdated,"localStorageUpdated"],[h.SilentIframeClientTokenHelper,"SIClientTHelper"],[h.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[h.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[h.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[h.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[h.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[h.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[h.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[h.GetAuthCodeUrl,"GetAuthCodeUrl"],[h.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[h.HandleCodeResponse,"HandleCodeResp"],[h.HandleResponseEar,"HandleRespEar"],[h.HandleResponseCode,"HandleRespCode"],[h.HandleResponsePlatformBroker,"HandleRespPlatBroker"],[h.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[h.AuthClientAcquireToken,"AuthClientAT"],[h.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[h.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[h.PopTokenGenerateCnf,"PopTGenCnf"],[h.PopTokenGenerateKid,"PopTGenKid"],[h.HandleServerTokenResponse,"HandleServerTRes"],[h.DeserializeResponse,"DeserializeRes"],[h.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[h.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[h.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[h.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[h.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[h.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[h.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[h.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[h.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[h.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[h.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[h.AcquireTokenByCodeAsync,"ATByCodeAsync"],[h.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[h.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[h.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[h.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[h.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[h.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[h.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[h.NativeGenerateAuthResult,"NtvGenAuthRes"],[h.RemoveHiddenIframe,"RemoveHiddenIframe"],[h.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[h.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[h.GeneratePkceCodes,"GenPkceCodes"],[h.GenerateCodeVerifier,"GenCodeVerifier"],[h.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[h.Sha256Digest,"Sha256Digest"],[h.GetRandomValues,"GetRandomValues"],[h.GenerateHKDF,"genHKDF"],[h.GenerateBaseKey,"genBaseKey"],[h.Base64Decode,"b64Decode"],[h.UrlEncodeArr,"urlEncArr"],[h.Encrypt,"encrypt"],[h.Decrypt,"decrypt"],[h.GenerateEarKey,"genEarKey"],[h.DecryptEarResponse,"decryptEarResp"]]);var ud=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let s=n==null?void 0:n.startMeasurement(e,o);if(o){let a=e+"CallCount";n==null||n.incrementFields({[a]:1},o)}try{let a=r(...i);return s==null||s.end({success:!0}),t.trace(`Returning result from ${e}`),a}catch(a){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch(c){t.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a}},k=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let s=n==null?void 0:n.startMeasurement(e,o);if(o){let a=e+"CallCount";n==null||n.incrementFields({[a]:1},o)}return n==null||n.setPreQueueTime(e,o),r(...i).then(a=>(t.trace(`Returning result from ${e}`),s==null||s.end({success:!0}),a)).catch(a=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch(c){t.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a})};var Bn=class r{constructor(e,t,n,o){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=o}async detectRegion(e,t){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(h.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)t.region_source=vt.ENVIRONMENT_VARIABLE;else{let i=r.IMDS_OPTIONS;try{let s=await k(this.getRegionFromIMDS.bind(this),h.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(f.IMDS_VERSION,i);if(s.status===nn.httpSuccess&&(n=s.body,t.region_source=vt.IMDS),s.status===nn.httpBadRequest){let a=await k(this.getCurrentVersion.bind(this),h.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!a)return t.region_source=vt.FAILED_AUTO_DETECTION,null;let c=await k(this.getRegionFromIMDS.bind(this),h.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,i);c.status===nn.httpSuccess&&(n=c.body,t.region_source=vt.IMDS)}}catch(s){return t.region_source=vt.FAILED_AUTO_DETECTION,null}}return n||(t.region_source=vt.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(e,t){var n;return(n=this.performanceClient)==null||n.addQueueMeasurement(h.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${f.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,f.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;(t=this.performanceClient)==null||t.addQueueMeasurement(h.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let n=await this.networkInterface.sendGetRequestAsync(`${f.IMDS_ENDPOINT}?format=json`,e);return n.status===nn.httpBadRequest&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?n.body["newest-versions"][0]:null}catch(n){return null}}};Bn.IMDS_OPTIONS={headers:{Metadata:"true"}};var ot=class r{constructor(e,t,n,o,i,s,a,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=a,this.correlationId=s,this.managedIdentity=c||!1,this.regionDiscovery=new Bn(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(f.CIAM_AUTH_URL))return Ie.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case f.ADFS:return Ie.Adfs;case f.DSTS:return Ie.Dsts}return Ie.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new O(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw p(se)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw p(se)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw p(se)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw p(Yt);return this.replacePath(this.metadata.end_session_endpoint)}else throw p(se)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw p(se)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw p(se)}canReplaceTenant(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Ie.Default&&this.protocolMode!==Se.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,o=new O(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,c)=>{let d=i[c];if(c===0&&this.canReplaceTenant(o)){let l=new O(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];d!==l&&(this.logger.verbose(`Replacing tenant domain name ${d} with id ${l}`),d=l)}a!==d&&(t=t.replace(`/${d}/`,`/${a}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Ie.Adfs||this.protocolMode===Se.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var o,i;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=await k(this.updateCloudDiscoveryMetadata.bind(this),h.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let n=await k(this.updateEndpointMetadata.bind(this),h.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),(i=this.performanceClient)==null||i.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Do(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==ie.CACHE&&(n==null?void 0:n.source)!==ie.CACHE&&(e.expiresAt=Do(),e.canonical_authority=this.canonicalAuthority);let o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}async updateEndpointMetadata(e){var o,i,s;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===ie.HARDCODED_VALUES&&(i=this.authorityOptions.azureRegionConfiguration)!=null&&i.azureRegion&&t.metadata){let a=await k(this.updateMetadataWithRegionalInformation.bind(this),h.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);Sr(e,a,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=await k(this.getEndpointMetadataFromNetwork.bind(this),h.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return(s=this.authorityOptions.azureRegionConfiguration)!=null&&s.azureRegion&&(n=await k(this.updateMetadataWithRegionalInformation.bind(this),h.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),Sr(e,n,!0),ie.NETWORK;throw p(Dt,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Sr(e,t,!1),{source:ie.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let o=this.getEndpointMetadataFromHardcodedValues();if(o)return Sr(e,o,!1),{source:ie.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let n=xo(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:ie.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new O(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw M(Mr)}return null}async getEndpointMetadataFromNetwork(){var n;(n=this.performanceClient)==null||n.addQueueMeasurement(h.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{let o=await this.networkInterface.sendGetRequestAsync(t,e);return cd(o.body)?o.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(o){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${o}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Ss?Ss[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var n,o,i;(n=this.performanceClient)==null||n.addQueueMeasurement(h.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=(o=this.authorityOptions.azureRegionConfiguration)==null?void 0:o.azureRegion;if(t){if(t!==f.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Oo.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,r.replaceWithRegionalInformation(e,t);let s=await k(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),h.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((i=this.authorityOptions.azureRegionConfiguration)==null?void 0:i.environmentRegion,this.regionDiscoveryMetadata);if(s)return this.regionDiscoveryMetadata.region_outcome=Oo.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=s,r.replaceWithRegionalInformation(e,s);this.regionDiscoveryMetadata.region_outcome=Oo.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let n=await k(this.getCloudDiscoveryMetadataFromNetwork.bind(this),h.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return Sn(e,n,!0),ie.NETWORK;throw M(Pr)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||f.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||f.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||f.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Sn(e,t,!1),ie.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let o=id(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Sn(e,o,!1),ie.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=xo(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),ie.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Ie.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Rn(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),M(Qt)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${f.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={},n=null;try{let i=await this.networkInterface.sendGetRequestAsync(e,t),s,a;if(dd(i.body))s=i.body,a=s.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${s.tenant_discovery_endpoint}`);else if(ld(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),s=i.body,s.error===f.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${s.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${s.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=Rn(a,this.hostnameAndPort)}catch(i){if(i instanceof v)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{let s=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${s.name}
Error Description: ${s.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&O.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==Wt.None){let o=t.tenant?t.tenant:f.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${o}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return f.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw p(se)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Rs.has(e)}static isPublicCloudAuthority(e){return f.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){let o=new O(e);o.validateAsUri();let i=o.getUrlComponents(),s=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(s=`${t}.${f.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let a=O.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:s}).urlString;return n?`${a}?${n}`:a}static replaceWithRegionalInformation(e,t){let n={...e};return n.authorization_endpoint=r.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=r.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=r.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e,o=new O(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(f.CIAM_AUTH_URL)){let i=o.HostNameAndPort.split(".")[0];t=`${t}${i}${f.AAD_TENANT_DOMAIN_SUFFIX}`}return t}};ot.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Ee.COMMON,Ee.CONSUMERS,Ee.ORGANIZATIONS]);function hd(r){var o;let n=(o=new O(r).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:o.toLowerCase();switch(n){case Ee.COMMON:case Ee.ORGANIZATIONS:case Ee.CONSUMERS:return;default:return n}}function ei(r){return r.endsWith(f.FORWARD_SLASH)?r:`${r}${f.FORWARD_SLASH}`}function Ca(r){let e=r.cloudDiscoveryMetadata,t;if(e)try{t=JSON.parse(e)}catch(n){throw M(Qt)}return{canonicalAuthority:r.authority?ei(r.authority):void 0,knownAuthorities:r.knownAuthorities,cloudDiscoveryMetadata:t}}async function Ia(r,e,t,n,o,i,s){s==null||s.addQueueMeasurement(h.AuthorityFactoryCreateDiscoveredInstance,i);let a=ot.transformCIAMAuthority(ei(r)),c=new ot(a,e,t,n,o,i,s);try{return await k(c.resolveEndpointsAsync.bind(c),h.AuthorityResolveEndpointsAsync,o,s,i)(),c}catch(d){throw p(se)}}var Ue=class r extends v{constructor(e,t,n,o,i){super(e,t,n),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,r.prototype)}};function Hr(r,e,t){var n;return{clientId:r,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:t,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||((n=e.tokenBodyParameters)==null?void 0:n.clientId)}}var Gn=class r{static generateThrottlingStorageKey(e){return`${Ke.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){var i;let n=r.generateThrottlingStorageKey(t),o=e.getThrottlingCache(n);if(o){if(o.throttleTime<Date.now()){e.removeItem(n);return}throw new Ue(((i=o.errorCodes)==null?void 0:i.join(" "))||f.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,n){if(r.checkResponseStatus(n)||r.checkResponseForRetryAfter(n)){let o={throttleTime:r.calculateThrottleTime(parseInt(n.headers[x.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(x.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(t||Ke.DEFAULT_THROTTLE_TIME_SECONDS),n+Ke.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,n,o){let i=Hr(t,n,o),s=this.generateThrottlingStorageKey(i);e.removeItem(s)}};var ri=class r extends v{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,r.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}};var de=class{constructor(e,t){this.config=sd(e),this.logger=new Xe(this.config.loggerOptions,bo,Cr),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[x.CONTENT_TYPE]=f.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case ce.HOME_ACCOUNT_ID:try{let n=De(e.credential);t[x.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case ce.UPN:t[x.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,n,o,i,s){var c;s&&((c=this.performanceClient)==null||c.addQueueMeasurement(s,i));let a=await this.sendPostRequest(o,e,{body:t,headers:n},i);return this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,n,o){var s,a,c;Gn.preProcess(this.cacheManager,e);let i;try{i=await k(this.networkClient.sendPostRequestAsync.bind(this.networkClient),h.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,o)(t,n);let d=i.headers||{};(a=this.performanceClient)==null||a.addFields({refreshTokenSize:((s=i.body.refresh_token)==null?void 0:s.length)||0,httpVerToken:d[x.X_MS_HTTP_VERSION]||"",requestId:d[x.X_MS_REQUEST_ID]||""},o)}catch(d){if(d instanceof ri){let l=d.responseHeaders;throw l&&((c=this.performanceClient)==null||c.addFields({httpVerToken:l[x.X_MS_HTTP_VERSION]||"",requestId:l[x.X_MS_REQUEST_ID]||"",contentTypeHeader:l[x.CONTENT_TYPE]||void 0,contentLengthHeader:l[x.CONTENT_LENGTH]||void 0,httpStatus:d.httpStatus},o)),d.error}throw d instanceof v?d:p(Pt)}return Gn.postProcess(this.cacheManager,e,i),i}async updateAuthority(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(h.UpdateTokenEndpointAuthority,t);let n=`https://${e}/${this.authority.tenant}/`,o=await Ia(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=o}createTokenQueryParameters(e){let t=new Map;return e.embeddedClientId&&nt(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&rt(t,e.tokenQueryParameters),rr(t,e.correlationId),Xt(t,e.correlationId,this.performanceClient),xe(t)}};var or="no_tokens_found",ni="native_account_unavailable",oi="refresh_token_expired",fd="interaction_required",pd="consent_required",md="login_required",ir="bad_token";var gd=[fd,pd,md,ir],em=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],ii={[or]:"No refresh token found in the cache. Please sign-in.",[ni]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[oi]:"Refresh token has expired.",[ir]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."},pR={noTokensFoundError:{code:or,desc:ii[or]},native_account_unavailable:{code:ni,desc:ii[ni]},bad_token:{code:ir,desc:ii[ir]}},He=class r extends v{constructor(e,t,n,o,i,s,a,c){super(e,t,n),Object.setPrototypeOf(this,r.prototype),this.timestamp=o||f.EMPTY_STRING,this.traceId=i||f.EMPTY_STRING,this.correlationId=s||f.EMPTY_STRING,this.claims=a||f.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}};function si(r,e,t){let n=!!r&&gd.indexOf(r)>-1,o=!!t&&em.indexOf(t)>-1,i=!!e&&gd.some(s=>e.indexOf(s)>-1);return n||i||o}function Sa(r){return new He(r,ii[r])}var ai=class r{static setRequestState(e,t,n){let o=r.generateLibraryState(e,n);return t?`${o}${f.RESOURCE_DELIM}${t}`:o}static generateLibraryState(e,t){if(!e)throw p(ft);let n={id:e.createNewGuid()};t&&(n.meta=t);let o=JSON.stringify(n);return e.base64Encode(o)}static parseRequestState(e,t){if(!e)throw p(ft);if(!t)throw p(Ne);try{let n=t.split(f.RESOURCE_DELIM),o=n[0],i=n.length>1?n.slice(1).join(f.RESOURCE_DELIM):f.EMPTY_STRING,s=e.base64Decode(o),a=JSON.parse(s);return{userRequestState:i||f.EMPTY_STRING,libraryState:a}}catch(n){throw p(Ne)}}};var tm={SW:"sw",UHW:"uhw"},yt=class{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(h.PopTokenGenerateCnf,e.correlationId);let n=await k(this.generateKid.bind(this),h.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:o}}async generateKid(e){var n;return(n=this.performanceClient)==null||n.addQueueMeasurement(h.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:tm.SW}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,o){let{resourceRequestMethod:i,resourceRequestUri:s,shrClaims:a,shrNonce:c,shrOptions:d}=n,l=s?new O(s):void 0,u=l==null?void 0:l.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Te(),m:i==null?void 0:i.toUpperCase(),u:u==null?void 0:u.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:u==null?void 0:u.AbsolutePath,q:u!=null&&u.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0,...o},t,d,n.correlationId)}};var ve=class{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};var Q=class r{constructor(e,t,n,o,i,s,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=o,this.serializableCache=i,this.persistencePlugin=s,this.performanceClient=a}validateTokenResponse(e,t){var n;if(e.error||e.error_description||e.suberror){let o=`Error(s): ${e.error_codes||f.NOT_AVAILABLE} - Timestamp: ${e.timestamp||f.NOT_AVAILABLE} - Description: ${e.error_description||f.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||f.NOT_AVAILABLE} - Trace ID: ${e.trace_id||f.NOT_AVAILABLE}`,i=(n=e.error_codes)!=null&&n.length?e.error_codes[0]:void 0,s=new Ue(e.error,o,e.suberror,i,e.status);if(t&&e.status&&e.status>=P.SERVER_ERROR_RANGE_START&&e.status<=P.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${s}`);return}else if(t&&e.status&&e.status>=P.CLIENT_ERROR_RANGE_START&&e.status<=P.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${s}`);return}throw si(e.error,e.error_description,e.suberror)?new He(e.error,e.error_description,e.suberror,e.timestamp||f.EMPTY_STRING,e.trace_id||f.EMPTY_STRING,e.correlation_id||f.EMPTY_STRING,e.claims||f.EMPTY_STRING,i):s}}async handleServerTokenResponse(e,t,n,o,i,s,a,c,d){var A;(A=this.performanceClient)==null||A.addQueueMeasurement(h.HandleServerTokenResponse,e.correlation_id);let l;if(e.id_token){if(l=Je(e.id_token||f.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&l.nonce!==i.nonce)throw p(Ut);if(o.maxAge||o.maxAge===0){let C=l.auth_time;if(!C)throw p(Ye);An(C,o.maxAge)}}this.homeAccountIdentifier=ae.generateHomeAccountId(e.client_info||f.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,l);let u;i&&i.state&&(u=ai.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;let g=this.generateCacheRecord(e,t,n,o,l,s,i),m;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new ve(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(m)),a&&!c&&g.account){let C=g.account.generateAccountKey();if(!this.cacheStorage.getAccount(C))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await r.generateAuthenticationResult(this.cryptoObj,t,g,!1,o,l,u,void 0,d)}await this.cacheStorage.saveCacheRecord(g,o.correlationId,o.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&m&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(m))}return r.generateAuthenticationResult(this.cryptoObj,t,g,!1,o,l,u,e,d)}generateCacheRecord(e,t,n,o,i,s,a){let c=t.getPreferredCache();if(!c)throw p(We);let d=Vo(i),l,u;e.id_token&&i&&(l=Ts(this.homeAccountIdentifier,c,e.id_token,this.clientId,d||""),u=Ed(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i,e.client_info,c,d,a,void 0,this.logger));let g=null;if(e.access_token){let C=e.scope?V.fromString(e.scope):new V(o.scopes||[]),U=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,j=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,q=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,Z=n+U,fe=Z+j,qe=q&&q>0?n+q:void 0;g=ys(this.homeAccountIdentifier,c,e.access_token,this.clientId,d||t.tenant||"",C.printScopes(),Z,fe,this.cryptoObj.base64Decode,qe,e.token_type,s,e.key_id,o.claims,o.requestedClaimsHash)}let m=null;if(e.refresh_token){let C;if(e.refresh_token_expires_in){let U=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;C=n+U}m=As(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,s,C)}let A=null;return e.foci&&(A={clientId:this.clientId,environment:c,familyId:e.foci}),{account:u,idToken:l,accessToken:g,refreshToken:m,appMetadata:A}}static async generateAuthenticationResult(e,t,n,o,i,s,a,c,d){var Z,fe,qe,mo,go;let l=f.EMPTY_STRING,u=[],g=null,m,A,C=f.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===w.POP&&!i.popKid){let ss=new yt(e),{secret:Eo,keyId:as}=n.accessToken;if(!as)throw p(zt);l=await ss.signPopToken(Eo,as,i)}else l=n.accessToken.secret;u=V.fromString(n.accessToken.target).asArray(),g=Cn(n.accessToken.expiresOn),m=Cn(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(A=Cn(n.accessToken.refreshOn))}n.appMetadata&&(C=n.appMetadata.familyId===ct?ct:"");let U=(s==null?void 0:s.oid)||(s==null?void 0:s.sub)||"",j=(s==null?void 0:s.tid)||"";c!=null&&c.spa_accountid&&n.account&&(n.account.nativeAccountId=c==null?void 0:c.spa_accountid);let q=n.account?qo(n.account.getAccountInfo(),void 0,s,(Z=n.idToken)==null?void 0:Z.secret):null;return{authority:t.canonicalAuthority,uniqueId:U,tenantId:j,scopes:u,account:q,idToken:((fe=n==null?void 0:n.idToken)==null?void 0:fe.secret)||"",idTokenClaims:s||{},accessToken:l,fromCache:o,expiresOn:g,extExpiresOn:m,refreshOn:A,correlationId:i.correlationId,requestId:d||f.EMPTY_STRING,familyId:C,tokenType:((qe=n.accessToken)==null?void 0:qe.tokenType)||f.EMPTY_STRING,state:a?a.userRequestState:f.EMPTY_STRING,cloudGraphHostName:((mo=n.account)==null?void 0:mo.cloudGraphHostName)||f.EMPTY_STRING,msGraphHost:((go=n.account)==null?void 0:go.msGraphHost)||f.EMPTY_STRING,code:c==null?void 0:c.spa_code,fromNativeBroker:!1}}};function Ed(r,e,t,n,o,i,s,a,c,d,l){l==null||l.verbose("setCachedAccount called");let g=r.getAccountKeys().find(j=>j.startsWith(t)),m=null;g&&(m=r.getAccount(g));let A=m||ae.createAccount({homeAccountId:t,idTokenClaims:o,clientInfo:i,environment:s,cloudGraphHostName:c==null?void 0:c.cloud_graph_host_name,msGraphHost:c==null?void 0:c.msgraph_host,nativeAccountId:d},e,n),C=A.tenantProfiles||[],U=a||A.realm;if(U&&!C.find(j=>j.tenantId===U)){let j=_n(t,A.localAccountId,U,o);C.push(j)}return A.tenantProfiles=C,A}var ci=class{static validateRedirectUri(e){if(!e)throw M(_r)}static validatePrompt(e){let t=[];for(let n in at)t.push(at[n]);if(t.indexOf(e)<0)throw M(Or)}static validateClaims(e){try{JSON.parse(e)}catch(t){throw M(et)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw M(pt);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Ro.PLAIN,Ro.S256].indexOf(e)<0)throw M(br)}};async function le(r,e,t){return typeof r=="string"?r:r({clientId:e,tokenEndpoint:t})}var qn=class extends de{constructor(e,t){var n;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=(n=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:n.defaultScopes}async acquireToken(e,t){var a,c;if((a=this.performanceClient)==null||a.addQueueMeasurement(h.AuthClientAcquireToken,e.correlationId),!e.code)throw p($t);let n=Te(),o=await k(this.executeTokenRequest.bind(this),h.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=(c=o.headers)==null?void 0:c[x.X_MS_REQUEST_ID],s=new Q(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(o.body),k(s.handleServerTokenResponse.bind(s),h.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,n,e,t,void 0,void 0,void 0,i)}getLogoutUri(e){if(!e)throw M(vr);let t=this.createLogoutUrlQueryString(e);return O.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var d;(d=this.performanceClient)==null||d.addQueueMeasurement(h.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),o=O.appendQueryString(e.tokenEndpoint,n),i=await k(this.createTokenRequestBody.bind(this),h.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),s;if(t.clientInfo)try{let l=Dr(t.clientInfo,this.cryptoUtils.base64Decode);s={credential:`${l.uid}${$.CLIENT_INFO_SEPARATOR}${l.utid}`,type:ce.HOME_ACCOUNT_ID}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}let a=this.createTokenRequestHeaders(s||t.ccsCredential),c=Hr(this.config.authOptions.clientId,t);return k(this.executePostToTokenEndpoint.bind(this),h.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(o,i,a,c,t.correlationId,h.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var o,i;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(Zt(t,e.embeddedClientId||((i=e.tokenBodyParameters)==null?void 0:i[Le])||this.config.authOptions.clientId),this.includeRedirectUri?er(t,e.redirectUri):ci.validateRedirectUri(e.redirectUri),Jt(t,e.scopes,!0,this.oidcDefaultScopes),Ea(t,e.code),Nn(t,this.config.libraryInfo),vn(t,this.config.telemetry.application),$n(t),this.serverTelemetryManager&&!Ko(this.config)&&Fn(t,this.serverTelemetryManager),e.codeVerifier&&ya(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&Mn(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let s=this.config.clientCredentials.clientAssertion;Pn(t,await le(s.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Dn(t,s.assertionType)}if(xn(t,Oe.AUTHORIZATION_CODE_GRANT),nr(t),e.authenticationScheme===w.POP){let s=new yt(this.cryptoUtils,this.performanceClient),a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(await k(s.generateCnf.bind(s),h.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Un(t,a)}else if(e.authenticationScheme===w.SSH)if(e.sshJwk)Hn(t,e.sshJwk);else throw M(mt);(!B.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&tr(t,e.claims,this.config.authOptions.clientCapabilities);let n;if(e.clientInfo)try{let s=Dr(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${s.uid}${$.CLIENT_INFO_SEPARATOR}${s.utid}`,type:ce.HOME_ACCOUNT_ID}}catch(s){this.logger.verbose("Could not parse client info for CCS Header: "+s)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case ce.HOME_ACCOUNT_ID:try{let s=De(n.credential);tt(t,s)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case ce.UPN:Tt(t,n.credential);break}return e.embeddedClientId&&nt(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&rt(t,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Qo])&&rt(t,{[Qo]:"1"}),Xt(t,e.correlationId,this.performanceClient),xe(t)}createLogoutUrlQueryString(e){let t=new Map;return e.postLogoutRedirectUri&&ha(t,e.postLogoutRedirectUri),e.correlationId&&rr(t,e.correlationId),e.idTokenHint&&fa(t,e.idTokenHint),e.state&&bn(t,e.state),e.logoutHint&&Aa(t,e.logoutHint),e.extraQueryParameters&&rt(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Ln(t),xe(t)}};var rm=300,sr=class extends de{constructor(e,t){super(e,t)}async acquireToken(e){var s,a;(s=this.performanceClient)==null||s.addQueueMeasurement(h.RefreshTokenClientAcquireToken,e.correlationId);let t=Te(),n=await k(this.executeTokenRequest.bind(this),h.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=(a=n.headers)==null?void 0:a[x.X_MS_REQUEST_ID],i=new Q(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),k(i.handleServerTokenResponse.bind(i),h.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){var n;if(!e)throw M(Nr);if((n=this.performanceClient)==null||n.addQueueMeasurement(h.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw p(ze);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await k(this.acquireTokenWithCachedRefreshToken.bind(this),h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(o){let i=o instanceof He&&o.errorCode===or,s=o instanceof Ue&&o.errorCode===ko.INVALID_GRANT_ERROR&&o.subError===ko.CLIENT_MISMATCH_ERROR;if(i||s)return k(this.acquireTokenWithCachedRefreshToken.bind(this),h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw o}return k(this.acquireTokenWithCachedRefreshToken.bind(this),h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var i,s,a;(i=this.performanceClient)==null||i.addQueueMeasurement(h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let n=ud(this.cacheManager.getRefreshToken.bind(this.cacheManager),h.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!n)throw Sa(or);if(n.expiresOn&&Ir(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||rm))throw(s=this.performanceClient)==null||s.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),Sa(oi);let o={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||w.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:ce.HOME_ACCOUNT_ID}};try{return await k(this.acquireToken.bind(this),h.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(c){if(c instanceof He&&((a=this.performanceClient)==null||a.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),c.subError===ir)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let d=In(n);this.cacheManager.removeRefreshToken(d)}throw c}}async executeTokenRequest(e,t){var c;(c=this.performanceClient)==null||c.addQueueMeasurement(h.RefreshTokenClientExecuteTokenRequest,e.correlationId);let n=this.createTokenQueryParameters(e),o=O.appendQueryString(t.tokenEndpoint,n),i=await k(this.createTokenRequestBody.bind(this),h.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),a=Hr(this.config.authOptions.clientId,e);return k(this.executePostToTokenEndpoint.bind(this),h.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,s,a,e.correlationId,h.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var n,o,i;(n=this.performanceClient)==null||n.addQueueMeasurement(h.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(Zt(t,e.embeddedClientId||((o=e.tokenBodyParameters)==null?void 0:o[Le])||this.config.authOptions.clientId),e.redirectUri&&er(t,e.redirectUri),Jt(t,e.scopes,!0,(i=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:i.defaultScopes),xn(t,Oe.REFRESH_TOKEN_GRANT),nr(t),Nn(t,this.config.libraryInfo),vn(t,this.config.telemetry.application),$n(t),this.serverTelemetryManager&&!Ko(this.config)&&Fn(t,this.serverTelemetryManager),Ta(t,e.refreshToken),this.config.clientCredentials.clientSecret&&Mn(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let s=this.config.clientCredentials.clientAssertion;Pn(t,await le(s.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Dn(t,s.assertionType)}if(e.authenticationScheme===w.POP){let s=new yt(this.cryptoUtils,this.performanceClient),a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(await k(s.generateCnf.bind(s),h.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Un(t,a)}else if(e.authenticationScheme===w.SSH)if(e.sshJwk)Hn(t,e.sshJwk);else throw M(mt);if((!B.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&tr(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case ce.HOME_ACCOUNT_ID:try{let s=De(e.ccsCredential.credential);tt(t,s)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case ce.UPN:Tt(t,e.ccsCredential.credential);break}return e.embeddedClientId&&nt(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&rt(t,e.tokenBodyParameters),Xt(t,e.correlationId,this.performanceClient),xe(t)}};var Vn=class extends de{constructor(e,t){super(e,t)}async acquireCachedToken(e){var c;(c=this.performanceClient)==null||c.addQueueMeasurement(h.SilentFlowClientAcquireCachedToken,e.correlationId);let t=H.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!B.isEmptyObj(e.claims))throw this.setCacheOutcome(H.FORCE_REFRESH_OR_CLAIMS,e.correlationId),p(Qe);if(!e.account)throw p(ze);let n=e.account.tenantId||hd(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,n,this.performanceClient,e.correlationId);if(i){if(Es(i.cachedAt)||Ir(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(H.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),p(Qe);i.refreshOn&&Ir(i.refreshOn,0)&&(t=H.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(H.NO_CACHED_ACCESS_TOKEN,e.correlationId),p(Qe);let s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,o,n,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await k(this.generateResultFromCacheRecord.bind(this),h.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){var n,o;(n=this.serverTelemetryManager)==null||n.setCacheOutcome(e),(o=this.performanceClient)==null||o.addFields({cacheOutcome:e},t),e!==H.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(h.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let n;if(e.idToken&&(n=Je(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){let i=n==null?void 0:n.auth_time;if(!i)throw p(Ye);An(i,t.maxAge)}return Q.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}};var jn={};Pe(jn,{getAuthorizationCodePayload:()=>im,getAuthorizeUrl:()=>om,getStandardAuthorizeRequestParameters:()=>nm,validateAuthorizationResponse:()=>Td});function nm(r,e,t,n){var a,c;let o=e.correlationId,i=new Map;Zt(i,e.embeddedClientId||((a=e.extraQueryParameters)==null?void 0:a[Le])||r.clientId);let s=[...e.scopes||[],...e.extraScopesToConsent||[]];if(Jt(i,s,!0,(c=r.authority.options.OIDCOptions)==null?void 0:c.defaultScopes),er(i,e.redirectUri),rr(i,o),ua(i,e.responseMode),nr(i),e.prompt&&(ma(i,e.prompt),n==null||n.addFields({prompt:e.prompt},o)),e.domainHint&&(pa(i,e.domainHint),n==null||n.addFields({domainHintFromRequest:!0},o)),e.prompt!==at.SELECT_ACCOUNT)if(e.sid&&e.prompt===at.NONE)t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Zo(i,e.sid),n==null||n.addFields({sidFromRequest:!0},o);else if(e.account){let d=am(e.account),l=cm(e.account);if(l&&e.domainHint&&(t.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){t.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Ur(i,l),n==null||n.addFields({loginHintFromClaim:!0},o);try{let u=De(e.account.homeAccountId);tt(i,u)}catch(u){t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(d&&e.prompt===at.NONE){t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Zo(i,d),n==null||n.addFields({sidFromClaim:!0},o);try{let u=De(e.account.homeAccountId);tt(i,u)}catch(u){t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)t.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Ur(i,e.loginHint),Tt(i,e.loginHint),n==null||n.addFields({loginHintFromRequest:!0},o);else if(e.account.username){t.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Ur(i,e.account.username),n==null||n.addFields({loginHintFromUpn:!0},o);try{let u=De(e.account.homeAccountId);tt(i,u)}catch(u){t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(t.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Ur(i,e.loginHint),Tt(i,e.loginHint),n==null||n.addFields({loginHintFromRequest:!0},o));else t.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&ga(i,e.nonce),e.state&&bn(i,e.state),(e.claims||r.clientCapabilities&&r.clientCapabilities.length>0)&&tr(i,e.claims,r.clientCapabilities),e.embeddedClientId&&nt(i,r.clientId,r.redirectUri),r.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes(Lr))&&Ln(i),i}function om(r,e){let t=xe(e);return O.appendQueryString(r.authorizationEndpoint,t)}function im(r,e){if(Td(r,e),!r.code)throw p(jt);return r}function Td(r,e){if(!r.state||!e)throw r.state?p(ut,"Cached State"):p(ut,"Server State");let t,n;try{t=decodeURIComponent(r.state)}catch(o){throw p(Ne,r.state)}try{n=decodeURIComponent(e)}catch(o){throw p(Ne,r.state)}if(t!==n)throw p(Lt);if(r.error||r.error_description||r.suberror){let o=sm(r);throw si(r.error,r.error_description,r.suberror)?new He(r.error||"",r.error_description,r.suberror,r.timestamp||"",r.trace_id||"",r.correlation_id||"",r.claims||"",o):new Ue(r.error||"",r.error_description,r.suberror,o)}}function sm(r){var n,o;let e="code=",t=(n=r.error_uri)==null?void 0:n.lastIndexOf(e);return t&&t>=0?(o=r.error_uri)==null?void 0:o.substring(t+e.length):void 0}function am(r){var e;return((e=r.idTokenClaims)==null?void 0:e.sid)||null}function cm(r){var e;return((e=r.idTokenClaims)==null?void 0:e.login_hint)||null}var yd=",",Ad="|";function dm(r){let{skus:e,libraryName:t,libraryVersion:n,extensionName:o,extensionVersion:i}=r,s=new Map([[0,[t,n]],[2,[o,i]]]),a=[];if(e!=null&&e.length){if(a=e.split(yd),a.length<4)return e}else a=Array.from({length:4},()=>Ad);return s.forEach((c,d)=>{var l,u;c.length===2&&((l=c[0])!=null&&l.length)&&((u=c[1])!=null&&u.length)&&lm({skuArr:a,index:d,skuName:c[0],skuVersion:c[1]})}),a.join(yd)}function lm(r){let{skuArr:e,index:t,skuName:n,skuVersion:o}=r;t>=e.length||(e[t]=[n,o].join(Ad))}var Kn=class r{constructor(e,t){this.cacheOutcome=H.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||f.EMPTY_STRING,this.wrapperVer=e.wrapperVer||f.EMPTY_STRING,this.telemetryCacheKey=Y.CACHE_KEY+$.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${Y.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n!=null&&n.length&&t.push(`broker_error=${n}`);let o=t.join(Y.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),s=[e,i].join(Y.VALUE_SEPARATOR);return[Y.SCHEMA_VERSION,s,o].join(Y.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(Y.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(Y.VALUE_SEPARATOR),i=e.errors.length,s=t<i?Y.OVERFLOW_TRUE:Y.OVERFLOW_FALSE,a=[i,s].join(Y.VALUE_SEPARATOR);return[Y.SCHEMA_VERSION,e.cacheHits,n,o,a].join(Y.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=Y.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof v?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Y.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.errors.length;if(t===n)this.cacheManager.removeItem(this.telemetryCacheKey);else{let o={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}}static maxErrorsToSend(e){let t,n=0,o=0,i=e.errors.length;for(t=0;t<i;t++){let s=e.failedRequests[2*t]||f.EMPTY_STRING,a=e.failedRequests[2*t+1]||f.EMPTY_STRING,c=e.errors[t]||f.EMPTY_STRING;if(o+=s.toString().length+a.toString().length+c.length+3,o<Y.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||f.EMPTY_STRING),e.push(this.regionSource||f.EMPTY_STRING),e.push(this.regionOutcome||f.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return dm(e)}};var At=class{static deserializeJSONBlob(e){return e?JSON.parse(e):{}}static deserializeAccounts(e){let t={};return e&&Object.keys(e).map(function(n){var a;let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,realm:o.realm,localAccountId:o.local_account_id,username:o.username,authorityType:o.authority_type,name:o.name,clientInfo:o.client_info,lastModificationTime:o.last_modification_time,lastModificationApp:o.last_modification_app,tenantProfiles:(a=o.tenantProfiles)==null?void 0:a.map(c=>JSON.parse(c))},s=new ae;Et.toObject(s,i),t[n]=s}),t}static deserializeIdTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm};t[n]=i}),t}static deserializeAccessTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm,target:o.target,cachedAt:o.cached_at,expiresOn:o.expires_on,extendedExpiresOn:o.extended_expires_on,refreshOn:o.refresh_on,keyId:o.key_id,tokenType:o.token_type,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash};t[n]=i}),t}static deserializeRefreshTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,familyId:o.family_id,target:o.target,realm:o.realm};t[n]=i}),t}static deserializeAppMetadata(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n];t[n]={clientId:o.client_id,environment:o.environment,familyId:o.family_id}}),t}static deserializeAllCache(e){return{accounts:e.Account?this.deserializeAccounts(e.Account):{},idTokens:e.IdToken?this.deserializeIdTokens(e.IdToken):{},accessTokens:e.AccessToken?this.deserializeAccessTokens(e.AccessToken):{},refreshTokens:e.RefreshToken?this.deserializeRefreshTokens(e.RefreshToken):{},appMetadata:e.AppMetadata?this.deserializeAppMetadata(e.AppMetadata):{}}}};var hm="managed_identity",fm=`https://login.microsoftonline.com/${hm}/`,ne={AZURE_POD_IDENTITY_AUTHORITY_HOST:"AZURE_POD_IDENTITY_AUTHORITY_HOST",IDENTITY_ENDPOINT:"IDENTITY_ENDPOINT",IDENTITY_HEADER:"IDENTITY_HEADER",IDENTITY_SERVER_THUMBPRINT:"IDENTITY_SERVER_THUMBPRINT",IMDS_ENDPOINT:"IMDS_ENDPOINT",MSI_ENDPOINT:"MSI_ENDPOINT",MSI_SECRET:"MSI_SECRET"};var be={SYSTEM_ASSIGNED:"system-assigned",USER_ASSIGNED_CLIENT_ID:"user-assigned-client-id",USER_ASSIGNED_RESOURCE_ID:"user-assigned-resource-id",USER_ASSIGNED_OBJECT_ID:"user-assigned-object-id"},X={GET:"get",POST:"post"},di={SUCCESS:P.SUCCESS,SUCCESS_RANGE_START:P.SUCCESS_RANGE_START,SUCCESS_RANGE_END:P.SUCCESS_RANGE_END,SERVER_ERROR:P.SERVER_ERROR},Cd="REGION_NAME",Id="MSAL_FORCE_REGION",Sd=32,_d={SHA256:"sha256"},li={CV_CHARSET:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~"},_e={MSAL_SKU:"msal.js.node",JWT_BEARER_ASSERTION_TYPE:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",AUTHORIZATION_PENDING:"authorization_pending",HTTP_PROTOCOL:"http://",LOCALHOST:"localhost"},Ct={acquireTokenSilent:62,acquireTokenByUsernamePassword:371,acquireTokenByDeviceCode:671,acquireTokenByClientCredential:771,acquireTokenByCode:871,acquireTokenByRefreshToken:872},Re={ALGORITHM:"alg",RSA_256:"RS256",PSS_256:"PS256",X5T_256:"x5t#S256",X5T:"x5t",X5C:"x5c",AUDIENCE:"aud",EXPIRATION_TIME:"exp",ISSUER:"iss",SUBJECT:"sub",NOT_BEFORE:"nbf",JWT_ID:"jti"};var pm=[P.NOT_FOUND,P.REQUEST_TIMEOUT,P.TOO_MANY_REQUESTS,P.SERVER_ERROR,P.SERVICE_UNAVAILABLE,P.GATEWAY_TIMEOUT];var Fr=class{static getNetworkResponse(e,t,n){return{headers:e,body:t,status:n}}static urlToHttpOptions(e){let t={protocol:e.protocol,hostname:e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return e.port!==""&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${decodeURIComponent(e.username)}:${decodeURIComponent(e.password)}`),t}};var ui=Ce(require("http"),1),_a=Ce(require("https"),1);var Yn=class{constructor(e,t){this.proxyUrl=e||"",this.customAgentOptions=t||{}}async sendGetRequestAsync(e,t,n){return this.proxyUrl?Rd(e,this.proxyUrl,X.GET,t,this.customAgentOptions,n):kd(e,X.GET,t,this.customAgentOptions,n)}async sendPostRequestAsync(e,t){return this.proxyUrl?Rd(e,this.proxyUrl,X.POST,t,this.customAgentOptions):kd(e,X.POST,t,this.customAgentOptions)}},Rd=(r,e,t,n,o,i)=>{let s=new URL(r),a=new URL(e),c=(n==null?void 0:n.headers)||{},d={host:a.hostname,port:a.port,method:"CONNECT",path:s.hostname,headers:c};o&&Object.keys(o).length&&(d.agent=new ui.default.Agent(o));let l="";if(t===X.POST){let g=(n==null?void 0:n.body)||"";l=`Content-Type: application/x-www-form-urlencoded\r
Content-Length: ${g.length}\r
\r
${g}`}else i&&(d.timeout=i);let u=`${t.toUpperCase()} ${s.href} HTTP/1.1\r
Host: ${s.host}\r
Connection: close\r
`+l+`\r
`;return new Promise((g,m)=>{let A=ui.default.request(d);i&&A.on("timeout",()=>{A.destroy(),m(new Error("Request time out"))}),A.end(),A.on("connect",(C,U)=>{let j=(C==null?void 0:C.statusCode)||di.SERVER_ERROR;(j<di.SUCCESS_RANGE_START||j>di.SUCCESS_RANGE_END)&&(A.destroy(),U.destroy(),m(new Error(`Error connecting to proxy. Http status code: ${C.statusCode}. Http status message: ${(C==null?void 0:C.statusMessage)||"Unknown"}`))),U.write(u);let q=[];U.on("data",Z=>{q.push(Z)}),U.on("end",()=>{let fe=Buffer.concat([...q]).toString().split(`\r
`),qe=parseInt(fe[0].split(" ")[1]),mo=fe[0].split(" ").slice(2).join(" "),go=fe[fe.length-1],ss=fe.slice(1,fe.length-2),Eo=new Map;ss.forEach(Hf=>{let $c=Hf.split(new RegExp(/:\s(.*)/s)),Ff=$c[0],cs=$c[1];try{let To=JSON.parse(cs);To&&typeof To=="object"&&(cs=To)}catch(To){}Eo.set(Ff,cs)});let Hc=Object.fromEntries(Eo),Fc=Fr.getNetworkResponse(Hc,wd(qe,mo,Hc,go),qe);(qe<P.SUCCESS_RANGE_START||qe>P.SUCCESS_RANGE_END)&&Fc.body.error!==_e.AUTHORIZATION_PENDING&&A.destroy(),g(Fc)}),U.on("error",Z=>{A.destroy(),U.destroy(),m(new Error(Z.toString()))})}),A.on("error",C=>{A.destroy(),m(new Error(C.toString()))})})},kd=(r,e,t,n,o)=>{let i=e===X.POST,s=(t==null?void 0:t.body)||"",a=new URL(r),c=(t==null?void 0:t.headers)||{},d={method:e,headers:c,...Fr.urlToHttpOptions(a)};return n&&Object.keys(n).length&&(d.agent=new _a.default.Agent(n)),i?d.headers={...d.headers,"Content-Length":s.length}:o&&(d.timeout=o),new Promise((l,u)=>{let g;d.protocol==="http:"?g=ui.default.request(d):g=_a.default.request(d),i&&g.write(s),o&&g.on("timeout",()=>{g.destroy(),u(new Error("Request time out"))}),g.end(),g.on("response",m=>{let A=m.headers,C=m.statusCode,U=m.statusMessage,j=[];m.on("data",q=>{j.push(q)}),m.on("end",()=>{let q=Buffer.concat([...j]).toString(),Z=A,fe=Fr.getNetworkResponse(Z,wd(C,U,Z,q),C);(C<P.SUCCESS_RANGE_START||C>P.SUCCESS_RANGE_END)&&fe.body.error!==_e.AUTHORIZATION_PENDING&&g.destroy(),l(fe)})}),g.on("error",m=>{g.destroy(),u(new Error(m.toString()))})})},wd=(r,e,t,n)=>{let o;try{o=JSON.parse(n)}catch(i){let s,a;r>=P.CLIENT_ERROR_RANGE_START&&r<=P.CLIENT_ERROR_RANGE_END?(s="client_error",a="A client"):r>=P.SERVER_ERROR_RANGE_START&&r<=P.SERVER_ERROR_RANGE_END?(s="server_error",a="A server"):(s="unknown_error",a="An unknown"),o={error:s,error_description:`${a} error occured.
Http status code: ${r}
Http status message: ${e||"Unknown"}
Headers: ${JSON.stringify(t)}`}}return o};var Ra="invalid_file_extension",ka="invalid_file_path",zn="invalid_managed_identity_id_type",wa="invalid_secret",Od="missing_client_id",Nd="network_unavailable",Oa="platform_not_supported",Na="unable_to_create_azure_arc",va="unable_to_create_cloud_shell",ba="unable_to_create_source",Ma="unable_to_read_secret_file",vd="user_assigned_not_available_at_runtime",Pa="www_authenticate_header_missing",Da="www_authenticate_header_unsupported_format",ar={[ne.AZURE_POD_IDENTITY_AUTHORITY_HOST]:"azure_pod_identity_authority_host_url_malformed",[ne.IDENTITY_ENDPOINT]:"identity_endpoint_url_malformed",[ne.IMDS_ENDPOINT]:"imds_endpoint_url_malformed",[ne.MSI_ENDPOINT]:"msi_endpoint_url_malformed"};var mm={[Ra]:"The file path in the WWW-Authenticate header does not contain a .key file.",[ka]:"The file path in the WWW-Authenticate header is not in a valid Windows or Linux Format.",[zn]:"More than one ManagedIdentityIdType was provided.",[wa]:"The secret in the file on the file path in the WWW-Authenticate header is greater than 4096 bytes.",[Oa]:"The platform is not supported by Azure Arc. Azure Arc only supports Windows and Linux.",[Od]:"A ManagedIdentityId id was not provided.",[ar.AZURE_POD_IDENTITY_AUTHORITY_HOST]:`The Managed Identity's '${ne.AZURE_POD_IDENTITY_AUTHORITY_HOST}' environment variable is malformed.`,[ar.IDENTITY_ENDPOINT]:`The Managed Identity's '${ne.IDENTITY_ENDPOINT}' environment variable is malformed.`,[ar.IMDS_ENDPOINT]:`The Managed Identity's '${ne.IMDS_ENDPOINT}' environment variable is malformed.`,[ar.MSI_ENDPOINT]:`The Managed Identity's '${ne.MSI_ENDPOINT}' environment variable is malformed.`,[Nd]:"Authentication unavailable. The request to the managed identity endpoint timed out.",[Na]:"Azure Arc Managed Identities can only be system assigned.",[va]:"Cloud Shell Managed Identities can only be system assigned.",[ba]:"Unable to create a Managed Identity source based on environment variables.",[Ma]:"Unable to read the secret file.",[vd]:"Service Fabric user assigned managed identity ClientId or ResourceId is not configurable at runtime.",[Pa]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is missing.",[Da]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is in an unsupported format."},xa=class r extends v{constructor(e){super(e,mm[e]),this.name="ManagedIdentityError",Object.setPrototypeOf(this,r.prototype)}};function cr(r){return new xa(r)}var ee={invalidLoopbackAddressType:{code:"invalid_loopback_server_address_type",desc:"Loopback server address is not type string. This is unexpected."},unableToLoadRedirectUri:{code:"unable_to_load_redirectUrl",desc:"Loopback server callback was invoked without a url. This is unexpected."},noAuthCodeInResponse:{code:"no_auth_code_in_response",desc:"No auth code found in the server response. Please check your network trace to determine what happened."},noLoopbackServerExists:{code:"no_loopback_server_exists",desc:"No loopback server exists yet."},loopbackServerAlreadyExists:{code:"loopback_server_already_exists",desc:"Loopback server already exists. Cannot create another."},loopbackServerTimeout:{code:"loopback_server_timeout",desc:"Timed out waiting for auth code listener to be registered."},stateNotFoundError:{code:"state_not_found",desc:"State not found. Please verify that the request originated from msal."},thumbprintMissing:{code:"thumbprint_missing_from_client_certificate",desc:"Client certificate does not contain a SHA-1 or SHA-256 thumbprint."}},It=class r extends v{constructor(e,t){super(e,t),this.name="NodeAuthError"}static createInvalidLoopbackAddressTypeError(){return new r(ee.invalidLoopbackAddressType.code,`${ee.invalidLoopbackAddressType.desc}`)}static createUnableToLoadRedirectUrlError(){return new r(ee.unableToLoadRedirectUri.code,`${ee.unableToLoadRedirectUri.desc}`)}static createNoAuthCodeInResponseError(){return new r(ee.noAuthCodeInResponse.code,`${ee.noAuthCodeInResponse.desc}`)}static createNoLoopbackServerExistsError(){return new r(ee.noLoopbackServerExists.code,`${ee.noLoopbackServerExists.desc}`)}static createLoopbackServerAlreadyExistsError(){return new r(ee.loopbackServerAlreadyExists.code,`${ee.loopbackServerAlreadyExists.desc}`)}static createLoopbackServerTimeoutError(){return new r(ee.loopbackServerTimeout.code,`${ee.loopbackServerTimeout.desc}`)}static createStateNotFoundError(){return new r(ee.stateNotFoundError.code,ee.stateNotFoundError.desc)}static createThumbprintMissingError(){return new r(ee.thumbprintMissing.code,ee.thumbprintMissing.desc)}};var gm={clientId:f.EMPTY_STRING,authority:f.DEFAULT_AUTHORITY,clientSecret:f.EMPTY_STRING,clientAssertion:f.EMPTY_STRING,clientCertificate:{thumbprint:f.EMPTY_STRING,thumbprintSha256:f.EMPTY_STRING,privateKey:f.EMPTY_STRING,x5c:f.EMPTY_STRING},knownAuthorities:[],cloudDiscoveryMetadata:f.EMPTY_STRING,authorityMetadata:f.EMPTY_STRING,clientCapabilities:[],protocolMode:Se.AAD,azureCloudOptions:{azureCloudInstance:Wt.None,tenant:f.EMPTY_STRING},skipAuthorityMetadataCache:!1},Em={claimsBasedCachingEnabled:!1},bd={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:G.Info},Tm={loggerOptions:bd,networkClient:new Yn,proxyUrl:f.EMPTY_STRING,customAgentOptions:{},disableInternalRetries:!1},ym={application:{appName:f.EMPTY_STRING,appVersion:f.EMPTY_STRING}};function Md({auth:r,broker:e,cache:t,system:n,telemetry:o}){let i={...Tm,networkClient:new Yn(n==null?void 0:n.proxyUrl,n==null?void 0:n.customAgentOptions),loggerOptions:(n==null?void 0:n.loggerOptions)||bd,disableInternalRetries:(n==null?void 0:n.disableInternalRetries)||!1};if(r.clientCertificate&&!r.clientCertificate.thumbprint&&!r.clientCertificate.thumbprintSha256)throw It.createStateNotFoundError();return{auth:{...gm,...r},broker:{...e},cache:{...Em,...t},system:{...i,...n},telemetry:{...ym,...o}}}var hi,Am=new Uint8Array(16);function La(){if(!hi&&(hi=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!hi))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return hi(Am)}var Pd=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Cm(r){return typeof r=="string"&&Pd.test(r)}var Dd=Cm;var te=[];for(fi=0;fi<256;++fi)te.push((fi+256).toString(16).substr(1));var fi;function Im(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(te[r[e+0]]+te[r[e+1]]+te[r[e+2]]+te[r[e+3]]+"-"+te[r[e+4]]+te[r[e+5]]+"-"+te[r[e+6]]+te[r[e+7]]+"-"+te[r[e+8]]+te[r[e+9]]+"-"+te[r[e+10]]+te[r[e+11]]+te[r[e+12]]+te[r[e+13]]+te[r[e+14]]+te[r[e+15]]).toLowerCase();if(!Dd(t))throw TypeError("Stringified UUID is invalid");return t}var xd=Im;function Sm(r,e,t){r=r||{};var n=r.random||(r.rng||La)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var o=0;o<16;++o)e[t+o]=n[o];return e}return xd(n)}var Ua=Sm;var pi=class{generateGuid(){return Ua()}isGuid(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}};var ye=class r{static base64Encode(e,t){return Buffer.from(e,t).toString("base64")}static base64EncodeUrl(e,t){return r.base64Encode(e,t).replace(/=/g,f.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")}static base64Decode(e){return Buffer.from(e,"base64").toString("utf8")}static base64DecodeUrl(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4;)t+="=";return r.base64Decode(t)}};var Ld=Ce(require("crypto"),1);var $r=class{sha256(e){return Ld.default.createHash(_d.SHA256).update(e).digest()}};var Ud=Ce(require("crypto"),1);var mi=class{constructor(){this.hashUtils=new $r}async generatePkceCodes(){let e=this.generateCodeVerifier(),t=this.generateCodeChallengeFromVerifier(e);return{verifier:e,challenge:t}}generateCodeVerifier(){let e=[],t=256-256%li.CV_CHARSET.length;for(;e.length<=Sd;){let o=Ud.default.randomBytes(1)[0];if(o>=t)continue;let i=o%li.CV_CHARSET.length;e.push(li.CV_CHARSET[i])}let n=e.join(f.EMPTY_STRING);return ye.base64EncodeUrl(n)}generateCodeChallengeFromVerifier(e){return ye.base64EncodeUrl(this.hashUtils.sha256(e).toString("base64"),"base64")}};var Br=class{constructor(){this.pkceGenerator=new mi,this.guidGenerator=new pi,this.hashUtils=new $r}base64UrlEncode(){throw new Error("Method not implemented.")}encodeKid(){throw new Error("Method not implemented.")}createNewGuid(){return this.guidGenerator.generateGuid()}base64Encode(e){return ye.base64Encode(e)}base64Decode(e){return ye.base64Decode(e)}generatePkceCodes(){return this.pkceGenerator.generatePkceCodes()}getPublicKeyThumbprint(){throw new Error("Method not implemented.")}removeTokenBindingKey(){throw new Error("Method not implemented.")}clearKeystore(){throw new Error("Method not implemented.")}signJwt(){throw new Error("Method not implemented.")}async hashString(e){return ye.base64EncodeUrl(this.hashUtils.sha256(e).toString("base64"),"base64")}};var dr=class extends Et{constructor(e,t,n,o){super(t,n,e,o),this.cache={},this.changeEmitters=[],this.logger=e}registerChangeEmitter(e){this.changeEmitters.push(e)}emitChange(){this.changeEmitters.forEach(e=>e.call(null))}cacheToInMemoryCache(e){let t={accounts:{},idTokens:{},accessTokens:{},refreshTokens:{},appMetadata:{}};for(let n in e){let o=e[n];if(typeof o=="object")if(o instanceof ae)t.accounts[n]=o;else if(W.isIdTokenEntity(o))t.idTokens[n]=o;else if(W.isAccessTokenEntity(o))t.accessTokens[n]=o;else if(W.isRefreshTokenEntity(o))t.refreshTokens[n]=o;else if(W.isAppMetadataEntity(n,o))t.appMetadata[n]=o;else continue}return t}inMemoryCacheToCache(e){let t=this.getCache();return t={...t,...e.accounts,...e.idTokens,...e.accessTokens,...e.refreshTokens,...e.appMetadata},t}getInMemoryCache(){return this.logger.trace("Getting in-memory cache"),this.cacheToInMemoryCache(this.getCache())}setInMemoryCache(e){this.logger.trace("Setting in-memory cache");let t=this.inMemoryCacheToCache(e);this.setCache(t),this.emitChange()}getCache(){return this.logger.trace("Getting cache key-value store"),this.cache}setCache(e){this.logger.trace("Setting cache key value store"),this.cache=e,this.emitChange()}getItem(e){return this.logger.tracePii(`Item key: ${e}`),this.getCache()[e]}setItem(e,t){this.logger.tracePii(`Item key: ${e}`);let n=this.getCache();n[e]=t,this.setCache(n)}getAccountKeys(){let e=this.getInMemoryCache();return Object.keys(e.accounts)}getTokenKeys(){let e=this.getInMemoryCache();return{idToken:Object.keys(e.idTokens),accessToken:Object.keys(e.accessTokens),refreshToken:Object.keys(e.refreshTokens)}}getAccount(e){return this.getItem(e)?Object.assign(new ae,this.getItem(e)):null}async setAccount(e){let t=e.generateAccountKey();this.setItem(t,e)}getIdTokenCredential(e){let t=this.getItem(e);return W.isIdTokenEntity(t)?t:null}async setIdTokenCredential(e){let t=W.generateCredentialKey(e);this.setItem(t,e)}getAccessTokenCredential(e){let t=this.getItem(e);return W.isAccessTokenEntity(t)?t:null}async setAccessTokenCredential(e){let t=W.generateCredentialKey(e);this.setItem(t,e)}getRefreshTokenCredential(e){let t=this.getItem(e);return W.isRefreshTokenEntity(t)?t:null}async setRefreshTokenCredential(e){let t=W.generateCredentialKey(e);this.setItem(t,e)}getAppMetadata(e){let t=this.getItem(e);return W.isAppMetadataEntity(e,t)?t:null}setAppMetadata(e){let t=W.generateAppMetadataKey(e);this.setItem(t,e)}getServerTelemetry(e){let t=this.getItem(e);return t&&W.isServerTelemetryEntity(e,t)?t:null}setServerTelemetry(e,t){this.setItem(e,t)}getAuthorityMetadata(e){let t=this.getItem(e);return t&&W.isAuthorityMetadataEntity(e,t)?t:null}getAuthorityMetadataKeys(){return this.getKeys().filter(e=>this.isAuthorityMetadata(e))}setAuthorityMetadata(e,t){this.setItem(e,t)}getThrottlingCache(e){let t=this.getItem(e);return t&&W.isThrottlingEntity(e,t)?t:null}setThrottlingCache(e,t){this.setItem(e,t)}removeItem(e){this.logger.tracePii(`Item key: ${e}`);let t=!1,n=this.getCache();return n[e]&&(delete n[e],t=!0),t&&(this.setCache(n),this.emitChange()),t}removeOutdatedAccount(e){this.removeItem(e)}containsKey(e){return this.getKeys().includes(e)}getKeys(){this.logger.trace("Retrieving all cache keys");let e=this.getCache();return[...Object.keys(e)]}clear(){this.logger.trace("Clearing cache entries created by MSAL"),this.getKeys().forEach(t=>{this.removeItem(t)}),this.emitChange()}static generateInMemoryCache(e){return At.deserializeAllCache(At.deserializeJSONBlob(e))}static generateJsonCache(e){return Nt.serializeAllCache(e)}updateCredentialCacheKey(e,t){let n=W.generateCredentialKey(t);if(e!==n){let o=this.getItem(e);if(o)return this.removeItem(e),this.setItem(n,o),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}};var Wn={Account:{},IdToken:{},AccessToken:{},RefreshToken:{},AppMetadata:{}},Qn=class{constructor(e,t,n){this.cacheHasChanged=!1,this.storage=e,this.storage.registerChangeEmitter(this.handleChangeEvent.bind(this)),n&&(this.persistence=n),this.logger=t}hasChanged(){return this.cacheHasChanged}serialize(){this.logger.trace("Serializing in-memory cache");let e=Nt.serializeAllCache(this.storage.getInMemoryCache());return this.cacheSnapshot?(this.logger.trace("Reading cache snapshot from disk"),e=this.mergeState(JSON.parse(this.cacheSnapshot),e)):this.logger.trace("No cache snapshot to merge"),this.cacheHasChanged=!1,JSON.stringify(e)}deserialize(e){if(this.logger.trace("Deserializing JSON to in-memory cache"),this.cacheSnapshot=e,this.cacheSnapshot){this.logger.trace("Reading cache snapshot from disk");let t=At.deserializeAllCache(this.overlayDefaults(JSON.parse(this.cacheSnapshot)));this.storage.setInMemoryCache(t)}else this.logger.trace("No cache snapshot to deserialize")}getKVStore(){return this.storage.getCache()}getCacheSnapshot(){let e=dr.generateInMemoryCache(this.cacheSnapshot);return this.storage.inMemoryCacheToCache(e)}async getAllAccounts(){this.logger.trace("getAllAccounts called");let e;try{return this.persistence&&(e=new ve(this,!1),await this.persistence.beforeCacheAccess(e)),this.storage.getAllAccounts()}finally{this.persistence&&e&&await this.persistence.afterCacheAccess(e)}}async getAccountByHomeId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.homeAccountId===e)[0]||null}async getAccountByLocalId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.localAccountId===e)[0]||null}async removeAccount(e){this.logger.trace("removeAccount called");let t;try{this.persistence&&(t=new ve(this,!0),await this.persistence.beforeCacheAccess(t)),await this.storage.removeAccount(ae.generateAccountCacheKey(e))}finally{this.persistence&&t&&await this.persistence.afterCacheAccess(t)}}async overwriteCache(){if(!this.persistence){this.logger.info("No persistence layer specified, cache cannot be overwritten");return}this.logger.info("Overwriting in-memory cache with persistent cache"),this.storage.clear();let e=new ve(this,!1);await this.persistence.beforeCacheAccess(e);let t=this.getCacheSnapshot();this.storage.setCache(t),await this.persistence.afterCacheAccess(e)}handleChangeEvent(){this.cacheHasChanged=!0}mergeState(e,t){this.logger.trace("Merging in-memory cache with cache snapshot");let n=this.mergeRemovals(e,t);return this.mergeUpdates(n,t)}mergeUpdates(e,t){return Object.keys(t).forEach(n=>{let o=t[n];if(!e.hasOwnProperty(n))o!==null&&(e[n]=o);else{let i=o!==null,s=typeof o=="object",a=!Array.isArray(o),c=typeof e[n]!="undefined"&&e[n]!==null;i&&s&&a&&c?this.mergeUpdates(e[n],o):e[n]=o}}),e}mergeRemovals(e,t){this.logger.trace("Remove updated entries in cache");let n=e.Account?this.mergeRemovalsDict(e.Account,t.Account):e.Account,o=e.AccessToken?this.mergeRemovalsDict(e.AccessToken,t.AccessToken):e.AccessToken,i=e.RefreshToken?this.mergeRemovalsDict(e.RefreshToken,t.RefreshToken):e.RefreshToken,s=e.IdToken?this.mergeRemovalsDict(e.IdToken,t.IdToken):e.IdToken,a=e.AppMetadata?this.mergeRemovalsDict(e.AppMetadata,t.AppMetadata):e.AppMetadata;return{...e,Account:n,AccessToken:o,RefreshToken:i,IdToken:s,AppMetadata:a}}mergeRemovalsDict(e,t){let n={...e};return Object.keys(e).forEach(o=>{(!t||!t.hasOwnProperty(o))&&delete n[o]}),n}overlayDefaults(e){return this.logger.trace("Overlaying input cache with the default cache"),{Account:{...Wn.Account,...e.Account},IdToken:{...Wn.IdToken,...e.IdToken},AccessToken:{...Wn.AccessToken,...e.AccessToken},RefreshToken:{...Wn.RefreshToken,...e.RefreshToken},AppMetadata:{...Wn.AppMetadata,...e.AppMetadata}}}};var Ef=Ce(gf(),1);var Rt=class r{static fromAssertion(e){let t=new r;return t.jwt=e,t}static fromCertificate(e,t,n){let o=new r;return o.privateKey=t,o.thumbprint=e,o.useSha256=!1,n&&(o.publicCertificate=this.parseCertificate(n)),o}static fromCertificateWithSha256Thumbprint(e,t,n){let o=new r;return o.privateKey=t,o.thumbprint=e,o.useSha256=!0,n&&(o.publicCertificate=this.parseCertificate(n)),o}getJwt(e,t,n){if(this.privateKey&&this.thumbprint)return this.jwt&&!this.isExpired()&&t===this.issuer&&n===this.jwtAudience?this.jwt:this.createJwt(e,t,n);if(this.jwt)return this.jwt;throw p(z.invalidAssertion)}createJwt(e,t,n){this.issuer=t,this.jwtAudience=n;let o=J.nowSeconds();this.expirationTime=o+600;let s={alg:this.useSha256?Re.PSS_256:Re.RSA_256},a=this.useSha256?Re.X5T_256:Re.X5T;Object.assign(s,{[a]:ye.base64EncodeUrl(this.thumbprint,"hex")}),this.publicCertificate&&Object.assign(s,{[Re.X5C]:this.publicCertificate});let c={[Re.AUDIENCE]:this.jwtAudience,[Re.EXPIRATION_TIME]:this.expirationTime,[Re.ISSUER]:this.issuer,[Re.SUBJECT]:this.issuer,[Re.NOT_BEFORE]:o,[Re.JWT_ID]:e.createNewGuid()};return this.jwt=Ef.default.sign(c,this.privateKey,{header:s}),this.jwt}isExpired(){return this.expirationTime<J.nowSeconds()}static parseCertificate(e){let t=/-----BEGIN CERTIFICATE-----\r*\n(.+?)\r*\n-----END CERTIFICATE-----/gs,n=[],o;for(;(o=t.exec(e))!==null;)n.push(o[1].replace(/\r*\n/g,f.EMPTY_STRING));return n}};var _c="@azure/msal-node",kt="3.4.1";var co=class extends de{constructor(e){super(e)}async acquireToken(e){this.logger.info("in acquireToken call in username-password client");let t=J.nowSeconds(),n=await this.executeTokenRequest(this.authority,e),o=new Q(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n.body),o.handleServerTokenResponse(n.body,this.authority,t,e)}async executeTokenRequest(e,t){let n=this.createTokenQueryParameters(t),o=O.appendQueryString(e.tokenEndpoint,n),i=await this.createTokenRequestBody(t),s=this.createTokenRequestHeaders({credential:t.username,type:ce.UPN}),a={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return this.executePostToTokenEndpoint(o,i,s,a,t.correlationId)}async createTokenRequestBody(e){let t=new Map;I.addClientId(t,this.config.authOptions.clientId),I.addUsername(t,e.username),I.addPassword(t,e.password),I.addScopes(t,e.scopes),I.addResponseType(t,en.IDTOKEN_TOKEN),I.addGrantType(t,Oe.RESOURCE_OWNER_PASSWORD_GRANT),I.addClientInfo(t),I.addLibraryInfo(t,this.config.libraryInfo),I.addApplicationTelemetry(t,this.config.telemetry.application),I.addThrottling(t),this.serverTelemetryManager&&I.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();I.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&I.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(I.addClientAssertion(t,await le(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),I.addClientAssertionType(t,o.assertionType)),(!B.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.username&&I.addCcsUpn(t,e.username),gt.mapToQueryString(t)}};function Tf(r,e,t,n){let o=jn.getStandardAuthorizeRequestParameters({...r.auth,authority:e,redirectUri:t.redirectUri||""},t,n);return I.addLibraryInfo(o,{sku:_e.MSAL_SKU,version:kt,cpu:process.arch||"",os:process.platform||""}),r.auth.protocolMode!==Se.OIDC&&I.addApplicationTelemetry(o,r.telemetry.application),I.addResponseType(o,en.CODE),t.codeChallenge&&t.codeChallengeMethod&&I.addCodeChallengeParams(o,t.codeChallenge,t.codeChallengeMethod),I.addExtraQueryParameters(o,t.extraQueryParameters||{}),jn.getAuthorizeUrl(e,o)}var Xr=class{constructor(e){this.config=Md(e),this.cryptoProvider=new Br,this.logger=new Xe(this.config.system.loggerOptions,_c,kt),this.storage=new dr(this.logger,this.config.auth.clientId,this.cryptoProvider,Ca(this.config.auth)),this.tokenCache=new Qn(this.storage,this.logger,this.config.cache.cachePlugin)}async getAuthCodeUrl(e){this.logger.info("getAuthCodeUrl called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),responseMode:e.responseMode||tn.QUERY,authenticationScheme:w.BEARER,state:e.state||"",nonce:e.nonce||""},n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions);return Tf(this.config,n,t,this.logger)}async acquireTokenByCode(e,t){this.logger.info("acquireTokenByCode called"),e.state&&t&&(this.logger.info("acquireTokenByCode - validating state"),this.validateState(e.state,t.state||""),t={...t,state:""});let n={...e,...await this.initializeBaseRequest(e),authenticationScheme:w.BEARER},o=this.initializeServerTelemetryManager(Ct.acquireTokenByCode,n.correlationId);try{let i=await this.createAuthority(n.authority,n.correlationId,void 0,e.azureCloudOptions),s=await this.buildOauthClientConfiguration(i,n.correlationId,n.redirectUri,o),a=new qn(s);return this.logger.verbose("Auth code client created",n.correlationId),await a.acquireToken(n,t)}catch(i){throw i instanceof v&&i.setCorrelationId(n.correlationId),o.cacheFailedRequest(i),i}}async acquireTokenByRefreshToken(e){this.logger.info("acquireTokenByRefreshToken called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),authenticationScheme:w.BEARER},n=this.initializeServerTelemetryManager(Ct.acquireTokenByRefreshToken,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),s=new sr(i);return this.logger.verbose("Refresh token client created",t.correlationId),await s.acquireToken(t)}catch(o){throw o instanceof v&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireTokenSilent(e){let t={...e,...await this.initializeBaseRequest(e),forceRefresh:e.forceRefresh||!1},n=this.initializeServerTelemetryManager(Ct.acquireTokenSilent,t.correlationId,t.forceRefresh);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),s=new Vn(i);this.logger.verbose("Silent flow client created",t.correlationId);try{return await this.tokenCache.overwriteCache(),await this.acquireCachedTokenSilent(t,s,i)}catch(a){if(a instanceof Ar&&a.errorCode===z.tokenRefreshRequired)return new sr(i).acquireTokenByRefreshToken(t);throw a}}catch(o){throw o instanceof v&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireCachedTokenSilent(e,t,n){var s;let[o,i]=await t.acquireCachedToken({...e,scopes:(s=e.scopes)!=null&&s.length?e.scopes:[...je]});if(i===H.PROACTIVELY_REFRESHED){this.logger.info("ClientApplication:acquireCachedTokenSilent - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");let a=new sr(n);try{await a.acquireTokenByRefreshToken(e)}catch(c){}}return o}async acquireTokenByUsernamePassword(e){this.logger.info("acquireTokenByUsernamePassword called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)},n=this.initializeServerTelemetryManager(Ct.acquireTokenByUsernamePassword,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,"",n),s=new co(i);return this.logger.verbose("Username password client created",t.correlationId),await s.acquireToken(t)}catch(o){throw o instanceof v&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}getTokenCache(){return this.logger.info("getTokenCache called"),this.tokenCache}validateState(e,t){if(!e)throw It.createStateNotFoundError();if(e!==t)throw p(z.stateMismatch)}getLogger(){return this.logger}setLogger(e){this.logger=e}async buildOauthClientConfiguration(e,t,n,o){return this.logger.verbose("buildOauthClientConfiguration called",t),this.logger.info(`Building oauth client configuration with the following authority: ${e.tokenEndpoint}.`,t),o==null||o.updateRegionDiscoveryMetadata(e.regionDiscoveryMetadata),{authOptions:{clientId:this.config.auth.clientId,authority:e,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:n},loggerOptions:{logLevel:this.config.system.loggerOptions.logLevel,loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,correlationId:t},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.cryptoProvider,networkInterface:this.config.system.networkClient,storageInterface:this.storage,serverTelemetryManager:o,clientCredentials:{clientSecret:this.clientSecret,clientAssertion:await this.getClientAssertion(e)},libraryInfo:{sku:_e.MSAL_SKU,version:kt,cpu:process.arch||f.EMPTY_STRING,os:process.platform||f.EMPTY_STRING},telemetry:this.config.telemetry,persistencePlugin:this.config.cache.cachePlugin,serializableCache:this.tokenCache}}async getClientAssertion(e){return this.developerProvidedClientAssertion&&(this.clientAssertion=Rt.fromAssertion(await le(this.developerProvidedClientAssertion,this.config.auth.clientId,e.tokenEndpoint))),this.clientAssertion&&{assertion:this.clientAssertion.getJwt(this.cryptoProvider,this.config.auth.clientId,e.tokenEndpoint),assertionType:_e.JWT_BEARER_ASSERTION_TYPE}}async initializeBaseRequest(e){return this.logger.verbose("initializeRequestScopes called",e.correlationId),e.authenticationScheme&&e.authenticationScheme===w.POP&&this.logger.verbose("Authentication Scheme 'pop' is not supported yet, setting Authentication Scheme to 'Bearer' for request",e.correlationId),e.authenticationScheme=w.BEARER,this.config.cache.claimsBasedCachingEnabled&&e.claims&&!B.isEmptyObj(e.claims)&&(e.requestedClaimsHash=await this.cryptoProvider.hashString(e.claims)),{...e,scopes:[...e&&e.scopes||[],...je],correlationId:e&&e.correlationId||this.cryptoProvider.createNewGuid(),authority:e.authority||this.config.auth.authority}}initializeServerTelemetryManager(e,t,n){let o={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:n||!1};return new Kn(o,this.storage)}async createAuthority(e,t,n,o){this.logger.verbose("createAuthority called",t);let i=ot.generateAuthority(e,o||this.config.auth.azureCloudOptions),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,azureRegionConfiguration:n,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};return ti.createDiscoveredInstance(i,this.config.system.networkClient,this.storage,s,this.logger,t)}clearCache(){this.storage.clear()}};var OC=Ce(require("http"),1);var Jr=class extends de{constructor(e,t){super(e),this.appTokenProvider=t}async acquireToken(e){if(e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority);let[t,n]=await this.getCachedAuthenticationResult(e,this.config,this.cryptoUtils,this.authority,this.cacheManager,this.serverTelemetryManager);return t?(n===H.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.executeTokenRequest(e,this.authority,!0)),t):this.executeTokenRequest(e,this.authority)}async getCachedAuthenticationResult(e,t,n,o,i,s){var g,m;let a=t,c=t,d=H.NOT_APPLICABLE,l;a.serializableCache&&a.persistencePlugin&&(l=new ve(a.serializableCache,!1),await a.persistencePlugin.beforeCacheAccess(l));let u=this.readAccessTokenFromCache(o,((g=c.managedIdentityId)==null?void 0:g.id)||a.authOptions.clientId,new V(e.scopes||[]),i);return a.serializableCache&&a.persistencePlugin&&l&&await a.persistencePlugin.afterCacheAccess(l),u?J.isTokenExpired(u.expiresOn,((m=a.systemOptions)==null?void 0:m.tokenRenewalOffsetSeconds)||on)?(s==null||s.setCacheOutcome(H.CACHED_ACCESS_TOKEN_EXPIRED),[null,H.CACHED_ACCESS_TOKEN_EXPIRED]):(u.refreshOn&&J.isTokenExpired(u.refreshOn.toString(),0)&&(d=H.PROACTIVELY_REFRESHED,s==null||s.setCacheOutcome(H.PROACTIVELY_REFRESHED)),[await Q.generateAuthenticationResult(n,o,{account:null,idToken:null,accessToken:u,refreshToken:null,appMetadata:null},!0,e),d]):(s==null||s.setCacheOutcome(H.NO_CACHED_ACCESS_TOKEN),[null,H.NO_CACHED_ACCESS_TOKEN])}readAccessTokenFromCache(e,t,n,o){let i={homeAccountId:f.EMPTY_STRING,environment:e.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:N.ACCESS_TOKEN,clientId:t,realm:e.tenant,target:V.createSearchScopes(n.asArray())},s=o.getAccessTokensByFilter(i);if(s.length<1)return null;if(s.length>1)throw p(z.multipleMatchingTokens);return s[0]}async executeTokenRequest(e,t,n){let o,i;if(this.appTokenProvider){this.logger.info("Using appTokenProvider extensibility.");let c={correlationId:e.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:e.scopes,claims:e.claims};i=J.nowSeconds();let d=await this.appTokenProvider(c);o={access_token:d.accessToken,expires_in:d.expiresInSeconds,refresh_in:d.refreshInSeconds,token_type:w.BEARER}}else{let c=this.createTokenQueryParameters(e),d=O.appendQueryString(t.tokenEndpoint,c),l=await this.createTokenRequestBody(e),u=this.createTokenRequestHeaders(),g={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};this.logger.info("Sending token request to endpoint: "+t.tokenEndpoint),i=J.nowSeconds();let m=await this.executePostToTokenEndpoint(d,l,u,g,e.correlationId);o=m.body,o.status=m.status}let s=new Q(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return s.validateTokenResponse(o,n),await s.handleServerTokenResponse(o,this.authority,i,e)}async createTokenRequestBody(e){let t=new Map;I.addClientId(t,this.config.authOptions.clientId),I.addScopes(t,e.scopes,!1),I.addGrantType(t,Oe.CLIENT_CREDENTIALS_GRANT),I.addLibraryInfo(t,this.config.libraryInfo),I.addApplicationTelemetry(t,this.config.telemetry.application),I.addThrottling(t),this.serverTelemetryManager&&I.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();I.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&I.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=e.clientAssertion||this.config.clientCredentials.clientAssertion;return o&&(I.addClientAssertion(t,await le(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),I.addClientAssertionType(t,o.assertionType)),(!B.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),gt.mapToQueryString(t)}};var lo=class extends de{constructor(e){super(e)}async acquireToken(e){if(this.scopeSet=new V(e.scopes||[]),this.userAssertionHash=await this.cryptoUtils.hashString(e.oboAssertion),e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority,this.userAssertionHash);try{return await this.getCachedAuthenticationResult(e)}catch(t){return await this.executeTokenRequest(e,this.authority,this.userAssertionHash)}}async getCachedAuthenticationResult(e){var s,a;let t=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,e);if(t){if(J.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(a=this.serverTelemetryManager)==null||a.setCacheOutcome(H.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info(`OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),p(z.tokenRefreshRequired)}else throw(s=this.serverTelemetryManager)==null||s.setCacheOutcome(H.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),p(z.tokenRefreshRequired);let n=this.readIdTokenFromCacheForOBO(t.homeAccountId),o,i=null;if(n){o=Mo.extractTokenClaims(n.secret,ye.base64Decode);let c=o.oid||o.sub,d={homeAccountId:n.homeAccountId,environment:n.environment,tenantId:n.realm,username:f.EMPTY_STRING,localAccountId:c||f.EMPTY_STRING};i=this.cacheManager.readAccountFromCache(d)}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),Q.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:i,accessToken:t,idToken:n,refreshToken:null,appMetadata:null},!0,e,o)}readIdTokenFromCacheForOBO(e){let t={homeAccountId:e,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:N.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},n=this.cacheManager.getIdTokensByFilter(t);return Object.values(n).length<1?null:Object.values(n)[0]}readAccessTokenFromCacheForOBO(e,t){let n=t.authenticationScheme||w.BEARER,i={credentialType:n&&n.toLowerCase()!==w.BEARER.toLowerCase()?N.ACCESS_TOKEN_WITH_AUTH_SCHEME:N.ACCESS_TOKEN,clientId:e,target:V.createSearchScopes(this.scopeSet.asArray()),tokenType:n,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash,userAssertionHash:this.userAssertionHash},s=this.cacheManager.getAccessTokensByFilter(i),a=s.length;if(a<1)return null;if(a>1)throw p(z.multipleMatchingTokens);return s[0]}async executeTokenRequest(e,t,n){let o=this.createTokenQueryParameters(e),i=O.appendQueryString(t.tokenEndpoint,o),s=await this.createTokenRequestBody(e),a=this.createTokenRequestHeaders(),c={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},d=J.nowSeconds(),l=await this.executePostToTokenEndpoint(i,s,a,c,e.correlationId),u=new Q(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return u.validateTokenResponse(l.body),await u.handleServerTokenResponse(l.body,this.authority,d,e,void 0,n)}async createTokenRequestBody(e){let t=new Map;I.addClientId(t,this.config.authOptions.clientId),I.addScopes(t,e.scopes),I.addGrantType(t,Oe.JWT_BEARER),I.addClientInfo(t),I.addLibraryInfo(t,this.config.libraryInfo),I.addApplicationTelemetry(t,this.config.telemetry.application),I.addThrottling(t),this.serverTelemetryManager&&I.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();I.addCorrelationId(t,n),I.addRequestTokenUse(t,Jo.ON_BEHALF_OF),I.addOboAssertion(t,e.oboAssertion),this.config.clientCredentials.clientSecret&&I.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(I.addClientAssertion(t,await le(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),I.addClientAssertionType(t,o.assertionType)),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),gt.mapToQueryString(t)}};var uo=class extends Xr{constructor(e){var i,s,a;super(e);let t=!!this.config.auth.clientSecret,n=!!this.config.auth.clientAssertion,o=(!!((i=this.config.auth.clientCertificate)!=null&&i.thumbprint)||!!((s=this.config.auth.clientCertificate)!=null&&s.thumbprintSha256))&&!!((a=this.config.auth.clientCertificate)!=null&&a.privateKey);if(!this.appTokenProvider){if(t&&n||n&&o||t&&o)throw p(z.invalidClientCredential);if(this.config.auth.clientSecret){this.clientSecret=this.config.auth.clientSecret;return}if(this.config.auth.clientAssertion){this.developerProvidedClientAssertion=this.config.auth.clientAssertion;return}if(o)this.clientAssertion=this.config.auth.clientCertificate.thumbprintSha256?Rt.fromCertificateWithSha256Thumbprint(this.config.auth.clientCertificate.thumbprintSha256,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c):Rt.fromCertificate(this.config.auth.clientCertificate.thumbprint,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c);else throw p(z.invalidClientCredential);this.appTokenProvider=void 0}}SetAppTokenProvider(e){this.appTokenProvider=e}async acquireTokenByClientCredential(e){this.logger.info("acquireTokenByClientCredential called",e.correlationId);let t;e.clientAssertion&&(t={assertion:await le(e.clientAssertion,this.config.auth.clientId),assertionType:_e.JWT_BEARER_ASSERTION_TYPE});let n=await this.initializeBaseRequest(e),o={...n,scopes:n.scopes.filter(g=>!je.includes(g))},i={...e,...o,clientAssertion:t},a=new O(i.authority).getUrlComponents().PathSegments[0];if(Object.values(Ee).includes(a))throw p(z.missingTenantIdError);let c=process.env[Id],d;i.azureRegion!=="DisableMsalForceRegion"&&(!i.azureRegion&&c?d=c:d=i.azureRegion);let l={azureRegion:d,environmentRegion:process.env[Cd]},u=this.initializeServerTelemetryManager(Ct.acquireTokenByClientCredential,i.correlationId,i.skipCache);try{let g=await this.createAuthority(i.authority,i.correlationId,l,e.azureCloudOptions),m=await this.buildOauthClientConfiguration(g,i.correlationId,"",u),A=new Jr(m,this.appTokenProvider);return this.logger.verbose("Client credential client created",i.correlationId),await A.acquireToken(i)}catch(g){throw g instanceof v&&g.setCorrelationId(i.correlationId),u.cacheFailedRequest(g),g}}async acquireTokenOnBehalfOf(e){this.logger.info("acquireTokenOnBehalfOf called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)};try{let n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),o=await this.buildOauthClientConfiguration(n,t.correlationId,"",void 0),i=new lo(o);return this.logger.verbose("On behalf of client created",t.correlationId),await i.acquireToken(t)}catch(n){throw n instanceof v&&n.setCorrelationId(t.correlationId),n}}};function yf(r){if(typeof r!="string")return!1;let e=new Date(r);return!isNaN(e.getTime())&&e.toISOString()===r}var ji=class{constructor(e,t){this.httpClientNoRetries=e,this.retryPolicy=t}async sendNetworkRequestAsyncHelper(e,t,n){return e===X.GET?this.httpClientNoRetries.sendGetRequestAsync(t,n):this.httpClientNoRetries.sendPostRequestAsync(t,n)}async sendNetworkRequestAsync(e,t,n){let o=await this.sendNetworkRequestAsyncHelper(e,t,n),i=0;for(;await this.retryPolicy.pauseForRetry(o.status,i,o.headers[x.RETRY_AFTER]);)o=await this.sendNetworkRequestAsyncHelper(e,t,n),i++;return o}async sendGetRequestAsync(e,t){return this.sendNetworkRequestAsync(X.GET,e,t)}async sendPostRequestAsync(e,t){return this.sendNetworkRequestAsync(X.POST,e,t)}};var Ki={MANAGED_IDENTITY_CLIENT_ID:"client_id",MANAGED_IDENTITY_OBJECT_ID:"object_id",MANAGED_IDENTITY_RESOURCE_ID_IMDS:"msi_res_id",MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS:"mi_res_id"},it=class{constructor(e,t,n,o,i){this.logger=e,this.nodeStorage=t,this.networkClient=n,this.cryptoProvider=o,this.disableInternalRetries=i}async getServerTokenResponseAsync(e,t,n,o){return this.getServerTokenResponse(e)}getServerTokenResponse(e){var i,s;let t,n;return e.body.expires_on&&(yf(e.body.expires_on)&&(e.body.expires_on=new Date(e.body.expires_on).getTime()/1e3),n=e.body.expires_on-J.nowSeconds(),n>2*3600&&(t=n/2)),{status:e.status,access_token:e.body.access_token,expires_in:n,scope:e.body.resource,token_type:e.body.token_type,refresh_in:t,correlation_id:e.body.correlation_id||e.body.correlationId,error:typeof e.body.error=="string"?e.body.error:(i=e.body.error)==null?void 0:i.code,error_description:e.body.message||(typeof e.body.error=="string"?e.body.error_description:(s=e.body.error)==null?void 0:s.message),error_codes:e.body.error_codes,timestamp:e.body.timestamp,trace_id:e.body.trace_id}}async acquireTokenWithManagedIdentity(e,t,n,o){let i=this.createRequest(e.resource,t),s=i.headers;s[x.CONTENT_TYPE]=f.URL_FORM_CONTENT_TYPE;let a={headers:s};Object.keys(i.bodyParameters).length&&(a.body=i.computeParametersBodyString());let c=this.disableInternalRetries?this.networkClient:new ji(this.networkClient,i.retryPolicy),d=J.nowSeconds(),l;try{i.httpMethod===X.POST?l=await c.sendPostRequestAsync(i.computeUri(),a):l=await c.sendGetRequestAsync(i.computeUri(),a)}catch(m){throw m instanceof v?m:p(z.networkError)}let u=new Q(t.id,this.nodeStorage,this.cryptoProvider,this.logger,null,null),g=await this.getServerTokenResponseAsync(l,c,i,a);return u.validateTokenResponse(g,o),u.handleServerTokenResponse(g,n,d,e)}getManagedIdentityUserAssignedIdQueryParameterKey(e,t){switch(e){case be.USER_ASSIGNED_CLIENT_ID:return this.logger.info("[Managed Identity] Adding user assigned client id to the request."),Ki.MANAGED_IDENTITY_CLIENT_ID;case be.USER_ASSIGNED_RESOURCE_ID:return this.logger.info("[Managed Identity] Adding user assigned resource id to the request."),t?Ki.MANAGED_IDENTITY_RESOURCE_ID_IMDS:Ki.MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS;case be.USER_ASSIGNED_OBJECT_ID:return this.logger.info("[Managed Identity] Adding user assigned object id to the request."),Ki.MANAGED_IDENTITY_OBJECT_ID;default:throw cr(zn)}}};it.getValidatedEnvVariableUrlString=(r,e,t,n)=>{try{return new O(e).urlString}catch(o){throw n.info(`[Managed Identity] ${t} managed identity is unavailable because the '${r}' environment variable is malformed.`),cr(ar[r])}};var zi=require("fs"),vC=Ce(require("path"),1);var qb={win32:`${process.env.ProgramData}\\AzureConnectedMachineAgent\\Tokens\\`,linux:"/var/opt/azcmagent/tokens/"},Vb={win32:`${process.env.ProgramFiles}\\AzureConnectedMachineAgent\\himds.exe`,linux:"/opt/azcmagent/bin/himds"};var bC="/metadata/identity/oauth2/token",tM=`http://169.254.169.254${bC}`;var Df=Ce(Mf()),mr=Ce(require("fs")),Pf="https://login.microsoftonline.com/consumers",xc="http://localhost:5000",Lc=["Tasks.ReadWrite","offline_access"],ts=class{constructor(e,t,n,o){this.clientId=e,this.clientSecret=t,this.redirectUrl=n,this.tokenFilePath=o,this.initClient()}initClient(){let e={auth:{clientId:this.clientId,authority:Pf,clientSecret:this.clientSecret}};this.cca=new uo(e)}saveTokenCache(){let e=this.cca.getTokenCache().serialize();mr.writeFileSync(this.tokenFilePath,e)}async getAccessToken(){return new Promise((e,t)=>{let n=`${Pf}/oauth2/v2.0/authorize?client_id=${this.clientId}&response_type=code&redirect_uri=${encodeURIComponent(xc)}&response_mode=query&scope=${encodeURIComponent(Lc.join(" "))}&prompt=consent`,o=new Df.BrowserWindow({width:600,height:700,webPreferences:{nodeIntegration:!1,contextIsolation:!0}});o.loadURL(n),o.webContents.on("will-redirect",async(i,s)=>{try{let a=new URL(s),c=a.searchParams.get("error");if(c)throw new Error("OAuth error: "+c);let d=a.searchParams.get("code");if(!d)return;i.preventDefault(),o.close();let l={code:d,scopes:Lc,redirectUri:xc},u=await this.cca.acquireTokenByCode(l);if(!u)throw new Error("No token response received.");this.saveTokenCache(),e({accessToken:u.accessToken})}catch(a){o.isDestroyed()||o.close(),t(a)}})})}async refreshAccessTokenWithCCA(){if(!mr.existsSync(this.tokenFilePath))throw new Error("No token cache found. Please login first.");let e=mr.readFileSync(this.tokenFilePath,"utf8");this.cca.getTokenCache().deserialize(e);let t=this.cca.getTokenCache().serialize(),n=JSON.parse(t);if(!n.RefreshToken)throw new Error("No refresh token found in the cache.");let o=n.RefreshToken,i=Object.keys(o)[0],a={refreshToken:o[i].secret,scopes:Lc,redirectUri:xc};try{let c=await this.cca.acquireTokenByRefreshToken(a);if(!c)throw new Error("No token response received from refresh.");return this.saveTokenCache(),{accessToken:c.accessToken}}catch(c){throw c}}async getToken(){return mr.existsSync(this.tokenFilePath)?this.refreshAccessTokenWithCCA():this.getAccessToken()}};var xf=require("obsidian"),rs=class extends xf.Modal{constructor(e,t){super(e),this.onSubmit=t}onOpen(){let{contentEl:e}=this;e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="center",e.style.justifyContent="center",e.style.gap="10px",e.style.minHeight="100px",e.createEl("h2",{text:"Enter Task Title"});let t=e.createEl("input",{type:"text",placeholder:"Task Title"});t.style.width="100%",t.focus(),t.onkeydown=n=>{n.key==="Enter"&&(this.result=t.value,this.close(),this.onSubmit(this.result))}}onClose(){this.contentEl.empty()}};var Lf=require("obsidian"),po=class extends Lf.FuzzySuggestModal{constructor(e,t,n,o){super(e),this.items=t,this.getText=n,this.onSelect=o}getItems(){return this.items}getItemText(e){return this.getText(e)}async onChooseItem(e){await this.onSelect(e)}};var ns=class extends os.Plugin{constructor(){super(...arguments);this.sidebarView=null;this.taskCache=null}async onload(){let t=this.app.vault.adapter.basePath,n=Uc.join(t,".obsidian/plugins/sync-obsidian-todo-plugin");if(Uf.config({path:Uc.join(n,".env"),override:!0}),await this.loadSettings(),this.addSettingTab(new Co(this.app,this)),this.registerView(So,o=>{let i=new Io(o,this);return this.sidebarView=i,i}),this.initializeCommand(),this.tokenFilePath=`${n}/token_cache.json`,this.settings.clientId&&this.settings.clientSecret&&(this.authManager=new ts(this.settings.clientId,this.settings.clientSecret,this.settings.redirectUrl,this.tokenFilePath)),is.existsSync(this.tokenFilePath)){let o=is.readFileSync(this.tokenFilePath,"utf8");this.authManager.cca.getTokenCache().deserialize(o),console.log("Token cache loaded from file.")}this.injectStyles()}initializeCommand(){this.addCommand({id:"open-microsoft-todo-sidebar",name:"Open Microsoft To-Do Sidebar",callback:async()=>{this.activateSidebar()}}),this.addCommand({id:"login-microsoft-todo",name:"Login to Microsoft To-Do (Interactive)",callback:async()=>{try{b("Logging in..."),await this.authManager.getAccessToken(),b("Logged in successfully!","success")}catch(t){console.error("Authentication error:",t),b("Error logining in! Check the console for details.","error")}}}),this.addCommand({id:"refresh-microsoft-todo-token",name:"Refresh Microsoft To-Do Token",callback:async()=>{try{let t=await this.authManager.refreshAccessTokenWithCCA();b("Token refreshed successfully!","success"),console.log("New Access Token:",t.accessToken)}catch(t){console.error("Error refreshing token:",t),b("Error refreshing token. Check the console for details.","error")}}}),this.addCommand({id:"get-tasks-from-selected-list",name:"Get Tasks from Selected List",callback:async()=>{try{b("Fetching tasks..."),await this.getTasksFromSelectedList(),b("Tasks fetched successfully!","success")}catch(t){console.error("Error fetching tasks from selected list:",t),b("Error fetching tasks. Check the console for details.","error")}}}),this.addCommand({id:"push-all-tasks-from-note",name:"Push All Tasks from Note to Microsoft To-Do",callback:async()=>{try{b("Syncing tasks to Microsoft To-Do...");let t=await this.pushTasksFromNote();b(`Tasks synced successfully! ${t} new tasks added.`,"success"),await this.refreshViewAndCache()}catch(t){console.error("Error pushing tasks:",t),b("Error pushing tasks. Check the console for details.","error")}}}),this.addCommand({id:"push-one-task",name:"Create and push Task",callback:async()=>{new rs(this.app,async t=>{try{b("Pushing tasks to Microsoft To-Do..."),await this.pushOneTask(t),b("Tasks pushed successfully!","success")}catch(n){console.error("Error pushing tasks:",n),b("Error pushing tasks. Check the console for details.","error")}}).open()}}),this.addCommand({id:"show-not-started-tasks",name:"Show Tasks List",callback:async()=>{try{await this.openTaskCompleteModal()}catch(t){console.error("Error completing task:",t),b("Error completing task. Check the console for details.","error")}}}),this.addCommand({id:"select-task-list",name:"Select Task List",callback:async()=>{try{b("Selecting task list..."),await this.openTaskListsModal(),b("Task list selected successfully!","success")}catch(t){console.error("Error selecting task list:",t),b("Error selecting task list. Check the console for details.","error")}}}),this.addCommand({id:"organize-tasks",name:"Organize Tasks from All Notes",callback:async()=>{try{await this.gatherTasks(),b("Tasks organized successfully!","success")}catch(t){console.error("Error organizing tasks:",t),b("Error organizing tasks. Check the console for details.","error")}}}),this.addCommand({id:"delete-completed-tasks",name:"Delete Completed Tasks",callback:async()=>{try{b("Deleting completed tasks...");let t=await this.deleteAllCompletedTasks();b(`${t} completed tasks deleted successfully!`,"success")}catch(t){console.error("Error deleting completed tasks:",t),b("Error deleting tasks. Check the console for details.","error")}}}),this.addCommand({id:"testing",name:"Testing",callback:async()=>{try{console.log("Testing"),b("Testing...","success")}catch(t){console.error("Error testing:",t)}}})}injectStyles(){let t=document.createElement("style");t.textContent=`
		.task-line {
			display: flex;
			align-items: center;
			gap: 8px;
			padding: 2px 0;
		}

		.task-line input[type="checkbox"] {
			margin: 0;
			transform: scale(1.1);
		}

		.task-line span {
			font-size: 14px;
		}
	`,document.head.appendChild(t)}async activateSidebar(){let t=this.app.workspace.getRightLeaf(!1);if(!t){console.warn("No right leaf available.");return}await t.setViewState({type:So,active:!0}),this.app.workspace.revealLeaf(t)}async loadSettings(){this.settings=Object.assign({},Yc,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async getAccessToken(){try{return(await this.authManager.getToken()).accessToken}catch(t){throw console.error("Error fetching access token:",t),t}}async loadAvailableTaskLists(){b("Loading task lists...");try{let t=await this.getAccessToken(),n=await ps(t);console.log("Fetched Task Lists:",n),this.settings.taskLists=n.map(o=>({id:o.id,title:o.title})),b("Task lists loaded successfully!","success")}catch(t){console.error("Error loading task lists:",t),b("Error loading task lists. Check the console for details.","error")}}async getTaskLists(){try{let t=await this.getAccessToken();return await ps(t)}catch(t){throw console.error("Error fetching task lists:",t),t}}async getTasksFromSelectedList(){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");if(this.taskCache&&this.taskCache.tasks)return console.log("Using cached tasks:",this.taskCache.tasks),new Map(this.taskCache.tasks);try{return console.log("No cached tasks found, refreshing task cache."),await this.refreshTaskCache()}catch(t){throw console.error("Error fetching tasks:",t),t}}async pushTasksFromNote(){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");let t=this.app.workspace.getActiveFile();if(!t)throw new Error("No active file found.");let n=await this.app.vault.read(t),o=/^-\s*\[( |x)\]\s+(.+)$/gm,i=[],s;for(;(s=o.exec(n))!==null;){let a=s[1]==="x",c=s[2].trim();i.push({title:c,complete:a})}if(i.length===0)throw new Error("No tasks found in the active note.");try{let a=await this.getAccessToken(),c=await _o(this.settings,a),d=0;for(let l of i){let u=c.get(l.title);if(u){l.complete&&u.status!=="completed"?await fs(this.settings,a,u.id,!0):console.log(`Task already exists: ${l.title}`);continue}let g=l.complete?"completed":"notStarted";await hs(this.settings,a,l.title,g),d++}return console.log("Synced Tasks:",i),d}catch(a){throw console.error("Error syncing tasks:",a),a}}async pushOneTask(t){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");try{let n=await this.getAccessToken();(await _o(this.settings,n)).get(t)&&console.log(`Task already exists: ${t}`),await hs(this.settings,n,t),await this.refreshViewAndCache(),console.log("Synced Tasks:",t)}catch(n){throw console.error("Error syncing tasks:",n),n}}async gatherTasks(){let t="Tasks List.md",n=this.app.vault.getMarkdownFiles(),o=new Map,i=/^\s*-\s*\[( |x)\]\s+(.*)$/gm;for(let d of n){let l=await this.app.vault.read(d),u;for(;(u=i.exec(l))!==null;){let g=u[1]==="x"?"[x]":"[ ]",m=u[2].trim();o.has(m)?g==="[x]"&&o.set(m,"[x]"):o.set(m,g)}}let a=Array.from(o.entries()).map(([d,l])=>`- ${l} ${d}`).join(`
`),c=this.app.vault.getAbstractFileByPath(t);if(!c)await this.app.vault.create(t,a);else if(c instanceof os.TFile)await this.app.vault.modify(c,a);else throw new Error("Unexpected file type for Tasks List");return o}async openTaskListsModal(){let t=this.settings.taskLists;console.log("Task Lists:",t),new po(this.app,t,n=>n.title,async n=>{this.settings.selectedTaskListId=n.id,await this.saveSettings(),await this.refreshViewAndCache()}).open()}async openTaskCompleteModal(){let t=await this.getTasksFromSelectedList(),n=Array.from(t.values()).filter(o=>o.status!=="completed");new po(this.app,n,o=>o.status!=="completed"?o.title:"",async o=>{let i=await this.getAccessToken();await fs(this.settings,i,o.id,!0),b(`Task "${o.title}" marked as complete and synced.`,"success"),await this.refreshViewAndCache()}).open()}async refreshTaskCache(){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");try{let t=await this.getAccessToken(),n=await _o(this.settings,t);console.log("Fetched Tasks:",n);let o=await this.loadData()||{};return o.tasks=Array.from(n.entries()),this.taskCache=o,await this.saveData(o),n}catch(t){throw console.error("Error fetching tasks:",t),t}}async deleteAllCompletedTasks(){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");let t=0;try{let n=await this.getAccessToken(),o=await this.getTasksFromSelectedList(),i=Array.from(o.values()).filter(s=>s.status==="completed");for(let s of i)console.log("Deleting Task:",s),await Qc(this.settings,n,s.id),t++;return this.refreshViewAndCache(),t}catch(n){return console.error("Error deleting tasks:",n),t}}async refreshViewAndCache(){let t=await this.refreshTaskCache();this.sidebarView?await this.sidebarView.render(t):console.warn("Sidebar view is not active.")}};
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

@azure/msal-node/dist/cache/serializer/Serializer.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-common/dist/utils/Constants.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/AuthErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/AuthError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ClientAuthErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ClientAuthError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/crypto/ICrypto.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/logger/Logger.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/packageMetadata.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/AuthorityOptions.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/AuthToken.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/TimeUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/cache/utils/CacheHelpers.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ClientConfigurationErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ClientConfigurationError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/StringUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/request/ScopeSet.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/ClientInfo.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/AccountInfo.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/AuthorityType.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/TokenClaims.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/ProtocolMode.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/cache/entities/AccountEntity.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/UrlUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/url/UrlString.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/AuthorityMetadata.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/CacheErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/CacheError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/cache/CacheManager.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/config/ClientConfiguration.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/CcsCredential.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/constants/AADServerParamKeys.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/request/RequestParameterBuilder.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/OpenIdConfigResponse.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/CloudInstanceDiscoveryResponse.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/CloudInstanceDiscoveryErrorResponse.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/telemetry/performance/PerformanceEvent.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/FunctionWrappers.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/RegionDiscovery.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/Authority.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/AuthorityFactory.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ServerError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/network/RequestThumbprint.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/network/ThrottlingUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/NetworkError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/client/BaseClient.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/InteractionRequiredAuthErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/InteractionRequiredAuthError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/ProtocolUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/crypto/PopTokenGenerator.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/cache/persistence/TokenCacheContext.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/response/ResponseHandler.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/request/RequestValidator.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/ClientAssertionUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/client/AuthorizationCodeClient.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/client/RefreshTokenClient.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/client/SilentFlowClient.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/protocol/Authorize.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/telemetry/server/ServerTelemetryManager.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/index-node.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-node/dist/cache/serializer/Deserializer.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/internals.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/utils/Constants.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/utils/NetworkUtils.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/network/HttpClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/error/ManagedIdentityErrorCodes.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/error/ManagedIdentityError.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/config/ManagedIdentityId.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/error/NodeAuthError.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/config/Configuration.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/crypto/GuidGenerator.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/utils/EncodingUtils.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/crypto/HashUtils.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/crypto/PkceGenerator.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/crypto/CryptoProvider.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/cache/NodeStorage.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/cache/TokenCache.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ClientAssertion.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/packageMetadata.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/UsernamePasswordClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/protocol/Authorize.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ClientApplication.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/network/LoopbackClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/DeviceCodeClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/PublicClientApplication.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ClientCredentialClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/OnBehalfOfClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ConfidentialClientApplication.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/utils/TimeUtils.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/network/HttpClientWithRetries.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/BaseManagedIdentitySource.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/retry/LinearRetryPolicy.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/config/ManagedIdentityRequestParameters.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/AppService.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/AzureArc.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/CloudShell.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/Imds.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/ServiceFabric.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/MachineLearning.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentityClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentityApplication.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/cache/distributed/DistributedCachePlugin.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/index.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)
*/
