/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Hf=Object.create;var ko=Object.defineProperty;var Ff=Object.getOwnPropertyDescriptor;var $f=Object.getOwnPropertyNames;var Bf=Object.getPrototypeOf,Gf=Object.prototype.hasOwnProperty;var E=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),$e=(r,e)=>{for(var t in e)ko(r,t,{get:e[t],enumerable:!0})},$c=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of $f(e))!Gf.call(r,o)&&o!==t&&ko(r,o,{get:()=>e[o],enumerable:!(n=Ff(e,o))||n.enumerable});return r};var Se=(r,e,t)=>(t=r!=null?Hf(Bf(r)):{},$c(e||!r||!r.__esModule?ko(t,"default",{value:r,enumerable:!0}):t,r)),qf=r=>$c(ko({},"__esModule",{value:!0}),r);var Bc=E((iI,Vf)=>{Vf.exports={name:"dotenv",version:"16.4.7",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard",pretest:"npm run lint && npm run dts-check",test:"tap run --allow-empty-coverage --disable-coverage --timeout=60000","test:coverage":"tap run --show-full-coverage --timeout=60000 --coverage-report=lcov",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},funding:"https://dotenvx.com",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^18.11.3",decache:"^4.6.2",sinon:"^14.0.1",standard:"^17.0.0","standard-version":"^9.5.0",tap:"^19.2.0",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var Kc=E((sI,We)=>{var fs=require("fs"),ps=require("path"),Kf=require("os"),jf=require("crypto"),Yf=Bc(),ms=Yf.version,zf=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function Wf(r){let e={},t=r.toString();t=t.replace(/\r\n?/mg,`
`);let n;for(;(n=zf.exec(t))!=null;){let o=n[1],i=n[2]||"";i=i.trim();let s=i[0];i=i.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),s==='"'&&(i=i.replace(/\\n/g,`
`),i=i.replace(/\\r/g,"\r")),e[o]=i}return e}function Qf(r){let e=Vc(r),t=j.configDotenv({path:e});if(!t.parsed){let s=new Error(`MISSING_DATA: Cannot parse ${e} for an unknown reason`);throw s.code="MISSING_DATA",s}let n=qc(r).split(","),o=n.length,i;for(let s=0;s<o;s++)try{let a=n[s].trim(),c=Zf(t,a);i=j.decrypt(c.ciphertext,c.key);break}catch(a){if(s+1>=o)throw a}return j.parse(i)}function Xf(r){console.log(`[dotenv@${ms}][INFO] ${r}`)}function Jf(r){console.log(`[dotenv@${ms}][WARN] ${r}`)}function wo(r){console.log(`[dotenv@${ms}][DEBUG] ${r}`)}function qc(r){return r&&r.DOTENV_KEY&&r.DOTENV_KEY.length>0?r.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function Zf(r,e){let t;try{t=new URL(e)}catch(a){if(a.code==="ERR_INVALID_URL"){let c=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw c.code="INVALID_DOTENV_KEY",c}throw a}let n=t.password;if(!n){let a=new Error("INVALID_DOTENV_KEY: Missing key part");throw a.code="INVALID_DOTENV_KEY",a}let o=t.searchParams.get("environment");if(!o){let a=new Error("INVALID_DOTENV_KEY: Missing environment part");throw a.code="INVALID_DOTENV_KEY",a}let i=`DOTENV_VAULT_${o.toUpperCase()}`,s=r.parsed[i];if(!s){let a=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${i} in your .env.vault file.`);throw a.code="NOT_FOUND_DOTENV_ENVIRONMENT",a}return{ciphertext:s,key:n}}function Vc(r){let e=null;if(r&&r.path&&r.path.length>0)if(Array.isArray(r.path))for(let t of r.path)fs.existsSync(t)&&(e=t.endsWith(".vault")?t:`${t}.vault`);else e=r.path.endsWith(".vault")?r.path:`${r.path}.vault`;else e=ps.resolve(process.cwd(),".env.vault");return fs.existsSync(e)?e:null}function Gc(r){return r[0]==="~"?ps.join(Kf.homedir(),r.slice(1)):r}function ep(r){Xf("Loading env from encrypted .env.vault");let e=j._parseVault(r),t=process.env;return r&&r.processEnv!=null&&(t=r.processEnv),j.populate(t,e,r),{parsed:e}}function tp(r){let e=ps.resolve(process.cwd(),".env"),t="utf8",n=!!(r&&r.debug);r&&r.encoding?t=r.encoding:n&&wo("No encoding is specified. UTF-8 is used by default");let o=[e];if(r&&r.path)if(!Array.isArray(r.path))o=[Gc(r.path)];else{o=[];for(let c of r.path)o.push(Gc(c))}let i,s={};for(let c of o)try{let d=j.parse(fs.readFileSync(c,{encoding:t}));j.populate(s,d,r)}catch(d){n&&wo(`Failed to load ${c} ${d.message}`),i=d}let a=process.env;return r&&r.processEnv!=null&&(a=r.processEnv),j.populate(a,s,r),i?{parsed:s,error:i}:{parsed:s}}function rp(r){if(qc(r).length===0)return j.configDotenv(r);let e=Vc(r);return e?j._configVault(r):(Jf(`You set DOTENV_KEY but you are missing a .env.vault file at ${e}. Did you forget to build it?`),j.configDotenv(r))}function np(r,e){let t=Buffer.from(e.slice(-64),"hex"),n=Buffer.from(r,"base64"),o=n.subarray(0,12),i=n.subarray(-16);n=n.subarray(12,-16);try{let s=jf.createDecipheriv("aes-256-gcm",t,o);return s.setAuthTag(i),`${s.update(n)}${s.final()}`}catch(s){let a=s instanceof RangeError,c=s.message==="Invalid key length",d=s.message==="Unsupported state or unable to authenticate data";if(a||c){let l=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw l.code="INVALID_DOTENV_KEY",l}else if(d){let l=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw l.code="DECRYPTION_FAILED",l}else throw s}}function op(r,e,t={}){let n=!!(t&&t.debug),o=!!(t&&t.override);if(typeof e!="object"){let i=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw i.code="OBJECT_REQUIRED",i}for(let i of Object.keys(e))Object.prototype.hasOwnProperty.call(r,i)?(o===!0&&(r[i]=e[i]),n&&wo(o===!0?`"${i}" is already defined and WAS overwritten`:`"${i}" is already defined and was NOT overwritten`)):r[i]=e[i]}var j={configDotenv:tp,_configVault:ep,_parseVault:Qf,config:rp,decrypt:np,parse:Wf,populate:op};We.exports.configDotenv=j.configDotenv;We.exports._configVault=j._configVault;We.exports._parseVault=j._parseVault;We.exports.config=j.config;We.exports.decrypt=j.decrypt;We.exports.parse=j.parse;We.exports.populate=j.populate;We.exports=j});var zr=E(($a,Ud)=>{var Ci=require("buffer"),Ve=Ci.Buffer;function Ld(r,e){for(var t in r)e[t]=r[t]}Ve.from&&Ve.alloc&&Ve.allocUnsafe&&Ve.allocUnsafeSlow?Ud.exports=Ci:(Ld(Ci,$a),$a.Buffer=mr);function mr(r,e,t){return Ve(r,e,t)}mr.prototype=Object.create(Ve.prototype);Ld(Ve,mr);mr.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return Ve(r,e,t)};mr.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=Ve(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};mr.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Ve(r)};mr.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Ci.SlowBuffer(r)}});var Ba=E((QO,Hd)=>{var Ii=zr().Buffer,Im=require("stream"),Sm=require("util");function Si(r){if(this.buffer=null,this.writable=!0,this.readable=!0,!r)return this.buffer=Ii.alloc(0),this;if(typeof r.pipe=="function")return this.buffer=Ii.alloc(0),r.pipe(this),this;if(r.length||typeof r=="object")return this.buffer=r,this.writable=!1,process.nextTick(function(){this.emit("end",r),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof r+")")}Sm.inherits(Si,Im);Si.prototype.write=function(e){this.buffer=Ii.concat([this.buffer,Ii.from(e)]),this.emit("data",e)};Si.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};Hd.exports=Si});var $d=E((XO,Fd)=>{"use strict";var oo=require("buffer").Buffer,Ga=require("buffer").SlowBuffer;Fd.exports=_i;function _i(r,e){if(!oo.isBuffer(r)||!oo.isBuffer(e)||r.length!==e.length)return!1;for(var t=0,n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}_i.install=function(){oo.prototype.equal=Ga.prototype.equal=function(e){return _i(this,e)}};var _m=oo.prototype.equal,Rm=Ga.prototype.equal;_i.restore=function(){oo.prototype.equal=_m,Ga.prototype.equal=Rm}});var Gd=E((JO,Bd)=>{"use strict";function qa(r){var e=(r/8|0)+(r%8===0?0:1);return e}var km={ES256:qa(256),ES384:qa(384),ES512:qa(521)};function wm(r){var e=km[r];if(e)return e;throw new Error('Unknown algorithm "'+r+'"')}Bd.exports=wm});var Wd=E((ZO,zd)=>{"use strict";var Ri=zr().Buffer,Vd=Gd(),ki=128,Kd=0,Om=32,Nm=16,vm=2,jd=Nm|Om|Kd<<6,wi=vm|Kd<<6;function bm(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Yd(r){if(Ri.isBuffer(r))return r;if(typeof r=="string")return Ri.from(r,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function Mm(r,e){r=Yd(r);var t=Vd(e),n=t+1,o=r.length,i=0;if(r[i++]!==jd)throw new Error('Could not find expected "seq"');var s=r[i++];if(s===(ki|1)&&(s=r[i++]),o-i<s)throw new Error('"seq" specified length of "'+s+'", only "'+(o-i)+'" remaining');if(r[i++]!==wi)throw new Error('Could not find expected "int" for "r"');var a=r[i++];if(o-i-2<a)throw new Error('"r" specified length of "'+a+'", only "'+(o-i-2)+'" available');if(n<a)throw new Error('"r" specified length of "'+a+'", max of "'+n+'" is acceptable');var c=i;if(i+=a,r[i++]!==wi)throw new Error('Could not find expected "int" for "s"');var d=r[i++];if(o-i!==d)throw new Error('"s" specified length of "'+d+'", expected "'+(o-i)+'"');if(n<d)throw new Error('"s" specified length of "'+d+'", max of "'+n+'" is acceptable');var l=i;if(i+=d,i!==o)throw new Error('Expected to consume entire buffer, but "'+(o-i)+'" bytes remain');var u=t-a,g=t-d,m=Ri.allocUnsafe(u+a+g+d);for(i=0;i<u;++i)m[i]=0;r.copy(m,i,c+Math.max(-u,0),c+a),i=t;for(var A=i;i<A+g;++i)m[i]=0;return r.copy(m,i,l+Math.max(-g,0),l+d),m=m.toString("base64"),m=bm(m),m}function qd(r,e,t){for(var n=0;e+n<t&&r[e+n]===0;)++n;var o=r[e+n]>=ki;return o&&--n,n}function Pm(r,e){r=Yd(r);var t=Vd(e),n=r.length;if(n!==t*2)throw new TypeError('"'+e+'" signatures must be "'+t*2+'" bytes, saw "'+n+'"');var o=qd(r,0,t),i=qd(r,t,r.length),s=t-o,a=t-i,c=1+1+s+1+1+a,d=c<ki,l=Ri.allocUnsafe((d?2:3)+c),u=0;return l[u++]=jd,d?l[u++]=c:(l[u++]=ki|1,l[u++]=c&255),l[u++]=wi,l[u++]=s,o<0?(l[u++]=0,u+=r.copy(l,u,0,t)):u+=r.copy(l,u,o,t),l[u++]=wi,l[u++]=a,i<0?(l[u++]=0,r.copy(l,u,t)):r.copy(l,u,t+i),l}zd.exports={derToJose:Mm,joseToDer:Pm}});var ja=E((eN,ol)=>{var Dm=$d(),Qr=zr().Buffer,Ke=require("crypto"),Xd=Wd(),Qd=require("util"),xm=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,io="secret must be a string or buffer",Wr="key must be a string or a buffer",Lm="key must be a string, a buffer or an object",Va=typeof Ke.createPublicKey=="function";Va&&(Wr+=" or a KeyObject",io+="or a KeyObject");function Jd(r){if(!Qr.isBuffer(r)&&typeof r!="string"&&(!Va||typeof r!="object"||typeof r.type!="string"||typeof r.asymmetricKeyType!="string"||typeof r.export!="function"))throw Fe(Wr)}function Zd(r){if(!Qr.isBuffer(r)&&typeof r!="string"&&typeof r!="object")throw Fe(Lm)}function Um(r){if(!Qr.isBuffer(r)){if(typeof r=="string")return r;if(!Va||typeof r!="object"||r.type!=="secret"||typeof r.export!="function")throw Fe(io)}}function Ka(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function el(r){r=r.toString();var e=4-r.length%4;if(e!==4)for(var t=0;t<e;++t)r+="=";return r.replace(/\-/g,"+").replace(/_/g,"/")}function Fe(r){var e=[].slice.call(arguments,1),t=Qd.format.bind(Qd,r).apply(null,e);return new TypeError(t)}function Hm(r){return Qr.isBuffer(r)||typeof r=="string"}function so(r){return Hm(r)||(r=JSON.stringify(r)),r}function tl(r){return function(t,n){Um(n),t=so(t);var o=Ke.createHmac("sha"+r,n),i=(o.update(t),o.digest("base64"));return Ka(i)}}function Fm(r){return function(t,n,o){var i=tl(r)(t,o);return Dm(Qr.from(n),Qr.from(i))}}function rl(r){return function(t,n){Zd(n),t=so(t);var o=Ke.createSign("RSA-SHA"+r),i=(o.update(t),o.sign(n,"base64"));return Ka(i)}}function nl(r){return function(t,n,o){Jd(o),t=so(t),n=el(n);var i=Ke.createVerify("RSA-SHA"+r);return i.update(t),i.verify(o,n,"base64")}}function $m(r){return function(t,n){Zd(n),t=so(t);var o=Ke.createSign("RSA-SHA"+r),i=(o.update(t),o.sign({key:n,padding:Ke.constants.RSA_PKCS1_PSS_PADDING,saltLength:Ke.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return Ka(i)}}function Bm(r){return function(t,n,o){Jd(o),t=so(t),n=el(n);var i=Ke.createVerify("RSA-SHA"+r);return i.update(t),i.verify({key:o,padding:Ke.constants.RSA_PKCS1_PSS_PADDING,saltLength:Ke.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function Gm(r){var e=rl(r);return function(){var n=e.apply(null,arguments);return n=Xd.derToJose(n,"ES"+r),n}}function qm(r){var e=nl(r);return function(n,o,i){o=Xd.joseToDer(o,"ES"+r).toString("base64");var s=e(n,o,i);return s}}function Vm(){return function(){return""}}function Km(){return function(e,t){return t===""}}ol.exports=function(e){var t={hs:tl,rs:rl,ps:$m,es:Gm,none:Vm},n={hs:Fm,rs:nl,ps:Bm,es:qm,none:Km},o=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!o)throw Fe(xm,e);var i=(o[1]||o[3]).toLowerCase(),s=o[2];return{sign:t[i](s),verify:n[i](s)}}});var Ya=E((tN,il)=>{var jm=require("buffer").Buffer;il.exports=function(e){return typeof e=="string"?e:typeof e=="number"||jm.isBuffer(e)?e.toString():JSON.stringify(e)}});var ul=E((rN,ll)=>{var Ym=zr().Buffer,sl=Ba(),zm=ja(),Wm=require("stream"),al=Ya(),za=require("util");function cl(r,e){return Ym.from(r,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Qm(r,e,t){t=t||"utf8";var n=cl(al(r),"binary"),o=cl(al(e),t);return za.format("%s.%s",n,o)}function dl(r){var e=r.header,t=r.payload,n=r.secret||r.privateKey,o=r.encoding,i=zm(e.alg),s=Qm(e,t,o),a=i.sign(s,n);return za.format("%s.%s",s,a)}function Oi(r){var e=r.secret||r.privateKey||r.key,t=new sl(e);this.readable=!0,this.header=r.header,this.encoding=r.encoding,this.secret=this.privateKey=this.key=t,this.payload=new sl(r.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}za.inherits(Oi,Wm);Oi.prototype.sign=function(){try{var e=dl({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}};Oi.sign=dl;ll.exports=Oi});var Cl=E((nN,Al)=>{var fl=zr().Buffer,hl=Ba(),Xm=ja(),Jm=require("stream"),pl=Ya(),Zm=require("util"),eg=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function tg(r){return Object.prototype.toString.call(r)==="[object Object]"}function rg(r){if(tg(r))return r;try{return JSON.parse(r)}catch(e){return}}function ml(r){var e=r.split(".",1)[0];return rg(fl.from(e,"base64").toString("binary"))}function ng(r){return r.split(".",2).join(".")}function gl(r){return r.split(".")[2]}function og(r,e){e=e||"utf8";var t=r.split(".")[1];return fl.from(t,"base64").toString(e)}function El(r){return eg.test(r)&&!!ml(r)}function Tl(r,e,t){if(!e){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}r=pl(r);var o=gl(r),i=ng(r),s=Xm(e);return s.verify(i,o,t)}function yl(r,e){if(e=e||{},r=pl(r),!El(r))return null;var t=ml(r);if(!t)return null;var n=og(r);return(t.typ==="JWT"||e.json)&&(n=JSON.parse(n,e.encoding)),{header:t,payload:n,signature:gl(r)}}function Xr(r){r=r||{};var e=r.secret||r.publicKey||r.key,t=new hl(e);this.readable=!0,this.algorithm=r.algorithm,this.encoding=r.encoding,this.secret=this.publicKey=this.key=t,this.signature=new hl(r.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}Zm.inherits(Xr,Jm);Xr.prototype.verify=function(){try{var e=Tl(this.signature.buffer,this.algorithm,this.key.buffer),t=yl(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};Xr.decode=yl;Xr.isValid=El;Xr.verify=Tl;Al.exports=Xr});var vi=E(Ot=>{var Il=ul(),Ni=Cl(),ig=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];Ot.ALGORITHMS=ig;Ot.sign=Il.sign;Ot.verify=Ni.verify;Ot.decode=Ni.decode;Ot.isValid=Ni.isValid;Ot.createSign=function(e){return new Il(e)};Ot.createVerify=function(e){return new Ni(e)}});var Wa=E((iN,Sl)=>{var sg=vi();Sl.exports=function(r,e){e=e||{};var t=sg.decode(r,e);if(!t)return null;var n=t.payload;if(typeof n=="string")try{var o=JSON.parse(n);o!==null&&typeof o=="object"&&(n=o)}catch(i){}return e.complete===!0?{header:t.header,payload:n,signature:t.signature}:n}});var ao=E((sN,_l)=>{var bi=function(r,e){Error.call(this,r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=r,e&&(this.inner=e)};bi.prototype=Object.create(Error.prototype);bi.prototype.constructor=bi;_l.exports=bi});var Qa=E((aN,kl)=>{var Rl=ao(),Mi=function(r,e){Rl.call(this,r),this.name="NotBeforeError",this.date=e};Mi.prototype=Object.create(Rl.prototype);Mi.prototype.constructor=Mi;kl.exports=Mi});var Xa=E((cN,Ol)=>{var wl=ao(),Pi=function(r,e){wl.call(this,r),this.name="TokenExpiredError",this.expiredAt=e};Pi.prototype=Object.create(wl.prototype);Pi.prototype.constructor=Pi;Ol.exports=Pi});var vl=E((dN,Nl)=>{var Jr=1e3,Zr=Jr*60,en=Zr*60,gr=en*24,ag=gr*7,cg=gr*365.25;Nl.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return dg(r);if(t==="number"&&isFinite(r))return e.long?ug(r):lg(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function dg(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*cg;case"weeks":case"week":case"w":return t*ag;case"days":case"day":case"d":return t*gr;case"hours":case"hour":case"hrs":case"hr":case"h":return t*en;case"minutes":case"minute":case"mins":case"min":case"m":return t*Zr;case"seconds":case"second":case"secs":case"sec":case"s":return t*Jr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function lg(r){var e=Math.abs(r);return e>=gr?Math.round(r/gr)+"d":e>=en?Math.round(r/en)+"h":e>=Zr?Math.round(r/Zr)+"m":e>=Jr?Math.round(r/Jr)+"s":r+"ms"}function ug(r){var e=Math.abs(r);return e>=gr?Di(r,e,gr,"day"):e>=en?Di(r,e,en,"hour"):e>=Zr?Di(r,e,Zr,"minute"):e>=Jr?Di(r,e,Jr,"second"):r+" ms"}function Di(r,e,t,n){var o=e>=t*1.5;return Math.round(r/t)+" "+n+(o?"s":"")}});var Ja=E((lN,bl)=>{var hg=vl();bl.exports=function(r,e){var t=e||Math.floor(Date.now()/1e3);if(typeof r=="string"){var n=hg(r);return typeof n=="undefined"?void 0:Math.floor(t+n/1e3)}else return typeof r=="number"?t+r:void 0}});var co=E((uN,Ml)=>{var fg="2.0.0",pg=Number.MAX_SAFE_INTEGER||9007199254740991,mg=16,gg=256-6,Eg=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Ml.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:mg,MAX_SAFE_BUILD_LENGTH:gg,MAX_SAFE_INTEGER:pg,RELEASE_TYPES:Eg,SEMVER_SPEC_VERSION:fg,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var lo=E((hN,Pl)=>{var Tg=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};Pl.exports=Tg});var tn=E((je,Dl)=>{var{MAX_SAFE_COMPONENT_LENGTH:Za,MAX_SAFE_BUILD_LENGTH:yg,MAX_LENGTH:Ag}=co(),Cg=lo();je=Dl.exports={};var Ig=je.re=[],Sg=je.safeRe=[],T=je.src=[],_g=je.safeSrc=[],y=je.t={},Rg=0,ec="[a-zA-Z0-9-]",kg=[["\\s",1],["\\d",Ag],[ec,yg]],wg=r=>{for(let[e,t]of kg)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},_=(r,e,t)=>{let n=wg(e),o=Rg++;Cg(r,o,e),y[r]=o,T[o]=e,_g[o]=n,Ig[o]=new RegExp(e,t?"g":void 0),Sg[o]=new RegExp(n,t?"g":void 0)};_("NUMERICIDENTIFIER","0|[1-9]\\d*");_("NUMERICIDENTIFIERLOOSE","\\d+");_("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${ec}*`);_("MAINVERSION",`(${T[y.NUMERICIDENTIFIER]})\\.(${T[y.NUMERICIDENTIFIER]})\\.(${T[y.NUMERICIDENTIFIER]})`);_("MAINVERSIONLOOSE",`(${T[y.NUMERICIDENTIFIERLOOSE]})\\.(${T[y.NUMERICIDENTIFIERLOOSE]})\\.(${T[y.NUMERICIDENTIFIERLOOSE]})`);_("PRERELEASEIDENTIFIER",`(?:${T[y.NUMERICIDENTIFIER]}|${T[y.NONNUMERICIDENTIFIER]})`);_("PRERELEASEIDENTIFIERLOOSE",`(?:${T[y.NUMERICIDENTIFIERLOOSE]}|${T[y.NONNUMERICIDENTIFIER]})`);_("PRERELEASE",`(?:-(${T[y.PRERELEASEIDENTIFIER]}(?:\\.${T[y.PRERELEASEIDENTIFIER]})*))`);_("PRERELEASELOOSE",`(?:-?(${T[y.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${T[y.PRERELEASEIDENTIFIERLOOSE]})*))`);_("BUILDIDENTIFIER",`${ec}+`);_("BUILD",`(?:\\+(${T[y.BUILDIDENTIFIER]}(?:\\.${T[y.BUILDIDENTIFIER]})*))`);_("FULLPLAIN",`v?${T[y.MAINVERSION]}${T[y.PRERELEASE]}?${T[y.BUILD]}?`);_("FULL",`^${T[y.FULLPLAIN]}$`);_("LOOSEPLAIN",`[v=\\s]*${T[y.MAINVERSIONLOOSE]}${T[y.PRERELEASELOOSE]}?${T[y.BUILD]}?`);_("LOOSE",`^${T[y.LOOSEPLAIN]}$`);_("GTLT","((?:<|>)?=?)");_("XRANGEIDENTIFIERLOOSE",`${T[y.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);_("XRANGEIDENTIFIER",`${T[y.NUMERICIDENTIFIER]}|x|X|\\*`);_("XRANGEPLAIN",`[v=\\s]*(${T[y.XRANGEIDENTIFIER]})(?:\\.(${T[y.XRANGEIDENTIFIER]})(?:\\.(${T[y.XRANGEIDENTIFIER]})(?:${T[y.PRERELEASE]})?${T[y.BUILD]}?)?)?`);_("XRANGEPLAINLOOSE",`[v=\\s]*(${T[y.XRANGEIDENTIFIERLOOSE]})(?:\\.(${T[y.XRANGEIDENTIFIERLOOSE]})(?:\\.(${T[y.XRANGEIDENTIFIERLOOSE]})(?:${T[y.PRERELEASELOOSE]})?${T[y.BUILD]}?)?)?`);_("XRANGE",`^${T[y.GTLT]}\\s*${T[y.XRANGEPLAIN]}$`);_("XRANGELOOSE",`^${T[y.GTLT]}\\s*${T[y.XRANGEPLAINLOOSE]}$`);_("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Za}})(?:\\.(\\d{1,${Za}}))?(?:\\.(\\d{1,${Za}}))?`);_("COERCE",`${T[y.COERCEPLAIN]}(?:$|[^\\d])`);_("COERCEFULL",T[y.COERCEPLAIN]+`(?:${T[y.PRERELEASE]})?(?:${T[y.BUILD]})?(?:$|[^\\d])`);_("COERCERTL",T[y.COERCE],!0);_("COERCERTLFULL",T[y.COERCEFULL],!0);_("LONETILDE","(?:~>?)");_("TILDETRIM",`(\\s*)${T[y.LONETILDE]}\\s+`,!0);je.tildeTrimReplace="$1~";_("TILDE",`^${T[y.LONETILDE]}${T[y.XRANGEPLAIN]}$`);_("TILDELOOSE",`^${T[y.LONETILDE]}${T[y.XRANGEPLAINLOOSE]}$`);_("LONECARET","(?:\\^)");_("CARETTRIM",`(\\s*)${T[y.LONECARET]}\\s+`,!0);je.caretTrimReplace="$1^";_("CARET",`^${T[y.LONECARET]}${T[y.XRANGEPLAIN]}$`);_("CARETLOOSE",`^${T[y.LONECARET]}${T[y.XRANGEPLAINLOOSE]}$`);_("COMPARATORLOOSE",`^${T[y.GTLT]}\\s*(${T[y.LOOSEPLAIN]})$|^$`);_("COMPARATOR",`^${T[y.GTLT]}\\s*(${T[y.FULLPLAIN]})$|^$`);_("COMPARATORTRIM",`(\\s*)${T[y.GTLT]}\\s*(${T[y.LOOSEPLAIN]}|${T[y.XRANGEPLAIN]})`,!0);je.comparatorTrimReplace="$1$2$3";_("HYPHENRANGE",`^\\s*(${T[y.XRANGEPLAIN]})\\s+-\\s+(${T[y.XRANGEPLAIN]})\\s*$`);_("HYPHENRANGELOOSE",`^\\s*(${T[y.XRANGEPLAINLOOSE]})\\s+-\\s+(${T[y.XRANGEPLAINLOOSE]})\\s*$`);_("STAR","(<|>)?=?\\s*\\*");_("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");_("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var xi=E((fN,xl)=>{var Og=Object.freeze({loose:!0}),Ng=Object.freeze({}),vg=r=>r?typeof r!="object"?Og:r:Ng;xl.exports=vg});var tc=E((pN,Hl)=>{var Ll=/^[0-9]+$/,Ul=(r,e)=>{let t=Ll.test(r),n=Ll.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},bg=(r,e)=>Ul(e,r);Hl.exports={compareIdentifiers:Ul,rcompareIdentifiers:bg}});var ae=E((mN,Gl)=>{var Li=lo(),{MAX_LENGTH:Fl,MAX_SAFE_INTEGER:Ui}=co(),{safeRe:$l,safeSrc:Bl,t:Hi}=tn(),Mg=xi(),{compareIdentifiers:rn}=tc(),Ce=class{constructor(e,t){if(t=Mg(t),e instanceof Ce){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Fl)throw new TypeError(`version is longer than ${Fl} characters`);Li("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?$l[Hi.LOOSE]:$l[Hi.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Ui||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Ui||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Ui||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let i=+o;if(i>=0&&i<Ui)return i}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Li("SemVer.compare",this.version,this.options,e),!(e instanceof Ce)){if(typeof e=="string"&&e===this.version)return 0;e=new Ce(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Ce||(e=new Ce(e,this.options)),rn(this.major,e.major)||rn(this.minor,e.minor)||rn(this.patch,e.patch)}comparePre(e){if(e instanceof Ce||(e=new Ce(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],o=e.prerelease[t];if(Li("prerelease compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return rn(n,o)}while(++t)}compareBuild(e){e instanceof Ce||(e=new Ce(e,this.options));let t=0;do{let n=this.build[t],o=e.build[t];if(Li("build compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return rn(n,o)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let o=new RegExp(`^${this.options.loose?Bl[Hi.PRERELEASELOOSE]:Bl[Hi.PRERELEASE]}$`),i=`-${t}`.match(o);if(!i||i[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[o];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(t){let i=[t,o];n===!1&&(i=[t]),rn(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Gl.exports=Ce});var Er=E((gN,Vl)=>{var ql=ae(),Pg=(r,e,t=!1)=>{if(r instanceof ql)return r;try{return new ql(r,e)}catch(n){if(!t)return null;throw n}};Vl.exports=Pg});var jl=E((EN,Kl)=>{var Dg=Er(),xg=(r,e)=>{let t=Dg(r,e);return t?t.version:null};Kl.exports=xg});var zl=E((TN,Yl)=>{var Lg=Er(),Ug=(r,e)=>{let t=Lg(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};Yl.exports=Ug});var Xl=E((yN,Ql)=>{var Wl=ae(),Hg=(r,e,t,n,o)=>{typeof t=="string"&&(o=n,n=t,t=void 0);try{return new Wl(r instanceof Wl?r.version:r,t).inc(e,n,o).version}catch(i){return null}};Ql.exports=Hg});var eu=E((AN,Zl)=>{var Jl=Er(),Fg=(r,e)=>{let t=Jl(r,null,!0),n=Jl(e,null,!0),o=t.compare(n);if(o===0)return null;let i=o>0,s=i?t:n,a=i?n:t,c=!!s.prerelease.length;if(!!a.prerelease.length&&!c){if(!a.patch&&!a.minor)return"major";if(a.compareMain(s)===0)return a.minor&&!a.patch?"minor":"patch"}let l=c?"pre":"";return t.major!==n.major?l+"major":t.minor!==n.minor?l+"minor":t.patch!==n.patch?l+"patch":"prerelease"};Zl.exports=Fg});var ru=E((CN,tu)=>{var $g=ae(),Bg=(r,e)=>new $g(r,e).major;tu.exports=Bg});var ou=E((IN,nu)=>{var Gg=ae(),qg=(r,e)=>new Gg(r,e).minor;nu.exports=qg});var su=E((SN,iu)=>{var Vg=ae(),Kg=(r,e)=>new Vg(r,e).patch;iu.exports=Kg});var cu=E((_N,au)=>{var jg=Er(),Yg=(r,e)=>{let t=jg(r,e);return t&&t.prerelease.length?t.prerelease:null};au.exports=Yg});var be=E((RN,lu)=>{var du=ae(),zg=(r,e,t)=>new du(r,t).compare(new du(e,t));lu.exports=zg});var hu=E((kN,uu)=>{var Wg=be(),Qg=(r,e,t)=>Wg(e,r,t);uu.exports=Qg});var pu=E((wN,fu)=>{var Xg=be(),Jg=(r,e)=>Xg(r,e,!0);fu.exports=Jg});var Fi=E((ON,gu)=>{var mu=ae(),Zg=(r,e,t)=>{let n=new mu(r,t),o=new mu(e,t);return n.compare(o)||n.compareBuild(o)};gu.exports=Zg});var Tu=E((NN,Eu)=>{var eE=Fi(),tE=(r,e)=>r.sort((t,n)=>eE(t,n,e));Eu.exports=tE});var Au=E((vN,yu)=>{var rE=Fi(),nE=(r,e)=>r.sort((t,n)=>rE(n,t,e));yu.exports=nE});var uo=E((bN,Cu)=>{var oE=be(),iE=(r,e,t)=>oE(r,e,t)>0;Cu.exports=iE});var $i=E((MN,Iu)=>{var sE=be(),aE=(r,e,t)=>sE(r,e,t)<0;Iu.exports=aE});var rc=E((PN,Su)=>{var cE=be(),dE=(r,e,t)=>cE(r,e,t)===0;Su.exports=dE});var nc=E((DN,_u)=>{var lE=be(),uE=(r,e,t)=>lE(r,e,t)!==0;_u.exports=uE});var Bi=E((xN,Ru)=>{var hE=be(),fE=(r,e,t)=>hE(r,e,t)>=0;Ru.exports=fE});var Gi=E((LN,ku)=>{var pE=be(),mE=(r,e,t)=>pE(r,e,t)<=0;ku.exports=mE});var oc=E((UN,wu)=>{var gE=rc(),EE=nc(),TE=uo(),yE=Bi(),AE=$i(),CE=Gi(),IE=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return gE(r,t,n);case"!=":return EE(r,t,n);case">":return TE(r,t,n);case">=":return yE(r,t,n);case"<":return AE(r,t,n);case"<=":return CE(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};wu.exports=IE});var Nu=E((HN,Ou)=>{var SE=ae(),_E=Er(),{safeRe:qi,t:Vi}=tn(),RE=(r,e)=>{if(r instanceof SE)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?qi[Vi.COERCEFULL]:qi[Vi.COERCE]);else{let c=e.includePrerelease?qi[Vi.COERCERTLFULL]:qi[Vi.COERCERTL],d;for(;(d=c.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||d.index+d[0].length!==t.index+t[0].length)&&(t=d),c.lastIndex=d.index+d[1].length+d[2].length;c.lastIndex=-1}if(t===null)return null;let n=t[2],o=t[3]||"0",i=t[4]||"0",s=e.includePrerelease&&t[5]?`-${t[5]}`:"",a=e.includePrerelease&&t[6]?`+${t[6]}`:"";return _E(`${n}.${o}.${i}${s}${a}`,e)};Ou.exports=RE});var bu=E((FN,vu)=>{var ic=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(e,t)}return this}};vu.exports=ic});var Me=E(($N,xu)=>{var kE=/\s+/g,Tr=class{constructor(e,t){if(t=OE(t),e instanceof Tr)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Tr(e.raw,t);if(e instanceof sc)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(kE," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!Pu(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&xE(o[0])){this.set=[o];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&PE)|(this.options.loose&&DE))+":"+e,o=Mu.get(n);if(o)return o;let i=this.options.loose,s=i?ge[fe.HYPHENRANGELOOSE]:ge[fe.HYPHENRANGE];e=e.replace(s,KE(this.options.includePrerelease)),x("hyphen replace",e),e=e.replace(ge[fe.COMPARATORTRIM],vE),x("comparator trim",e),e=e.replace(ge[fe.TILDETRIM],bE),x("tilde trim",e),e=e.replace(ge[fe.CARETTRIM],ME),x("caret trim",e);let a=e.split(" ").map(u=>LE(u,this.options)).join(" ").split(/\s+/).map(u=>VE(u,this.options));i&&(a=a.filter(u=>(x("loose invalid filter",u,this.options),!!u.match(ge[fe.COMPARATORLOOSE])))),x("range list",a);let c=new Map,d=a.map(u=>new sc(u,this.options));for(let u of d){if(Pu(u))return[u];c.set(u.value,u)}c.size>1&&c.has("")&&c.delete("");let l=[...c.values()];return Mu.set(n,l),l}intersects(e,t){if(!(e instanceof Tr))throw new TypeError("a Range is required");return this.set.some(n=>Du(n,t)&&e.set.some(o=>Du(o,t)&&n.every(i=>o.every(s=>i.intersects(s,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new NE(e,this.options)}catch(t){return!1}for(let t=0;t<this.set.length;t++)if(jE(this.set[t],e,this.options))return!0;return!1}};xu.exports=Tr;var wE=bu(),Mu=new wE,OE=xi(),sc=ho(),x=lo(),NE=ae(),{safeRe:ge,t:fe,comparatorTrimReplace:vE,tildeTrimReplace:bE,caretTrimReplace:ME}=tn(),{FLAG_INCLUDE_PRERELEASE:PE,FLAG_LOOSE:DE}=co(),Pu=r=>r.value==="<0.0.0-0",xE=r=>r.value==="",Du=(r,e)=>{let t=!0,n=r.slice(),o=n.pop();for(;t&&n.length;)t=n.every(i=>o.intersects(i,e)),o=n.pop();return t},LE=(r,e)=>(x("comp",r,e),r=FE(r,e),x("caret",r),r=UE(r,e),x("tildes",r),r=BE(r,e),x("xrange",r),r=qE(r,e),x("stars",r),r),pe=r=>!r||r.toLowerCase()==="x"||r==="*",UE=(r,e)=>r.trim().split(/\s+/).map(t=>HE(t,e)).join(" "),HE=(r,e)=>{let t=e.loose?ge[fe.TILDELOOSE]:ge[fe.TILDE];return r.replace(t,(n,o,i,s,a)=>{x("tilde",r,n,o,i,s,a);let c;return pe(o)?c="":pe(i)?c=`>=${o}.0.0 <${+o+1}.0.0-0`:pe(s)?c=`>=${o}.${i}.0 <${o}.${+i+1}.0-0`:a?(x("replaceTilde pr",a),c=`>=${o}.${i}.${s}-${a} <${o}.${+i+1}.0-0`):c=`>=${o}.${i}.${s} <${o}.${+i+1}.0-0`,x("tilde return",c),c})},FE=(r,e)=>r.trim().split(/\s+/).map(t=>$E(t,e)).join(" "),$E=(r,e)=>{x("caret",r,e);let t=e.loose?ge[fe.CARETLOOSE]:ge[fe.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(o,i,s,a,c)=>{x("caret",r,o,i,s,a,c);let d;return pe(i)?d="":pe(s)?d=`>=${i}.0.0${n} <${+i+1}.0.0-0`:pe(a)?i==="0"?d=`>=${i}.${s}.0${n} <${i}.${+s+1}.0-0`:d=`>=${i}.${s}.0${n} <${+i+1}.0.0-0`:c?(x("replaceCaret pr",c),i==="0"?s==="0"?d=`>=${i}.${s}.${a}-${c} <${i}.${s}.${+a+1}-0`:d=`>=${i}.${s}.${a}-${c} <${i}.${+s+1}.0-0`:d=`>=${i}.${s}.${a}-${c} <${+i+1}.0.0-0`):(x("no pr"),i==="0"?s==="0"?d=`>=${i}.${s}.${a}${n} <${i}.${s}.${+a+1}-0`:d=`>=${i}.${s}.${a}${n} <${i}.${+s+1}.0-0`:d=`>=${i}.${s}.${a} <${+i+1}.0.0-0`),x("caret return",d),d})},BE=(r,e)=>(x("replaceXRanges",r,e),r.split(/\s+/).map(t=>GE(t,e)).join(" ")),GE=(r,e)=>{r=r.trim();let t=e.loose?ge[fe.XRANGELOOSE]:ge[fe.XRANGE];return r.replace(t,(n,o,i,s,a,c)=>{x("xRange",r,n,o,i,s,a,c);let d=pe(i),l=d||pe(s),u=l||pe(a),g=u;return o==="="&&g&&(o=""),c=e.includePrerelease?"-0":"",d?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&g?(l&&(s=0),a=0,o===">"?(o=">=",l?(i=+i+1,s=0,a=0):(s=+s+1,a=0)):o==="<="&&(o="<",l?i=+i+1:s=+s+1),o==="<"&&(c="-0"),n=`${o+i}.${s}.${a}${c}`):l?n=`>=${i}.0.0${c} <${+i+1}.0.0-0`:u&&(n=`>=${i}.${s}.0${c} <${i}.${+s+1}.0-0`),x("xRange return",n),n})},qE=(r,e)=>(x("replaceStars",r,e),r.trim().replace(ge[fe.STAR],"")),VE=(r,e)=>(x("replaceGTE0",r,e),r.trim().replace(ge[e.includePrerelease?fe.GTE0PRE:fe.GTE0],"")),KE=r=>(e,t,n,o,i,s,a,c,d,l,u,g)=>(pe(n)?t="":pe(o)?t=`>=${n}.0.0${r?"-0":""}`:pe(i)?t=`>=${n}.${o}.0${r?"-0":""}`:s?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,pe(d)?c="":pe(l)?c=`<${+d+1}.0.0-0`:pe(u)?c=`<${d}.${+l+1}.0-0`:g?c=`<=${d}.${l}.${u}-${g}`:r?c=`<${d}.${l}.${+u+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),jE=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(x(r[n].semver),r[n].semver!==sc.ANY&&r[n].semver.prerelease.length>0){let o=r[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}});var ho=E((BN,Bu)=>{var fo=Symbol("SemVer ANY"),nn=class{static get ANY(){return fo}constructor(e,t){if(t=Lu(t),e instanceof nn){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),cc("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===fo?this.value="":this.value=this.operator+this.semver.version,cc("comp",this)}parse(e){let t=this.options.loose?Uu[Hu.COMPARATORLOOSE]:Uu[Hu.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Fu(n[2],this.options.loose):this.semver=fo}toString(){return this.value}test(e){if(cc("Comparator.test",e,this.options.loose),this.semver===fo||e===fo)return!0;if(typeof e=="string")try{e=new Fu(e,this.options)}catch(t){return!1}return ac(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof nn))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new $u(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new $u(this.value,t).test(e.semver):(t=Lu(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||ac(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||ac(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Bu.exports=nn;var Lu=xi(),{safeRe:Uu,t:Hu}=tn(),ac=oc(),cc=lo(),Fu=ae(),$u=Me()});var po=E((GN,Gu)=>{var YE=Me(),zE=(r,e,t)=>{try{e=new YE(e,t)}catch(n){return!1}return e.test(r)};Gu.exports=zE});var Vu=E((qN,qu)=>{var WE=Me(),QE=(r,e)=>new WE(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));qu.exports=QE});var ju=E((VN,Ku)=>{var XE=ae(),JE=Me(),ZE=(r,e,t)=>{let n=null,o=null,i=null;try{i=new JE(e,t)}catch(s){return null}return r.forEach(s=>{i.test(s)&&(!n||o.compare(s)===-1)&&(n=s,o=new XE(n,t))}),n};Ku.exports=ZE});var zu=E((KN,Yu)=>{var eT=ae(),tT=Me(),rT=(r,e,t)=>{let n=null,o=null,i=null;try{i=new tT(e,t)}catch(s){return null}return r.forEach(s=>{i.test(s)&&(!n||o.compare(s)===1)&&(n=s,o=new eT(n,t))}),n};Yu.exports=rT});var Xu=E((jN,Qu)=>{var dc=ae(),nT=Me(),Wu=uo(),oT=(r,e)=>{r=new nT(r,e);let t=new dc("0.0.0");if(r.test(t)||(t=new dc("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let o=r.set[n],i=null;o.forEach(s=>{let a=new dc(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||Wu(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),i&&(!t||Wu(t,i))&&(t=i)}return t&&r.test(t)?t:null};Qu.exports=oT});var Zu=E((YN,Ju)=>{var iT=Me(),sT=(r,e)=>{try{return new iT(r,e).range||"*"}catch(t){return null}};Ju.exports=sT});var Ki=E((zN,nh)=>{var aT=ae(),rh=ho(),{ANY:cT}=rh,dT=Me(),lT=po(),eh=uo(),th=$i(),uT=Gi(),hT=Bi(),fT=(r,e,t,n)=>{r=new aT(r,n),e=new dT(e,n);let o,i,s,a,c;switch(t){case">":o=eh,i=uT,s=th,a=">",c=">=";break;case"<":o=th,i=hT,s=eh,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(lT(r,e,n))return!1;for(let d=0;d<e.set.length;++d){let l=e.set[d],u=null,g=null;if(l.forEach(m=>{m.semver===cT&&(m=new rh(">=0.0.0")),u=u||m,g=g||m,o(m.semver,u.semver,n)?u=m:s(m.semver,g.semver,n)&&(g=m)}),u.operator===a||u.operator===c||(!g.operator||g.operator===a)&&i(r,g.semver))return!1;if(g.operator===c&&s(r,g.semver))return!1}return!0};nh.exports=fT});var ih=E((WN,oh)=>{var pT=Ki(),mT=(r,e,t)=>pT(r,e,">",t);oh.exports=mT});var ah=E((QN,sh)=>{var gT=Ki(),ET=(r,e,t)=>gT(r,e,"<",t);sh.exports=ET});var lh=E((XN,dh)=>{var ch=Me(),TT=(r,e,t)=>(r=new ch(r,t),e=new ch(e,t),r.intersects(e,t));dh.exports=TT});var hh=E((JN,uh)=>{var yT=po(),AT=be();uh.exports=(r,e,t)=>{let n=[],o=null,i=null,s=r.sort((l,u)=>AT(l,u,t));for(let l of s)yT(l,e,t)?(i=l,o||(o=l)):(i&&n.push([o,i]),i=null,o=null);o&&n.push([o,null]);let a=[];for(let[l,u]of n)l===u?a.push(l):!u&&l===s[0]?a.push("*"):u?l===s[0]?a.push(`<=${u}`):a.push(`${l} - ${u}`):a.push(`>=${l}`);let c=a.join(" || "),d=typeof e.raw=="string"?e.raw:String(e);return c.length<d.length?c:e}});var Th=E((ZN,Eh)=>{var fh=Me(),uc=ho(),{ANY:lc}=uc,mo=po(),hc=be(),CT=(r,e,t={})=>{if(r===e)return!0;r=new fh(r,t),e=new fh(e,t);let n=!1;e:for(let o of r.set){for(let i of e.set){let s=ST(o,i,t);if(n=n||s!==null,s)continue e}if(n)return!1}return!0},IT=[new uc(">=0.0.0-0")],ph=[new uc(">=0.0.0")],ST=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===lc){if(e.length===1&&e[0].semver===lc)return!0;t.includePrerelease?r=IT:r=ph}if(e.length===1&&e[0].semver===lc){if(t.includePrerelease)return!0;e=ph}let n=new Set,o,i;for(let m of r)m.operator===">"||m.operator===">="?o=mh(o,m,t):m.operator==="<"||m.operator==="<="?i=gh(i,m,t):n.add(m.semver);if(n.size>1)return null;let s;if(o&&i){if(s=hc(o.semver,i.semver,t),s>0)return null;if(s===0&&(o.operator!==">="||i.operator!=="<="))return null}for(let m of n){if(o&&!mo(m,String(o),t)||i&&!mo(m,String(i),t))return null;for(let A of e)if(!mo(m,String(A),t))return!1;return!0}let a,c,d,l,u=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,g=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1;u&&u.prerelease.length===1&&i.operator==="<"&&u.prerelease[0]===0&&(u=!1);for(let m of e){if(l=l||m.operator===">"||m.operator===">=",d=d||m.operator==="<"||m.operator==="<=",o){if(g&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===g.major&&m.semver.minor===g.minor&&m.semver.patch===g.patch&&(g=!1),m.operator===">"||m.operator===">="){if(a=mh(o,m,t),a===m&&a!==o)return!1}else if(o.operator===">="&&!mo(o.semver,String(m),t))return!1}if(i){if(u&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===u.major&&m.semver.minor===u.minor&&m.semver.patch===u.patch&&(u=!1),m.operator==="<"||m.operator==="<="){if(c=gh(i,m,t),c===m&&c!==i)return!1}else if(i.operator==="<="&&!mo(i.semver,String(m),t))return!1}if(!m.operator&&(i||o)&&s!==0)return!1}return!(o&&d&&!i&&s!==0||i&&l&&!o&&s!==0||g||u)},mh=(r,e,t)=>{if(!r)return e;let n=hc(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},gh=(r,e,t)=>{if(!r)return e;let n=hc(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};Eh.exports=CT});var ji=E((ev,Ch)=>{var fc=tn(),yh=co(),_T=ae(),Ah=tc(),RT=Er(),kT=jl(),wT=zl(),OT=Xl(),NT=eu(),vT=ru(),bT=ou(),MT=su(),PT=cu(),DT=be(),xT=hu(),LT=pu(),UT=Fi(),HT=Tu(),FT=Au(),$T=uo(),BT=$i(),GT=rc(),qT=nc(),VT=Bi(),KT=Gi(),jT=oc(),YT=Nu(),zT=ho(),WT=Me(),QT=po(),XT=Vu(),JT=ju(),ZT=zu(),ey=Xu(),ty=Zu(),ry=Ki(),ny=ih(),oy=ah(),iy=lh(),sy=hh(),ay=Th();Ch.exports={parse:RT,valid:kT,clean:wT,inc:OT,diff:NT,major:vT,minor:bT,patch:MT,prerelease:PT,compare:DT,rcompare:xT,compareLoose:LT,compareBuild:UT,sort:HT,rsort:FT,gt:$T,lt:BT,eq:GT,neq:qT,gte:VT,lte:KT,cmp:jT,coerce:YT,Comparator:zT,Range:WT,satisfies:QT,toComparators:XT,maxSatisfying:JT,minSatisfying:ZT,minVersion:ey,validRange:ty,outside:ry,gtr:ny,ltr:oy,intersects:iy,simplifyRange:sy,subset:ay,SemVer:_T,re:fc.re,src:fc.src,tokens:fc.t,SEMVER_SPEC_VERSION:yh.SEMVER_SPEC_VERSION,RELEASE_TYPES:yh.RELEASE_TYPES,compareIdentifiers:Ah.compareIdentifiers,rcompareIdentifiers:Ah.rcompareIdentifiers}});var Sh=E((tv,Ih)=>{var cy=ji();Ih.exports=cy.satisfies(process.version,">=15.7.0")});var Rh=E((rv,_h)=>{var dy=ji();_h.exports=dy.satisfies(process.version,">=16.9.0")});var pc=E((nv,kh)=>{var ly=Sh(),uy=Rh(),hy={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},fy={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};kh.exports=function(r,e){if(!r||!e)return;let t=e.asymmetricKeyType;if(!t)return;let n=hy[t];if(!n)throw new Error(`Unknown key type "${t}".`);if(!n.includes(r))throw new Error(`"alg" parameter for "${t}" key type must be one of: ${n.join(", ")}.`);if(ly)switch(t){case"ec":let o=e.asymmetricKeyDetails.namedCurve,i=fy[r];if(o!==i)throw new Error(`"alg" parameter "${r}" requires curve "${i}".`);break;case"rsa-pss":if(uy){let s=parseInt(r.slice(-3),10),{hashAlgorithm:a,mgf1HashAlgorithm:c,saltLength:d}=e.asymmetricKeyDetails;if(a!==`sha${s}`||c!==a)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${r}.`);if(d!==void 0&&d>s>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${r}.`)}break}}});var mc=E((ov,wh)=>{var py=ji();wh.exports=py.satisfies(process.version,"^6.12.0 || >=8.0.0")});var vh=E((iv,Nh)=>{var P=ao(),my=Qa(),Oh=Xa(),gy=Wa(),Ey=Ja(),Ty=pc(),yy=mc(),Ay=vi(),{KeyObject:Cy,createSecretKey:Iy,createPublicKey:Sy}=require("crypto"),gc=["RS256","RS384","RS512"],_y=["ES256","ES384","ES512"],Ec=["RS256","RS384","RS512"],Ry=["HS256","HS384","HS512"];yy&&(gc.splice(gc.length,0,"PS256","PS384","PS512"),Ec.splice(Ec.length,0,"PS256","PS384","PS512"));Nh.exports=function(r,e,t,n){typeof t=="function"&&!n&&(n=t,t={}),t||(t={}),t=Object.assign({},t);let o;if(n?o=n:o=function(l,u){if(l)throw l;return u},t.clockTimestamp&&typeof t.clockTimestamp!="number")return o(new P("clockTimestamp must be a number"));if(t.nonce!==void 0&&(typeof t.nonce!="string"||t.nonce.trim()===""))return o(new P("nonce must be a non-empty string"));if(t.allowInvalidAsymmetricKeyTypes!==void 0&&typeof t.allowInvalidAsymmetricKeyTypes!="boolean")return o(new P("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!r)return o(new P("jwt must be provided"));if(typeof r!="string")return o(new P("jwt must be a string"));let s=r.split(".");if(s.length!==3)return o(new P("jwt malformed"));let a;try{a=gy(r,{complete:!0})}catch(l){return o(l)}if(!a)return o(new P("invalid token"));let c=a.header,d;if(typeof e=="function"){if(!n)return o(new P("verify must be called asynchronous if secret or public key is provided as a callback"));d=e}else d=function(l,u){return u(null,e)};return d(c,function(l,u){if(l)return o(new P("error in secret or public key callback: "+l.message));let g=s[2].trim()!=="";if(!g&&u)return o(new P("jwt signature is required"));if(g&&!u)return o(new P("secret or public key must be provided"));if(!g&&!t.algorithms)return o(new P('please specify "none" in "algorithms" to verify unsigned tokens'));if(u!=null&&!(u instanceof Cy))try{u=Sy(u)}catch(C){try{u=Iy(typeof u=="string"?Buffer.from(u):u)}catch(L){return o(new P("secretOrPublicKey is not valid key material"))}}if(t.algorithms||(u.type==="secret"?t.algorithms=Ry:["rsa","rsa-pss"].includes(u.asymmetricKeyType)?t.algorithms=Ec:u.asymmetricKeyType==="ec"?t.algorithms=_y:t.algorithms=gc),t.algorithms.indexOf(a.header.alg)===-1)return o(new P("invalid algorithm"));if(c.alg.startsWith("HS")&&u.type!=="secret")return o(new P(`secretOrPublicKey must be a symmetric key when using ${c.alg}`));if(/^(?:RS|PS|ES)/.test(c.alg)&&u.type!=="public")return o(new P(`secretOrPublicKey must be an asymmetric key when using ${c.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{Ty(c.alg,u)}catch(C){return o(C)}let m;try{m=Ay.verify(r,a.header.alg,u)}catch(C){return o(C)}if(!m)return o(new P("invalid signature"));let A=a.payload;if(typeof A.nbf!="undefined"&&!t.ignoreNotBefore){if(typeof A.nbf!="number")return o(new P("invalid nbf value"));if(A.nbf>i+(t.clockTolerance||0))return o(new my("jwt not active",new Date(A.nbf*1e3)))}if(typeof A.exp!="undefined"&&!t.ignoreExpiration){if(typeof A.exp!="number")return o(new P("invalid exp value"));if(i>=A.exp+(t.clockTolerance||0))return o(new Oh("jwt expired",new Date(A.exp*1e3)))}if(t.audience){let C=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(A.aud)?A.aud:[A.aud]).some(function(V){return C.some(function(ee){return ee instanceof RegExp?ee.test(V):ee===V})}))return o(new P("jwt audience invalid. expected: "+C.join(" or ")))}if(t.issuer&&(typeof t.issuer=="string"&&A.iss!==t.issuer||Array.isArray(t.issuer)&&t.issuer.indexOf(A.iss)===-1))return o(new P("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&A.sub!==t.subject)return o(new P("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&A.jti!==t.jwtid)return o(new P("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&A.nonce!==t.nonce)return o(new P("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if(typeof A.iat!="number")return o(new P("iat required when maxAge is specified"));let C=Ey(t.maxAge,A.iat);if(typeof C=="undefined")return o(new P('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=C+(t.clockTolerance||0))return o(new Oh("maxAge exceeded",new Date(C*1e3)))}if(t.complete===!0){let C=a.signature;return o(null,{header:c,payload:A,signature:C})}return o(null,A)})}});var Lh=E((sv,xh)=>{var bh=1/0,Ph=9007199254740991,ky=17976931348623157e292,Mh=0/0,wy="[object Arguments]",Oy="[object Function]",Ny="[object GeneratorFunction]",vy="[object String]",by="[object Symbol]",My=/^\s+|\s+$/g,Py=/^[-+]0x[0-9a-f]+$/i,Dy=/^0b[01]+$/i,xy=/^0o[0-7]+$/i,Ly=/^(?:0|[1-9]\d*)$/,Uy=parseInt;function Hy(r,e){for(var t=-1,n=r?r.length:0,o=Array(n);++t<n;)o[t]=e(r[t],t,r);return o}function Fy(r,e,t,n){for(var o=r.length,i=t+(n?1:-1);n?i--:++i<o;)if(e(r[i],i,r))return i;return-1}function $y(r,e,t){if(e!==e)return Fy(r,By,t);for(var n=t-1,o=r.length;++n<o;)if(r[n]===e)return n;return-1}function By(r){return r!==r}function Gy(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}function qy(r,e){return Hy(e,function(t){return r[t]})}function Vy(r,e){return function(t){return r(e(t))}}var Yi=Object.prototype,yc=Yi.hasOwnProperty,zi=Yi.toString,Ky=Yi.propertyIsEnumerable,jy=Vy(Object.keys,Object),Yy=Math.max;function zy(r,e){var t=Dh(r)||Zy(r)?Gy(r.length,String):[],n=t.length,o=!!n;for(var i in r)(e||yc.call(r,i))&&!(o&&(i=="length"||Qy(i,n)))&&t.push(i);return t}function Wy(r){if(!Xy(r))return jy(r);var e=[];for(var t in Object(r))yc.call(r,t)&&t!="constructor"&&e.push(t);return e}function Qy(r,e){return e=e==null?Ph:e,!!e&&(typeof r=="number"||Ly.test(r))&&r>-1&&r%1==0&&r<e}function Xy(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||Yi;return r===t}function Jy(r,e,t,n){r=Ac(r)?r:dA(r),t=t&&!n?sA(t):0;var o=r.length;return t<0&&(t=Yy(o+t,0)),nA(r)?t<=o&&r.indexOf(e,t)>-1:!!o&&$y(r,e,t)>-1}function Zy(r){return eA(r)&&yc.call(r,"callee")&&(!Ky.call(r,"callee")||zi.call(r)==wy)}var Dh=Array.isArray;function Ac(r){return r!=null&&rA(r.length)&&!tA(r)}function eA(r){return Cc(r)&&Ac(r)}function tA(r){var e=Tc(r)?zi.call(r):"";return e==Oy||e==Ny}function rA(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Ph}function Tc(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function Cc(r){return!!r&&typeof r=="object"}function nA(r){return typeof r=="string"||!Dh(r)&&Cc(r)&&zi.call(r)==vy}function oA(r){return typeof r=="symbol"||Cc(r)&&zi.call(r)==by}function iA(r){if(!r)return r===0?r:0;if(r=aA(r),r===bh||r===-bh){var e=r<0?-1:1;return e*ky}return r===r?r:0}function sA(r){var e=iA(r),t=e%1;return e===e?t?e-t:e:0}function aA(r){if(typeof r=="number")return r;if(oA(r))return Mh;if(Tc(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Tc(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(My,"");var t=Dy.test(r);return t||xy.test(r)?Uy(r.slice(2),t?2:8):Py.test(r)?Mh:+r}function cA(r){return Ac(r)?zy(r):Wy(r)}function dA(r){return r?qy(r,cA(r)):[]}xh.exports=Jy});var Hh=E((av,Uh)=>{var lA="[object Boolean]",uA=Object.prototype,hA=uA.toString;function fA(r){return r===!0||r===!1||pA(r)&&hA.call(r)==lA}function pA(r){return!!r&&typeof r=="object"}Uh.exports=fA});var qh=E((cv,Gh)=>{var Fh=1/0,mA=17976931348623157e292,$h=0/0,gA="[object Symbol]",EA=/^\s+|\s+$/g,TA=/^[-+]0x[0-9a-f]+$/i,yA=/^0b[01]+$/i,AA=/^0o[0-7]+$/i,CA=parseInt,IA=Object.prototype,SA=IA.toString;function _A(r){return typeof r=="number"&&r==OA(r)}function Bh(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function RA(r){return!!r&&typeof r=="object"}function kA(r){return typeof r=="symbol"||RA(r)&&SA.call(r)==gA}function wA(r){if(!r)return r===0?r:0;if(r=NA(r),r===Fh||r===-Fh){var e=r<0?-1:1;return e*mA}return r===r?r:0}function OA(r){var e=wA(r),t=e%1;return e===e?t?e-t:e:0}function NA(r){if(typeof r=="number")return r;if(kA(r))return $h;if(Bh(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Bh(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(EA,"");var t=yA.test(r);return t||AA.test(r)?CA(r.slice(2),t?2:8):TA.test(r)?$h:+r}Gh.exports=_A});var Kh=E((dv,Vh)=>{var vA="[object Number]",bA=Object.prototype,MA=bA.toString;function PA(r){return!!r&&typeof r=="object"}function DA(r){return typeof r=="number"||PA(r)&&MA.call(r)==vA}Vh.exports=DA});var Wh=E((lv,zh)=>{var xA="[object Object]";function LA(r){var e=!1;if(r!=null&&typeof r.toString!="function")try{e=!!(r+"")}catch(t){}return e}function UA(r,e){return function(t){return r(e(t))}}var HA=Function.prototype,jh=Object.prototype,Yh=HA.toString,FA=jh.hasOwnProperty,$A=Yh.call(Object),BA=jh.toString,GA=UA(Object.getPrototypeOf,Object);function qA(r){return!!r&&typeof r=="object"}function VA(r){if(!qA(r)||BA.call(r)!=xA||LA(r))return!1;var e=GA(r);if(e===null)return!0;var t=FA.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&Yh.call(t)==$A}zh.exports=VA});var Xh=E((uv,Qh)=>{var KA="[object String]",jA=Object.prototype,YA=jA.toString,zA=Array.isArray;function WA(r){return!!r&&typeof r=="object"}function QA(r){return typeof r=="string"||!zA(r)&&WA(r)&&YA.call(r)==KA}Qh.exports=QA});var rf=E((hv,tf)=>{var XA="Expected a function",Jh=1/0,JA=17976931348623157e292,Zh=0/0,ZA="[object Symbol]",eC=/^\s+|\s+$/g,tC=/^[-+]0x[0-9a-f]+$/i,rC=/^0b[01]+$/i,nC=/^0o[0-7]+$/i,oC=parseInt,iC=Object.prototype,sC=iC.toString;function aC(r,e){var t;if(typeof e!="function")throw new TypeError(XA);return r=hC(r),function(){return--r>0&&(t=e.apply(this,arguments)),r<=1&&(e=void 0),t}}function cC(r){return aC(2,r)}function ef(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function dC(r){return!!r&&typeof r=="object"}function lC(r){return typeof r=="symbol"||dC(r)&&sC.call(r)==ZA}function uC(r){if(!r)return r===0?r:0;if(r=fC(r),r===Jh||r===-Jh){var e=r<0?-1:1;return e*JA}return r===r?r:0}function hC(r){var e=uC(r),t=e%1;return e===e?t?e-t:e:0}function fC(r){if(typeof r=="number")return r;if(lC(r))return Zh;if(ef(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=ef(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(eC,"");var t=rC.test(r);return t||nC.test(r)?oC(r.slice(2),t?2:8):tC.test(r)?Zh:+r}tf.exports=cC});var hf=E((fv,uf)=>{var nf=Ja(),pC=mc(),mC=pc(),of=vi(),gC=Lh(),Wi=Hh(),sf=qh(),Ic=Kh(),cf=Wh(),Nt=Xh(),EC=rf(),{KeyObject:TC,createSecretKey:yC,createPrivateKey:AC}=require("crypto"),df=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];pC&&df.splice(3,0,"PS256","PS384","PS512");var CC={expiresIn:{isValid:function(r){return sf(r)||Nt(r)&&r},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(r){return sf(r)||Nt(r)&&r},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(r){return Nt(r)||Array.isArray(r)},message:'"audience" must be a string or array'},algorithm:{isValid:gC.bind(null,df),message:'"algorithm" must be a valid string enum value'},header:{isValid:cf,message:'"header" must be an object'},encoding:{isValid:Nt,message:'"encoding" must be a string'},issuer:{isValid:Nt,message:'"issuer" must be a string'},subject:{isValid:Nt,message:'"subject" must be a string'},jwtid:{isValid:Nt,message:'"jwtid" must be a string'},noTimestamp:{isValid:Wi,message:'"noTimestamp" must be a boolean'},keyid:{isValid:Nt,message:'"keyid" must be a string'},mutatePayload:{isValid:Wi,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Wi,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Wi,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},IC={iat:{isValid:Ic,message:'"iat" should be a number of seconds'},exp:{isValid:Ic,message:'"exp" should be a number of seconds'},nbf:{isValid:Ic,message:'"nbf" should be a number of seconds'}};function lf(r,e,t,n){if(!cf(t))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(o){let i=r[o];if(!i){if(!e)throw new Error('"'+o+'" is not allowed in "'+n+'"');return}if(!i.isValid(t[o]))throw new Error(i.message)})}function SC(r){return lf(CC,!1,r,"options")}function _C(r){return lf(IC,!0,r,"payload")}var af={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},RC=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];uf.exports=function(r,e,t,n){typeof t=="function"?(n=t,t={}):t=t||{};let o=typeof r=="object"&&!Buffer.isBuffer(r),i=Object.assign({alg:t.algorithm||"HS256",typ:o?"JWT":void 0,kid:t.keyid},t.header);function s(d){if(n)return n(d);throw d}if(!e&&t.algorithm!=="none")return s(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof TC))try{e=AC(e)}catch(d){try{e=yC(typeof e=="string"?Buffer.from(e):e)}catch(l){return s(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&e.type!=="secret")return s(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(e.type!=="private")return s(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!t.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return s(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof r=="undefined")return s(new Error("payload is required"));if(o){try{_C(r)}catch(d){return s(d)}t.mutatePayload||(r=Object.assign({},r))}else{let d=RC.filter(function(l){return typeof t[l]!="undefined"});if(d.length>0)return s(new Error("invalid "+d.join(",")+" option for "+typeof r+" payload"))}if(typeof r.exp!="undefined"&&typeof t.expiresIn!="undefined")return s(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof r.nbf!="undefined"&&typeof t.notBefore!="undefined")return s(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{SC(t)}catch(d){return s(d)}if(!t.allowInvalidAsymmetricKeyTypes)try{mC(i.alg,e)}catch(d){return s(d)}let a=r.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete r.iat:o&&(r.iat=a),typeof t.notBefore!="undefined"){try{r.nbf=nf(t.notBefore,a)}catch(d){return s(d)}if(typeof r.nbf=="undefined")return s(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof t.expiresIn!="undefined"&&typeof r=="object"){try{r.exp=nf(t.expiresIn,a)}catch(d){return s(d)}if(typeof r.exp=="undefined")return s(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(af).forEach(function(d){let l=af[d];if(typeof t[d]!="undefined"){if(typeof r[l]!="undefined")return s(new Error('Bad "options.'+d+'" option. The payload already has an "'+l+'" property.'));r[l]=t[d]}});let c=t.encoding||"utf8";if(typeof n=="function")n=n&&EC(n),of.createSign({header:i,privateKey:e,payload:r,encoding:c}).once("error",n).once("done",function(d){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&d.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,d)});else{let d=of.sign({header:i,payload:r,secret:e,encoding:c});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&d.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return d}}});var pf=E((pv,ff)=>{ff.exports={decode:Wa(),verify:vh(),sign:hf(),JsonWebTokenError:ao(),NotBeforeError:Qa(),TokenExpiredError:Xa()}});var Tf=E(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.CallbacksRegistry=void 0;var Rc=class{constructor(){this.nextId=0,this.callbacks={},this.callbackIds=new WeakMap,this.locationInfo=new WeakMap}add(e){let t=this.callbackIds.get(e);if(t!=null)return t;t=this.nextId+=1,this.callbacks[t]=e,this.callbackIds.set(e,t);let n=/at (.*)/gi,o=new Error().stack;if(!o)return t;let i,s;for(;(s=n.exec(o))!==null;){let a=s[1];if(a.includes("(native)")||a.includes("(<anonymous>)")||a.includes("callbacks-registry.js")||a.includes("remote.js")||a.includes("@electron/remote/dist"))continue;let c=/([^/^)]*)\)?$/gi.exec(a);c&&(i=c[1]);break}return this.locationInfo.set(e,i),t}get(e){return this.callbacks[e]||function(){}}getLocation(e){return this.locationInfo.get(e)}apply(e,...t){return this.get(e).apply(global,...t)}remove(e){let t=this.callbacks[e];t&&(this.callbackIds.delete(t),delete this.callbacks[e])}};es.CallbacksRegistry=Rc});var Af=E(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.deserialize=Ye.serialize=Ye.isSerializableObject=Ye.isPromise=void 0;var bC=require("electron");function MC(r){return r&&r.then&&r.then instanceof Function&&r.constructor&&r.constructor.reject&&r.constructor.reject instanceof Function&&r.constructor.resolve&&r.constructor.resolve instanceof Function}Ye.isPromise=MC;var PC=[Boolean,Number,String,Date,Error,RegExp,ArrayBuffer];function Oc(r){return r===null||ArrayBuffer.isView(r)||PC.some(e=>r instanceof e)}Ye.isSerializableObject=Oc;var yf=function(r,e){let n=Object.entries(r).map(([o,i])=>[o,e(i)]);return Object.fromEntries(n)};function DC(r){let e=[],t=r.getScaleFactors();if(t.length===1){let n=t[0],o=r.getSize(n),i=r.toBitmap({scaleFactor:n});e.push({scaleFactor:n,size:o,buffer:i})}else for(let n of t){let o=r.getSize(n),i=r.toDataURL({scaleFactor:n});e.push({scaleFactor:n,size:o,dataURL:i})}return{__ELECTRON_SERIALIZED_NativeImage__:!0,representations:e}}function xC(r){let e=bC.nativeImage.createEmpty();if(r.representations.length===1){let{buffer:t,size:n,scaleFactor:o}=r.representations[0],{width:i,height:s}=n;e.addRepresentation({buffer:t,scaleFactor:o,width:i,height:s})}else for(let t of r.representations){let{dataURL:n,size:o,scaleFactor:i}=t,{width:s,height:a}=o;e.addRepresentation({dataURL:n,scaleFactor:i,width:s,height:a})}return e}function kc(r){return r&&r.constructor&&r.constructor.name==="NativeImage"?DC(r):Array.isArray(r)?r.map(kc):Oc(r)?r:r instanceof Object?yf(r,kc):r}Ye.serialize=kc;function wc(r){return r&&r.__ELECTRON_SERIALIZED_NativeImage__?xC(r):Array.isArray(r)?r.map(wc):Oc(r)?r:r instanceof Object?yf(r,wc):r}Ye.deserialize=wc});var Nc=E(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.getElectronBinding=void 0;var LC=r=>process._linkedBinding?process._linkedBinding("electron_common_"+r):process.electronBinding?process.electronBinding(r):null;ts.getElectronBinding=LC});var Cf=E(dt=>{"use strict";var vc,bc;Object.defineProperty(dt,"__esModule",{value:!0});dt.browserModuleNames=dt.commonModuleNames=void 0;var UC=Nc();dt.commonModuleNames=["clipboard","nativeImage","shell"];dt.browserModuleNames=["app","autoUpdater","BaseWindow","BrowserView","BrowserWindow","contentTracing","crashReporter","dialog","globalShortcut","ipcMain","inAppPurchase","Menu","MenuItem","nativeTheme","net","netLog","MessageChannelMain","Notification","powerMonitor","powerSaveBlocker","protocol","pushNotifications","safeStorage","screen","session","ShareMenu","systemPreferences","TopLevelWindow","TouchBar","Tray","utilityProcess","View","webContents","WebContentsView","webFrameMain"].concat(dt.commonModuleNames);var bt=UC.getElectronBinding("features");((vc=bt==null?void 0:bt.isDesktopCapturerEnabled)===null||vc===void 0?void 0:vc.call(bt))!==!1&&dt.browserModuleNames.push("desktopCapturer");((bc=bt==null?void 0:bt.isViewApiEnabled)===null||bc===void 0?void 0:bc.call(bt))!==!1&&dt.browserModuleNames.push("ImageView")});var wf=E(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.createFunctionWithReturnValue=oe.getGlobal=oe.getCurrentWebContents=oe.getCurrentWindow=oe.getBuiltin=void 0;var HC=Tf(),rs=Af(),Ee=require("electron"),FC=Cf(),$C=Nc(),{Promise:BC}=global,ns=new HC.CallbacksRegistry,os=new Map,GC=new FinalizationRegistry(r=>{let e=os.get(r);e!==void 0&&e.deref()===void 0&&(os.delete(r),Ee.ipcRenderer.send("REMOTE_BROWSER_DEREFERENCE",Te,r,0))}),Mc=new WeakMap,Sf=new WeakSet;function qC(r){let e=os.get(r);if(e!==void 0){let t=e.deref();if(t!==void 0)return t}}function VC(r,e){let t=new WeakRef(e);return os.set(r,t),GC.register(e,r),e}function KC(){let r=$C.getElectronBinding("v8_util");if(r)return r.getHiddenValue(global,"contextId");throw new Error("Electron >=v13.0.0-beta.6 required to support sandboxed renderers")}var Te=process.contextId||KC();process.on("exit",()=>{let r="REMOTE_BROWSER_CONTEXT_RELEASE";Ee.ipcRenderer.send(r,Te)});var _f=Symbol("is-remote-proxy");function is(r,e=new Set){let t=n=>{if(e.has(n))return{type:"value",value:null};if(n&&n.constructor&&n.constructor.name==="NativeImage")return{type:"nativeimage",value:rs.serialize(n)};if(Array.isArray(n)){e.add(n);let o={type:"array",value:is(n,e)};return e.delete(n),o}else{if(n instanceof Buffer)return{type:"buffer",value:n};if(rs.isSerializableObject(n))return{type:"value",value:n};if(typeof n=="object"){if(rs.isPromise(n))return{type:"promise",then:t(function(i,s){n.then(i,s)})};if(Mc.has(n))return{type:"remote-object",id:Mc.get(n)};let o={type:"object",name:n.constructor?n.constructor.name:"",members:[]};e.add(n);for(let i in n)o.members.push({name:i,value:t(n[i])});return e.delete(n),o}else return typeof n=="function"&&Sf.has(n)?{type:"function-with-return-value",value:t(n())}:typeof n=="function"?{type:"function",id:ns.add(n),location:ns.getLocation(n),length:n.length}:{type:"value",value:n}}};return r.map(t)}function Pc(r,e,t,n){if(Array.isArray(n))for(let o of n){if(Object.prototype.hasOwnProperty.call(e,o.name))continue;let i={enumerable:o.enumerable};if(o.type==="method"){let s=function(...c){let d;this&&this.constructor===s?d="REMOTE_BROWSER_MEMBER_CONSTRUCTOR":d="REMOTE_BROWSER_MEMBER_CALL";let l=Ee.ipcRenderer.sendSync(d,Te,t,o.name,is(c));return Ie(l)},a=jC(s,t,o.name);i.get=()=>(a.ref=r,a),i.set=c=>(a=c,c),i.configurable=!0}else o.type==="get"&&(i.get=()=>{let s="REMOTE_BROWSER_MEMBER_GET",a=Ee.ipcRenderer.sendSync(s,Te,t,o.name);return Ie(a)},o.writable&&(i.set=s=>{let a=is([s]),c="REMOTE_BROWSER_MEMBER_SET",d=Ee.ipcRenderer.sendSync(c,Te,t,o.name,a);return d!=null&&Ie(d),s}));Object.defineProperty(e,o.name,i)}}function Rf(r,e,t,n){if(n===null)return;let o={};Pc(r,o,t,n.members),Rf(r,o,t,n.proto),Object.setPrototypeOf(e,o)}function jC(r,e,t){let n=!1,o=()=>{if(n)return;n=!0;let i="REMOTE_BROWSER_MEMBER_GET",s=Ee.ipcRenderer.sendSync(i,Te,e,t);Pc(r,r,s.id,s.members)};return new Proxy(r,{set:(i,s,a)=>(s!=="ref"&&o(),i[s]=a,!0),get:(i,s)=>{if(s===_f)return!0;Object.prototype.hasOwnProperty.call(i,s)||o();let a=i[s];return s==="toString"&&typeof a=="function"?a.bind(i):a},ownKeys:i=>(o(),Object.getOwnPropertyNames(i)),getOwnPropertyDescriptor:(i,s)=>{let a=Object.getOwnPropertyDescriptor(i,s);return a||(o(),Object.getOwnPropertyDescriptor(i,s))}})}function Ie(r){if(!r)return{};if(r.type==="value")return r.value;if(r.type==="array")return r.members.map(e=>Ie(e));if(r.type==="nativeimage")return rs.deserialize(r.value);if(r.type==="buffer")return Buffer.from(r.value.buffer,r.value.byteOffset,r.value.byteLength);if(r.type==="promise")return BC.resolve({then:Ie(r.then)});if(r.type==="error")return If(r);if(r.type==="exception")throw r.value.type==="error"?If(r.value):new Error(`Unexpected value type in exception: ${r.value.type}`);{let e;if("id"in r){let t=qC(r.id);if(t!==void 0)return t}if(r.type==="function"){let t=function(...n){let o;this&&this.constructor===t?o="REMOTE_BROWSER_CONSTRUCTOR":o="REMOTE_BROWSER_FUNCTION_CALL";let i=Ee.ipcRenderer.sendSync(o,Te,r.id,is(n));return Ie(i)};e=t}else e={};return Pc(e,e,r.id,r.members),Rf(e,e,r.id,r.proto),e.constructor&&e.constructor[_f]&&Object.defineProperty(e.constructor,"name",{value:r.name}),Mc.set(e,r.id),VC(r.id,e),e}}function If(r){let e=r.value;for(let{name:t,value:n}of r.members)e[t]=Ie(n);return e}function YC(r){return typeof r.senderId=="number"}function kf(r,e){Ee.ipcRenderer.on(r,(t,n,o,...i)=>{if(YC(t)&&t.senderId!==0&&t.senderId!==void 0){console.error(`Message ${r} sent by unexpected WebContents (${t.senderId})`);return}n===Te?e(o,...i):Ee.ipcRenderer.send("REMOTE_BROWSER_WRONG_CONTEXT_ERROR",Te,n,o)})}var zC=process.argv.includes("--enable-api-filtering-logging");function an(){let r={stack:void 0};return zC&&Error.captureStackTrace(r,an),r.stack}kf("REMOTE_RENDERER_CALLBACK",(r,e)=>{ns.apply(r,Ie(e))});kf("REMOTE_RENDERER_RELEASE_CALLBACK",r=>{ns.remove(r)});oe.require=r=>{let e="REMOTE_BROWSER_REQUIRE",t=Ee.ipcRenderer.sendSync(e,Te,r,an());return Ie(t)};function WC(r){let e="REMOTE_BROWSER_GET_BUILTIN",t=Ee.ipcRenderer.sendSync(e,Te,r,an());return Ie(t)}oe.getBuiltin=WC;function QC(){let r="REMOTE_BROWSER_GET_CURRENT_WINDOW",e=Ee.ipcRenderer.sendSync(r,Te,an());return Ie(e)}oe.getCurrentWindow=QC;function XC(){let r="REMOTE_BROWSER_GET_CURRENT_WEB_CONTENTS",e=Ee.ipcRenderer.sendSync(r,Te,an());return Ie(e)}oe.getCurrentWebContents=XC;function JC(r){let e="REMOTE_BROWSER_GET_GLOBAL",t=Ee.ipcRenderer.sendSync(e,Te,r,an());return Ie(t)}oe.getGlobal=JC;Object.defineProperty(oe,"process",{enumerable:!0,get:()=>oe.getGlobal("process")});function ZC(r){let e=()=>r;return Sf.add(e),e}oe.createFunctionWithReturnValue=ZC;var eI=r=>{Object.defineProperty(oe,r,{enumerable:!0,get:()=>oe.getBuiltin(r)})};FC.browserModuleNames.forEach(eI)});var Of=E(Ar=>{"use strict";var tI=Ar&&Ar.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),rI=Ar&&Ar.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&tI(e,r,t)};Object.defineProperty(Ar,"__esModule",{value:!0});if(process.type==="browser")throw new Error('"@electron/remote" cannot be required in the browser process. Instead require("@electron/remote/main").');rI(wf(),Ar)});var vf=E((oP,Nf)=>{Nf.exports=Of()});var nI={};$e(nI,{default:()=>cs});module.exports=qf(nI);var cn=require("obsidian"),ds=Se(require("fs")),xf=Se(Kc()),Lc=Se(require("path"));var Mt=require("obsidian"),jc={selectedTaskListId:"",taskLists:[],clientId:"",clientSecret:"",redirectUrl:"http://localhost:5000"},Oo=class extends Mt.PluginSettingTab{constructor(t,n){super(t,n);this.plugin=n,this.settings=n.settings}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Microsoft To\u2011Do Settings"}),new Mt.Setting(t).setName("Client Details").setDesc("Enter the client ID and client secret of your Azure AD app.").addText(n=>n.setPlaceholder("Client ID").setValue(this.plugin.settings.clientId).onChange(async o=>{this.plugin.settings.clientId=o,await this.plugin.saveSettings()})).addText(n=>n.setPlaceholder("Client Secret").setValue(this.plugin.settings.clientSecret).onChange(async o=>{this.plugin.settings.clientSecret=o,await this.plugin.saveSettings()})),new Mt.Setting(t).setName("Redirect URL").setDesc("Enter the URL to redirect to after authentication.").addText(n=>n.setPlaceholder("http://localhost:5000").setValue(this.plugin.settings.redirectUrl).onChange(async o=>{this.plugin.settings.redirectUrl=o,await this.plugin.saveSettings()})),new Mt.Setting(t).setName("Get Task Lists").setDesc("Click to get the list of available task lists.").addButton(n=>{n.setButtonText("Get Task Lists").onClick(async()=>{await this.plugin.loadAvailableTaskLists(),this.display()})}),new Mt.Setting(t).setName("Task List").setDesc("Select the Microsoft To\u2011Do list to store your Obsidian tasks.").addDropdown(n=>{n.addOption("","Select a task list"),this.settings.taskLists.length>0?this.settings.taskLists.forEach(o=>{n.addOption(o.id,o.title)}):n.addOption("none","No task lists available"),n.setValue(this.settings.selectedTaskListId),n.onChange(async o=>{this.settings.selectedTaskListId=o,await this.plugin.saveSettings()})})}};var Yc=require("obsidian"),vo="tasks-syncer-sidebar",No=class extends Yc.ItemView{constructor(t,n){super(t);this.plugin=n}getViewType(){return vo}getDisplayText(){return"To-Do Tasks"}async onOpen(){await this.render()}async render(){let t=this.containerEl.children[1];t.empty();let n=t.createEl("button",{text:"Refresh Tasks"});n.onclick=()=>this.render(),t.createEl("h3",{text:"Tasks"});let o=await this.plugin.refreshTaskCache();if(o.size===0){t.createEl("p",{text:"No tasks found or not authenticated."});return}Array.from(o.values()).sort((i,s)=>i.status==="completed"&&s.status!=="completed"?1:i.status!=="completed"&&s.status==="completed"?-1:0).forEach(i=>{let s=t.createEl("div",{cls:"task-line"}),a=s.createEl("input",{type:"checkbox"});a.checked=i.status==="completed",a.disabled=!0,s.createEl("span",{text:i.title})})}async onClose(){}};var Ir=require("obsidian");async function bo(r,e){let t=new Map,n=await(0,Ir.requestUrl)({url:`https://graph.microsoft.com/v1.0/me/todo/lists/${r.selectedTaskListId}/tasks`,method:"GET",headers:{Authorization:`Bearer ${e}`}});if(n.status!==200)throw new Error("Failed to fetch tasks: "+n.text);let o=n.json;if(o.value&&Array.isArray(o.value))for(let i of o.value){let s=i.title.trim();t.set(s,{title:s,status:i.status,id:i.id})}return t}async function gs(r,e,t,n="notStarted"){let o=await(0,Ir.requestUrl)({url:`https://graph.microsoft.com/v1.0/me/todo/lists/${r.selectedTaskListId}/tasks`,method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({title:t,status:n})});if(o.status!==201)throw new Error(`Failed to create task: ${o.text}`)}async function Es(r,e,t,n){let o=n?"completed":"notStarted",i=await(0,Ir.requestUrl)({url:`https://graph.microsoft.com/v1.0/me/todo/lists/${r.selectedTaskListId}/tasks/${t}`,method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({status:o})});if(i.status!==200)throw new Error(`Failed to update task: ${i.text}`)}async function Ts(r){let e=await(0,Ir.requestUrl)({url:"https://graph.microsoft.com/v1.0/me/todo/lists",method:"GET",headers:{Authorization:`Bearer ${r}`}});if(e.status!==200)throw new Error("Failed to fetch task lists: "+e.text);let t=e.json,n=new Array;if(console.log("Task lists data:",t),t.value&&Array.isArray(t.value))for(let o of t.value)n.push({title:o.displayName,id:o.id});return n}async function zc(r,e,t){let n=await(0,Ir.requestUrl)({url:`https://graph.microsoft.com/v1.0/me/todo/lists/${r.selectedTaskListId}/tasks/${t}`,method:"DELETE",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(n.status!==204)throw new Error(`Failed to delete task: ${n.text}`)}var Pt=class{static serializeJSONBlob(e){return JSON.stringify(e)}static serializeAccounts(e){let t={};return Object.keys(e).map(function(n){var i;let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,realm:o.realm,local_account_id:o.localAccountId,username:o.username,authority_type:o.authorityType,name:o.name,client_info:o.clientInfo,last_modification_time:o.lastModificationTime,last_modification_app:o.lastModificationApp,tenantProfiles:(i=o.tenantProfiles)==null?void 0:i.map(s=>JSON.stringify(s))}}),t}static serializeIdTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm}}),t}static serializeAccessTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,realm:o.realm,target:o.target,cached_at:o.cachedAt,expires_on:o.expiresOn,extended_expires_on:o.extendedExpiresOn,refresh_on:o.refreshOn,key_id:o.keyId,token_type:o.tokenType,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash}}),t}static serializeRefreshTokens(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={home_account_id:o.homeAccountId,environment:o.environment,credential_type:o.credentialType,client_id:o.clientId,secret:o.secret,family_id:o.familyId,target:o.target,realm:o.realm}}),t}static serializeAppMetadata(e){let t={};return Object.keys(e).map(function(n){let o=e[n];t[n]={client_id:o.clientId,environment:o.environment,family_id:o.familyId}}),t}static serializeAllCache(e){return{Account:this.serializeAccounts(e.accounts),IdToken:this.serializeIdTokens(e.idTokens),AccessToken:this.serializeAccessTokens(e.accessTokens),RefreshToken:this.serializeRefreshTokens(e.refreshTokens),AppMetadata:this.serializeAppMetadata(e.appMetadata)}}};var f={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},M={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},Qe=[f.OPENID_SCOPE,f.PROFILE_SCOPE,f.OFFLINE_ACCESS_SCOPE],ys=[...Qe,f.EMAIL_SCOPE],D={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"};var ye={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Sr={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},lt={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Mo={PLAIN:"plain",S256:"S256"},dn={CODE:"code",IDTOKEN_TOKEN:"id_token token",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"};var ln={QUERY:"query",FRAGMENT:"fragment",FORM_POST:"form_post"},De={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},_r={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},$={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},v={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var un="appmetadata",Wc="client_info",ut="1",Rr={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},ce={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Y={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},O={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Xe={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Po={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Do={username:"username",password:"password"},hn={httpSuccess:200,httpBadRequest:400},Dt={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},xo={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},U={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"};var fn=300;var Lo="unexpected_error",Uo="post_request_failed";var Qc={[Lo]:"Unexpected error in authentication.",[Uo]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},ip={unexpectedError:{code:Lo,desc:Qc[Lo]},postRequestFailed:{code:Uo,desc:Qc[Uo]}},N=class extends Error{constructor(e,t,n){let o=t?`${e}: ${t}`:e;super(o),Object.setPrototypeOf(this,N.prototype),this.errorCode=e||f.EMPTY_STRING,this.errorMessage=t||f.EMPTY_STRING,this.subError=n||f.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};var z={};$e(z,{authTimeNotFound:()=>Je,authorizationCodeMissingFromServerResponse:()=>Wt,bindingKeyNotRemoved:()=>Qt,cannotAppendScopeSet:()=>jt,cannotRemoveEmptyScope:()=>Kt,clientInfoDecodingError:()=>ht,clientInfoEmptyError:()=>xt,deviceCodeExpired:()=>En,deviceCodePollingCancelled:()=>gn,deviceCodeUnknownError:()=>Tn,emptyInputScopeSet:()=>mt,endSessionEndpointNotSupported:()=>Xt,endpointResolutionError:()=>de,hashNotDeserialized:()=>Ft,invalidAssertion:()=>Cn,invalidCacheEnvironment:()=>et,invalidCacheRecord:()=>Yt,invalidClientCredential:()=>In,invalidState:()=>xe,keyIdMissing:()=>Jt,maxAgeTranspired:()=>Gt,methodNotImplemented:()=>k,missingTenantIdError:()=>kn,multipleMatchingAccounts:()=>mn,multipleMatchingAppMetadata:()=>qt,multipleMatchingTokens:()=>pn,nestedAppAuthBridgeDisabled:()=>wn,networkError:()=>Ut,noAccountFound:()=>yn,noAccountInSilentRequest:()=>Ze,noCryptoObject:()=>gt,noNetworkConnectivity:()=>_n,nonceMismatch:()=>Bt,nullOrEmptyToken:()=>Lt,openIdConfigError:()=>Ht,requestCannotBeMade:()=>Vt,stateMismatch:()=>$t,stateNotFound:()=>pt,tokenClaimsCnfRequiredForSignedJwt:()=>zt,tokenParsingError:()=>ft,tokenRefreshRequired:()=>tt,unexpectedCredentialType:()=>An,userCanceled:()=>Rn,userTimeoutReached:()=>Sn});var ht="client_info_decoding_error",xt="client_info_empty_error",ft="token_parsing_error",Lt="null_or_empty_token",de="endpoints_resolution_error",Ut="network_error",Ht="openid_config_error",Ft="hash_not_deserialized",xe="invalid_state",$t="state_mismatch",pt="state_not_found",Bt="nonce_mismatch",Je="auth_time_not_found",Gt="max_age_transpired",pn="multiple_matching_tokens",mn="multiple_matching_accounts",qt="multiple_matching_appMetadata",Vt="request_cannot_be_made",Kt="cannot_remove_empty_scope",jt="cannot_append_scopeset",mt="empty_input_scopeset",gn="device_code_polling_cancelled",En="device_code_expired",Tn="device_code_unknown_error",Ze="no_account_in_silent_request",Yt="invalid_cache_record",et="invalid_cache_environment",yn="no_account_found",gt="no_crypto_object",An="unexpected_credential_type",Cn="invalid_assertion",In="invalid_client_credential",tt="token_refresh_required",Sn="user_timeout_reached",zt="token_claims_cnf_required_for_signedjwt",Wt="authorization_code_missing_from_server_response",Qt="binding_key_not_removed",Xt="end_session_endpoint_not_supported",Jt="key_id_missing",_n="no_network_connectivity",Rn="user_canceled",kn="missing_tenant_id_error",k="method_not_implemented",wn="nested_app_auth_bridge_disabled";var S={[ht]:"The client info could not be parsed/decoded correctly",[xt]:"The client info was empty",[ft]:"Token cannot be parsed",[Lt]:"The token is null or empty",[de]:"Endpoints cannot be resolved",[Ut]:"Network request failed",[Ht]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Ft]:"The hash parameters could not be deserialized",[xe]:"State was not the expected format",[$t]:"State mismatch error",[pt]:"State not found",[Bt]:"Nonce mismatch error",[Je]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Gt]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[pn]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[mn]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[qt]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Vt]:"Token request cannot be made without authorization code or refresh token.",[Kt]:"Cannot remove null or empty scope from ScopeSet",[jt]:"Cannot append ScopeSet",[mt]:"Empty input ScopeSet cannot be processed",[gn]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[En]:"Device code is expired.",[Tn]:"Device code stopped polling for unknown reasons.",[Ze]:"Please pass an account object, silent flow is not supported without account information",[Yt]:"Cache record object was null or undefined.",[et]:"Invalid environment when attempting to create cache entry",[yn]:"No account found in cache for given key.",[gt]:"No crypto object detected.",[An]:"Unexpected credential type.",[Cn]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[In]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[tt]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Sn]:"User defined timeout for device code polling reached",[zt]:"Cannot generate a POP jwt if the token_claims are not populated",[Wt]:"Server response does not contain an authorization code to proceed",[Qt]:"Could not remove the credential's binding key from storage.",[Xt]:"The provided authority does not support logout",[Jt]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[_n]:"No network connectivity. Check your internet connection.",[Rn]:"User cancelled the flow.",[kn]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[k]:"This method has not been implemented",[wn]:"The nested app auth bridge is disabled"},sp={clientInfoDecodingError:{code:ht,desc:S[ht]},clientInfoEmptyError:{code:xt,desc:S[xt]},tokenParsingError:{code:ft,desc:S[ft]},nullOrEmptyToken:{code:Lt,desc:S[Lt]},endpointResolutionError:{code:de,desc:S[de]},networkError:{code:Ut,desc:S[Ut]},unableToGetOpenidConfigError:{code:Ht,desc:S[Ht]},hashNotDeserialized:{code:Ft,desc:S[Ft]},invalidStateError:{code:xe,desc:S[xe]},stateMismatchError:{code:$t,desc:S[$t]},stateNotFoundError:{code:pt,desc:S[pt]},nonceMismatchError:{code:Bt,desc:S[Bt]},authTimeNotFoundError:{code:Je,desc:S[Je]},maxAgeTranspired:{code:Gt,desc:S[Gt]},multipleMatchingTokens:{code:pn,desc:S[pn]},multipleMatchingAccounts:{code:mn,desc:S[mn]},multipleMatchingAppMetadata:{code:qt,desc:S[qt]},tokenRequestCannotBeMade:{code:Vt,desc:S[Vt]},removeEmptyScopeError:{code:Kt,desc:S[Kt]},appendScopeSetError:{code:jt,desc:S[jt]},emptyInputScopeSetError:{code:mt,desc:S[mt]},DeviceCodePollingCancelled:{code:gn,desc:S[gn]},DeviceCodeExpired:{code:En,desc:S[En]},DeviceCodeUnknownError:{code:Tn,desc:S[Tn]},NoAccountInSilentRequest:{code:Ze,desc:S[Ze]},invalidCacheRecord:{code:Yt,desc:S[Yt]},invalidCacheEnvironment:{code:et,desc:S[et]},noAccountFound:{code:yn,desc:S[yn]},noCryptoObj:{code:gt,desc:S[gt]},unexpectedCredentialType:{code:An,desc:S[An]},invalidAssertion:{code:Cn,desc:S[Cn]},invalidClientCredential:{code:In,desc:S[In]},tokenRefreshRequired:{code:tt,desc:S[tt]},userTimeoutReached:{code:Sn,desc:S[Sn]},tokenClaimsRequired:{code:zt,desc:S[zt]},noAuthorizationCodeFromServer:{code:Wt,desc:S[Wt]},bindingKeyNotRemovedError:{code:Qt,desc:S[Qt]},logoutNotSupported:{code:Xt,desc:S[Xt]},keyIdMissing:{code:Jt,desc:S[Jt]},noNetworkConnectivity:{code:_n,desc:S[_n]},userCanceledError:{code:Rn,desc:S[Rn]},missingTenantIdError:{code:kn,desc:S[kn]},nestedAppAuthBridgeDisabled:{code:wn,desc:S[wn]}},Et=class extends N{constructor(e,t){super(e,t?`${S[e]}: ${t}`:S[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Et.prototype)}};function p(r,e){return new Et(r,e)}var As={createNewGuid:()=>{throw p(k)},base64Decode:()=>{throw p(k)},base64Encode:()=>{throw p(k)},base64UrlEncode:()=>{throw p(k)},encodeKid:()=>{throw p(k)},async getPublicKeyThumbprint(){throw p(k)},async removeTokenBindingKey(){throw p(k)},async clearKeystore(){throw p(k)},async signJwt(){throw p(k)},async hashString(){throw p(k)}};var q;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace"})(q||(q={}));var _e=class{constructor(e,t,n){this.level=q.Info;let o=()=>{},i=e||_e.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:q.Info,this.correlationId=i.correlationId||f.EMPTY_STRING,this.packageName=t||f.EMPTY_STRING,this.packageVersion=n||f.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:q.Info}}clone(e,t,n){return new _e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let i=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${q[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:q.Error,containsPii:!1,correlationId:t||f.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:q.Error,containsPii:!0,correlationId:t||f.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:q.Warning,containsPii:!1,correlationId:t||f.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:q.Warning,containsPii:!0,correlationId:t||f.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:q.Info,containsPii:!1,correlationId:t||f.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:q.Info,containsPii:!0,correlationId:t||f.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:q.Verbose,containsPii:!1,correlationId:t||f.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:q.Verbose,containsPii:!0,correlationId:t||f.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:q.Trace,containsPii:!1,correlationId:t||f.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:q.Trace,containsPii:!0,correlationId:t||f.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};var Ho="@azure/msal-common",kr="15.4.0";var Zt={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};var W={};$e(W,{createAccessTokenEntity:()=>Ss,createIdTokenEntity:()=>Is,createRefreshTokenEntity:()=>_s,generateAppMetadataKey:()=>yp,generateAuthorityMetadataExpiresAt:()=>Bo,generateCredentialKey:()=>vn,isAccessTokenEntity:()=>dp,isAppMetadataEntity:()=>Ap,isAuthorityMetadataEntity:()=>Cp,isAuthorityMetadataExpired:()=>Go,isCredentialEntity:()=>$o,isIdTokenEntity:()=>lp,isRefreshTokenEntity:()=>up,isServerTelemetryEntity:()=>Ep,isThrottlingEntity:()=>Tp,updateAuthorityEndpointMetadata:()=>Or,updateCloudDiscoveryMetadata:()=>bn});var Fo={};$e(Fo,{checkMaxAge:()=>On,extractTokenClaims:()=>rt,getJWSPayload:()=>Xc});function rt(r,e){let t=Xc(r);try{let n=e(t);return JSON.parse(n)}catch(n){throw p(ft)}}function Xc(r){if(!r)throw p(Lt);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(r);if(!t||t.length<4)throw p(ft);return t[2]}function On(r,e){if(e===0||Date.now()-3e5>r+e)throw p(Gt)}var Z={};$e(Z,{delay:()=>cp,isTokenExpired:()=>wr,nowSeconds:()=>Ae,toDateFromSeconds:()=>Nn,toSecondsFromDate:()=>ap,wasClockTurnedBack:()=>Cs});function Ae(){return Math.round(new Date().getTime()/1e3)}function ap(r){return r.getTime()/1e3}function Nn(r){return r?new Date(Number(r)*1e3):new Date}function wr(r,e){let t=Number(r)||0;return Ae()+e>t}function Cs(r){return Number(r)>Ae()}function cp(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}function vn(r){return[hp(r),fp(r),pp(r),mp(r),gp(r)].join($.CACHE_KEY_SEPARATOR).toLowerCase()}function Is(r,e,t,n,o){return{credentialType:v.ID_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t,realm:o}}function Ss(r,e,t,n,o,i,s,a,c,d,l,u,g,m,A){var L,K;let C={homeAccountId:r,credentialType:v.ACCESS_TOKEN,secret:t,cachedAt:Ae().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:n,realm:o,target:i,tokenType:l||O.BEARER};if(u&&(C.userAssertionHash=u),d&&(C.refreshOn=d.toString()),m&&(C.requestedClaims=m,C.requestedClaimsHash=A),((L=C.tokenType)==null?void 0:L.toLowerCase())!==O.BEARER.toLowerCase())switch(C.credentialType=v.ACCESS_TOKEN_WITH_AUTH_SCHEME,C.tokenType){case O.POP:let V=rt(t,c);if(!((K=V==null?void 0:V.cnf)!=null&&K.kid))throw p(zt);C.keyId=V.cnf.kid;break;case O.SSH:C.keyId=g}return C}function _s(r,e,t,n,o,i,s){let a={credentialType:v.REFRESH_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t};return i&&(a.userAssertionHash=i),o&&(a.familyId=o),s&&(a.expiresOn=s.toString()),a}function $o(r){return r.hasOwnProperty("homeAccountId")&&r.hasOwnProperty("environment")&&r.hasOwnProperty("credentialType")&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("secret")}function dp(r){return r?$o(r)&&r.hasOwnProperty("realm")&&r.hasOwnProperty("target")&&(r.credentialType===v.ACCESS_TOKEN||r.credentialType===v.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function lp(r){return r?$o(r)&&r.hasOwnProperty("realm")&&r.credentialType===v.ID_TOKEN:!1}function up(r){return r?$o(r)&&r.credentialType===v.REFRESH_TOKEN:!1}function hp(r){return[r.homeAccountId,r.environment].join($.CACHE_KEY_SEPARATOR).toLowerCase()}function fp(r){let e=r.credentialType===v.REFRESH_TOKEN&&r.familyId||r.clientId;return[r.credentialType,e,r.realm||""].join($.CACHE_KEY_SEPARATOR).toLowerCase()}function pp(r){return(r.target||"").toLowerCase()}function mp(r){return(r.requestedClaimsHash||"").toLowerCase()}function gp(r){return r.tokenType&&r.tokenType.toLowerCase()!==O.BEARER.toLowerCase()?r.tokenType.toLowerCase():""}function Ep(r,e){let t=r.indexOf(Y.CACHE_KEY)===0,n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&n}function Tp(r,e){let t=!1;r&&(t=r.indexOf(Xe.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),t&&n}function yp({environment:r,clientId:e}){return[un,r,e].join($.CACHE_KEY_SEPARATOR).toLowerCase()}function Ap(r,e){return e?r.indexOf(un)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function Cp(r,e){return e?r.indexOf(Rr.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function Bo(){return Ae()+Rr.REFRESH_TIME_SECONDS}function Or(r,e,t){r.authorization_endpoint=e.authorization_endpoint,r.token_endpoint=e.token_endpoint,r.end_session_endpoint=e.end_session_endpoint,r.issuer=e.issuer,r.endpointsFromNetwork=t,r.jwks_uri=e.jwks_uri}function bn(r,e,t){r.aliases=e.aliases,r.preferred_cache=e.preferred_cache,r.preferred_network=e.preferred_network,r.aliasesFromNetwork=t}function Go(r){return r.expiresAt<=Ae()}var Nr="redirect_uri_empty",qo="claims_request_parsing_error",vr="authority_uri_insecure",nt="url_parse_error",br="empty_url_error",Mr="empty_input_scopes_error",Pr="invalid_prompt_value",ot="invalid_claims",Dr="token_request_empty",xr="logout_request_empty",Lr="invalid_code_challenge_method",Tt="pkce_params_missing",er="invalid_cloud_discovery_metadata",Ur="invalid_authority_metadata",Hr="untrusted_authority",yt="missing_ssh_jwk",Vo="missing_ssh_kid",Ko="missing_nonce_authentication_header",jo="invalid_authentication_header",Yo="cannot_set_OIDCOptions",zo="cannot_allow_platform_broker",Wo="authority_mismatch";var F={[Nr]:"A redirect URI is required for all calls, and none has been set.",[qo]:"Could not parse the given claims request object.",[vr]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[nt]:"URL could not be parsed into appropriate segments.",[br]:"URL was empty or null.",[Mr]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Pr]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[ot]:"Given claims parameter must be a stringified JSON object.",[Dr]:"Token request was empty and not found in cache.",[xr]:"The logout request was null or undefined.",[Lr]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Tt]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[er]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Ur]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Hr]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[yt]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Vo]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Ko]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[jo]:"Invalid authentication header provided",[Yo]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[zo]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Wo]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},HI={redirectUriNotSet:{code:Nr,desc:F[Nr]},claimsRequestParsingError:{code:qo,desc:F[qo]},authorityUriInsecure:{code:vr,desc:F[vr]},urlParseError:{code:nt,desc:F[nt]},urlEmptyError:{code:br,desc:F[br]},emptyScopesError:{code:Mr,desc:F[Mr]},invalidPrompt:{code:Pr,desc:F[Pr]},invalidClaimsRequest:{code:ot,desc:F[ot]},tokenRequestEmptyError:{code:Dr,desc:F[Dr]},logoutRequestEmptyError:{code:xr,desc:F[xr]},invalidCodeChallengeMethod:{code:Lr,desc:F[Lr]},invalidCodeChallengeParams:{code:Tt,desc:F[Tt]},invalidCloudDiscoveryMetadata:{code:er,desc:F[er]},invalidAuthorityMetadata:{code:Ur,desc:F[Ur]},untrustedAuthority:{code:Hr,desc:F[Hr]},missingSshJwk:{code:yt,desc:F[yt]},missingSshKid:{code:Vo,desc:F[Vo]},missingNonceAuthenticationHeader:{code:Ko,desc:F[Ko]},invalidAuthenticationHeader:{code:jo,desc:F[jo]},cannotSetOIDCOptions:{code:Yo,desc:F[Yo]},cannotAllowPlatformBroker:{code:zo,desc:F[zo]},authorityMismatch:{code:Wo,desc:F[Wo]}},Mn=class extends N{constructor(e){super(e,F[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Mn.prototype)}};function b(r){return new Mn(r)}var B=class{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return Object.keys(t).length===0}catch(t){}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},n=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return n.forEach(i=>{if(i.trim()){let[s,a]=i.split(/=(.+)/g,2);s&&a&&(t[o(s)]=o(a))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(t){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}};var H=class{constructor(e){let t=e?B.trimArrayEntries([...e]):[],n=t?B.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw b(Mr);this.scopes=new Set,n.forEach(o=>this.scopes.add(o))}static fromString(e){let n=(e||f.EMPTY_STRING).split(" ");return new H(n)}static createSearchScopes(e){let t=new H(e);return t.containsOnlyOIDCScopes()?t.removeScope(f.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){let t=this.printScopesLowerCase().split(" "),n=new H(t);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return ys.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch(t){throw p(jt)}}removeScope(e){if(!e)throw p(Kt);this.scopes.delete(e.trim())}removeOIDCScopes(){ys.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw p(mt);let t=new Set;return e.scopes.forEach(n=>t.add(n.toLowerCase())),this.scopes.forEach(n=>t.add(n.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw p(mt);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),n=e.getScopeCount(),o=this.getScopeCount();return t.size<o+n}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):f.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};function Fr(r,e){if(!r)throw p(xt);try{let t=e(r);return JSON.parse(t)}catch(t){throw p(ht)}}function Be(r){if(!r)throw p(ht);let e=r.split($.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?f.EMPTY_STRING:e[1]}}function Jc(r,e){return!!r&&!!e&&r===e.split(".")[1]}function Pn(r,e,t,n){if(n){let{oid:o,sub:i,tid:s,name:a,tfp:c,acr:d}=n,l=s||c||d||"";return{tenantId:l,localAccountId:o||i||"",name:a,isHomeTenant:Jc(l,r)}}else return{tenantId:t,localAccountId:e,isHomeTenant:Jc(t,r)}}function Qo(r,e,t,n){let o=r;if(e){let{isHomeTenant:i,...s}=e;o={...r,...s}}if(t){let{isHomeTenant:i,...s}=Pn(r.homeAccountId,r.localAccountId,r.tenantId,t);return o={...o,...s,idTokenClaims:t,idToken:n},o}return o}var Re={Default:0,Adfs:1,Dsts:2,Ciam:3};function Xo(r){return r&&(r.tid||r.tfp||r.acr)||null}var ke={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};var Q=class{generateAccountId(){return[this.homeAccountId,this.environment].join($.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Q.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join($.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){var d,l,u,g,m,A;let o=new Q;t.authorityType===Re.Adfs?o.authorityType=_r.ADFS_ACCOUNT_TYPE:t.protocolMode===ke.OIDC?o.authorityType=_r.GENERIC_ACCOUNT_TYPE:o.authorityType=_r.MSSTS_ACCOUNT_TYPE;let i;e.clientInfo&&n&&(i=Fr(e.clientInfo,n)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;let s=e.environment||t&&t.getPreferredCache();if(!s)throw p(et);o.environment=s,o.realm=(i==null?void 0:i.utid)||Xo(e.idTokenClaims)||"",o.localAccountId=(i==null?void 0:i.uid)||((d=e.idTokenClaims)==null?void 0:d.oid)||((l=e.idTokenClaims)==null?void 0:l.sub)||"";let a=((u=e.idTokenClaims)==null?void 0:u.preferred_username)||((g=e.idTokenClaims)==null?void 0:g.upn),c=(m=e.idTokenClaims)!=null&&m.emails?e.idTokenClaims.emails[0]:null;if(o.username=a||c||"",o.name=((A=e.idTokenClaims)==null?void 0:A.name)||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{let C=Pn(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[C]}return o}static createFromAccountInfo(e,t,n){var i;let o=new Q;return o.authorityType=e.authorityType||_r.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=t,o.msGraphHost=n,o.tenantProfiles=Array.from(((i=e.tenantProfiles)==null?void 0:i.values())||[]),o}static generateHomeAccountId(e,t,n,o,i){if(!(t===Re.Adfs||t===Re.Dsts)){if(e)try{let s=Fr(e,o.base64Decode);if(s.uid&&s.utid)return`${s.uid}.${s.utid}`}catch(s){}n.warning("No client info in response")}return(i==null?void 0:i.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let o=!0;if(n){let i=e.idTokenClaims||{},s=t.idTokenClaims||{};o=i.iat===s.iat&&i.nonce===s.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o}};var At={};$e(At,{getDeserializedResponse:()=>Rs,mapToQueryString:()=>Ge,stripLeadingHashOrQuery:()=>Zc});function Zc(r){return r.startsWith("#/")?r.substring(2):r.startsWith("#")||r.startsWith("?")?r.substring(1):r}function Rs(r){if(!r||r.indexOf("=")<0)return null;try{let e=Zc(r),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.ear_jwe||t.error||t.error_description||t.state)return t}catch(e){throw p(Ft)}return null}function Ge(r){let e=new Array;return r.forEach((t,n)=>{e.push(`${n}=${encodeURIComponent(t)}`)}),e.join("&")}var R=class{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw b(br);e.includes("#")||(this._urlString=R.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return B.endsWith(t,"?")?t=t.slice(0,-1):B.endsWith(t,"?/")&&(t=t.slice(0,-2)),B.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(t){throw b(nt)}if(!e.HostNameAndPort||!e.PathSegments)throw b(nt);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw b(vr)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return R.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),n=t.PathSegments;return e&&n.length!==0&&(n[0]===ye.COMMON||n[0]===ye.ORGANIZATIONS)&&(n[0]=e),R.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw b(nt);let n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=n.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),n.PathSegments=o,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw b(nt);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===f.FORWARD_SLASH){let o=new R(t).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new R(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Rs(e)}};var td={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},ks=td.endpointMetadata,ws=td.instanceDiscoveryMetadata,Os=new Set;ws.metadata.forEach(r=>{r.aliases.forEach(e=>{Os.add(e)})});function rd(r,e){var o;let t,n=r.canonicalAuthority;if(n){let i=new R(n).getUrlComponents().HostNameAndPort;t=ed(i,(o=r.cloudDiscoveryMetadata)==null?void 0:o.metadata,ce.CONFIG,e)||ed(i,ws.metadata,ce.HARDCODED_VALUES,e)||r.knownAuthorities}return t||[]}function ed(r,e,t,n){if(n==null||n.trace(`getAliasesFromMetadata called with source: ${t}`),r&&e){let o=Dn(e,r);if(o)return n==null||n.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),o.aliases;n==null||n.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function nd(r){return Dn(ws.metadata,r)}function Dn(r,e){for(let t=0;t<r.length;t++){let n=r[t];if(n.aliases.includes(e))return n}return null}var Jo="cache_quota_exceeded",xn="cache_error_unknown";var Ns={[Jo]:"Exceeded cache storage capacity.",[xn]:"Unexpected error occurred when using cache storage."},Ct=class extends Error{constructor(e,t){let n=t||(Ns[e]?Ns[e]:Ns[xn]);super(`${e}: ${n}`),Object.setPrototypeOf(this,Ct.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}};var It=class{constructor(e,t,n,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(Ho,kr),this.staticAuthorityOptions=o}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){let t=this.getAllAccounts(e);return t.length>1?t.sort(o=>o.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){let t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(n=>this.getTenantProfilesFromAccountEntity(n,t==null?void 0:t.tenantId,t))}getTenantedAccountInfoByFilter(e,t,n,o){let i=null,s;if(o&&!this.tenantProfileMatchesFilter(n,o))return null;let a=this.getIdToken(e,t,n.tenantId);return a&&(s=rt(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,o))?null:(i=Qo(e,n,s,a==null?void 0:a.secret),i)}getTenantProfilesFromAccountEntity(e,t,n){let o=e.getAccountInfo(),i=o.tenantProfiles||new Map,s=this.getTokenKeys();if(t){let c=i.get(t);if(c)i=new Map([[t,c]]);else return[]}let a=[];return i.forEach(c=>{let d=this.getTenantedAccountInfoByFilter(o,s,c,n);d&&a.push(d)}),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,n){var o,i,s,a;if(!e)throw p(Yt);try{e.account&&await this.setAccount(e.account,t),e.idToken&&(n==null?void 0:n.idToken)!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&(n==null?void 0:n.accessToken)!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&(n==null?void 0:n.refreshToken)!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(c){throw(o=this.commonLogger)==null||o.error("CacheManager.saveCacheRecord: failed"),c instanceof Error?((i=this.commonLogger)==null||i.errorPii(`CacheManager.saveCacheRecord: ${c.message}`,t),c.name==="QuotaExceededError"||c.name==="NS_ERROR_DOM_QUOTA_REACHED"||c.message.includes("exceeded the quota")?((s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new Ct(Jo)):new Ct(c.name,c.message)):((a=this.commonLogger)==null||a.errorPii(`CacheManager.saveCacheRecord: ${c}`,t),new Ct(xn))}}async saveAccessToken(e,t){let n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},o=this.getTokenKeys(),i=H.fromString(e.target),s=[];o.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,n,!1))return;let c=this.getAccessTokenCredential(a);c&&this.credentialMatchesFilter(c,n)&&H.fromString(c.target).intersectingScopeSets(i)&&s.push(this.removeAccessToken(a))}),await Promise.all(s),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){let t=this.getAccountKeys(),n=[];return t.forEach(o=>{var c;if(!this.isAccountKey(o,e.homeAccountId))return;let i=this.getAccount(o,this.commonLogger);if(!i||e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId)||e.username&&!this.matchUsername(i.username,e.username)||e.environment&&!this.matchEnvironment(i,e.environment)||e.realm&&!this.matchRealm(i,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;let s={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},a=(c=i.tenantProfiles)==null?void 0:c.filter(d=>this.tenantProfileMatchesFilter(d,s));a&&a.length===0||n.push(i)}),n}isAccountKey(e,t,n){return!(e.split($.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split($.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(t.indexOf(v.ID_TOKEN.toLowerCase())===-1&&t.indexOf(v.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(v.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(v.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(v.REFRESH_TOKEN.toLowerCase())>-1){let n=`${v.REFRESH_TOKEN}${$.CACHE_KEY_SEPARATOR}${this.clientId}${$.CACHE_KEY_SEPARATOR}`,o=`${v.REFRESH_TOKEN}${$.CACHE_KEY_SEPARATOR}${ut}${$.CACHE_KEY_SEPARATOR}`;if(t.indexOf(n.toLowerCase())===-1&&t.indexOf(o.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===v.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===O.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),n={};return t.forEach(o=>{if(!this.isAppMetadata(o))return;let i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(n[o]=i))}),n}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),n=null;return t.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;let i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(n=i)}),n}async removeAllAccounts(){let e=this.getAccountKeys(),t=[];e.forEach(n=>{t.push(this.removeAccount(n))}),await Promise.all(t)}async removeAccount(e){let t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){let t=this.getTokenKeys(),n=e.generateAccountId(),o=[];t.idToken.forEach(i=>{i.indexOf(n)===0&&this.removeIdToken(i)}),t.accessToken.forEach(i=>{i.indexOf(n)===0&&o.push(this.removeAccessToken(i))}),t.refreshToken.forEach(i=>{i.indexOf(n)===0&&this.removeRefreshToken(i)}),await Promise.all(o)}async removeAccessToken(e){let t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===v.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===O.POP){let o=t.keyId;if(o)try{await this.cryptoImpl.removeTokenBindingKey(o)}catch(i){throw p(Qt)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){let t=Q.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getIdToken called");let s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:v.ID_TOKEN,clientId:this.clientId,realm:n},a=this.getIdTokensByFilter(s,t),c=a.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let d=a;if(!n){let l=new Map;a.forEach((g,m)=>{g.realm===e.tenantId&&l.set(m,g)});let u=l.size;if(u<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(u===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),l.values().next().value;d=l}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),d.forEach((l,u)=>{this.removeIdToken(u)}),o&&i&&o.addFields({multiMatchedID:a.size},i),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){let n=t&&t.idToken||this.getTokenKeys().idToken,o=new Map;return n.forEach(i=>{if(!this.idTokenKeyMatchesFilter(i,{clientId:this.clientId,...e}))return;let s=this.getIdTokenCredential(i);s&&this.credentialMatchesFilter(s,e)&&o.set(i,s)}),o}idTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,n,o,i,s){this.commonLogger.trace("CacheManager - getAccessToken called");let a=H.createSearchScopes(t.scopes),c=t.authenticationScheme||O.BEARER,d=c&&c.toLowerCase()!==O.BEARER.toLowerCase()?v.ACCESS_TOKEN_WITH_AUTH_SCHEME:v.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:d,clientId:this.clientId,realm:o||e.tenantId,target:a,tokenType:c,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=n&&n.accessToken||this.getTokenKeys().accessToken,g=[];u.forEach(A=>{if(this.accessTokenKeyMatchesFilter(A,l,!0)){let C=this.getAccessTokenCredential(A);C&&this.credentialMatchesFilter(C,l)&&g.push(C)}});let m=g.length;return m<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):m>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),g.forEach(A=>{this.removeAccessToken(vn(A))}),i&&s&&i.addFields({multiMatchedAT:g.length},s),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),g[0])}accessTokenKeyMatchesFilter(e,t,n){let o=e.toLowerCase();if(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&o.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&o.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){let i=t.target.asArray();for(let s=0;s<i.length;s++){if(n&&!o.includes(i[s].toLowerCase()))return!1;if(!n&&o.includes(i[s].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){let t=this.getTokenKeys(),n=[];return t.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,e,!0))return;let i=this.getAccessTokenCredential(o);i&&this.credentialMatchesFilter(i,e)&&n.push(i)}),n}getRefreshToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");let s=t?ut:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:v.REFRESH_TOKEN,clientId:this.clientId,familyId:s},c=n&&n.refreshToken||this.getTokenKeys().refreshToken,d=[];c.forEach(u=>{if(this.refreshTokenKeyMatchesFilter(u,a)){let g=this.getRefreshTokenCredential(u);g&&this.credentialMatchesFilter(g,a)&&d.push(g)}});let l=d.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&o&&i&&o.addFields({multiMatchedRT:l},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),d[0])}refreshTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.familyId&&n.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),o=Object.keys(n).map(s=>n[s]),i=o.length;if(i<1)return null;if(i>1)throw p(qt);return o[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===ut)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){let n=e.oid||e.sub;return t===n}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var n;return t.toLowerCase()===((n=e.name)==null?void 0:n.toLowerCase())}matchUsername(e,t){return!!(e&&typeof e=="string"&&(t==null?void 0:t.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let o=rd(this.staticAuthorityOptions,this.commonLogger);if(o.includes(t)&&o.includes(e.environment))return!0}let n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){var n;return((n=e.realm)==null?void 0:n.toLowerCase())===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==v.ACCESS_TOKEN&&e.credentialType!==v.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:H.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(un)!==-1}isAuthorityMetadata(e){return e.indexOf(Rr.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${Rr.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(let n in t)e[n]=t[n];return e}},Ln=class extends It{async setAccount(){throw p(k)}getAccount(){throw p(k)}async setIdTokenCredential(){throw p(k)}getIdTokenCredential(){throw p(k)}async setAccessTokenCredential(){throw p(k)}getAccessTokenCredential(){throw p(k)}async setRefreshTokenCredential(){throw p(k)}getRefreshTokenCredential(){throw p(k)}setAppMetadata(){throw p(k)}getAppMetadata(){throw p(k)}setServerTelemetry(){throw p(k)}getServerTelemetry(){throw p(k)}setAuthorityMetadata(){throw p(k)}getAuthorityMetadata(){throw p(k)}getAuthorityMetadataKeys(){throw p(k)}setThrottlingCache(){throw p(k)}getThrottlingCache(){throw p(k)}removeItem(){throw p(k)}getKeys(){throw p(k)}getAccountKeys(){throw p(k)}getTokenKeys(){throw p(k)}};var Ip={tokenRenewalOffsetSeconds:fn,preventCorsPreflight:!1},Sp={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:q.Info,correlationId:f.EMPTY_STRING},_p={claimsBasedCachingEnabled:!1},Rp={async sendGetRequestAsync(){throw p(k)},async sendPostRequestAsync(){throw p(k)}},kp={sku:f.SKU,version:kr,cpu:f.EMPTY_STRING,os:f.EMPTY_STRING},wp={clientSecret:f.EMPTY_STRING,clientAssertion:void 0},Op={azureCloudInstance:Zt.None,tenant:`${f.DEFAULT_COMMON_TENANT}`},Np={application:{appName:"",appVersion:""}};function od({authOptions:r,systemOptions:e,loggerOptions:t,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:s,clientCredentials:a,libraryInfo:c,telemetry:d,serverTelemetryManager:l,persistencePlugin:u,serializableCache:g}){let m={...Sp,...t};return{authOptions:vp(r),systemOptions:{...Ip,...e},loggerOptions:m,cacheOptions:{..._p,...n},storageInterface:o||new Ln(r.clientId,As,new _e(m)),networkInterface:i||Rp,cryptoInterface:s||As,clientCredentials:a||wp,libraryInfo:{...kp,...c},telemetry:{...Np,...d},serverTelemetryManager:l||null,persistencePlugin:u||null,serializableCache:g||null}}function vp(r){return{clientCapabilities:[],azureCloudOptions:Op,skipAuthorityMetadataCache:!1,instanceAware:!1,...r}}function Zo(r){return r.authOptions.authority.options.protocolMode===ke.OIDC}var le={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var I={};$e(I,{addApplicationTelemetry:()=>Fn,addAuthorizationCode:()=>Aa,addBrokerParameters:()=>at,addCcsOid:()=>it,addCcsUpn:()=>St,addClaims:()=>ir,addClientAssertion:()=>Gn,addClientAssertionType:()=>qn,addClientCapabilitiesToClaims:()=>id,addClientId:()=>nr,addClientInfo:()=>ar,addClientSecret:()=>Bn,addCodeChallengeParams:()=>Kp,addCodeVerifier:()=>Ia,addCorrelationId:()=>sr,addDeviceCode:()=>jp,addDomainHint:()=>Ea,addEARParameters:()=>Xp,addExtraQueryParameters:()=>st,addGrantType:()=>Vn,addIdTokenHint:()=>ga,addInstanceAware:()=>Kn,addLibraryInfo:()=>Hn,addLoginHint:()=>Br,addLogoutHint:()=>Sa,addNativeBroker:()=>Vp,addNonce:()=>ya,addOboAssertion:()=>Yp,addPassword:()=>Qp,addPopToken:()=>jn,addPostLogoutRedirectUri:()=>ma,addPrompt:()=>Ta,addRedirectUri:()=>or,addRefreshToken:()=>Ca,addRequestTokenUse:()=>zp,addResponseMode:()=>pa,addResponseType:()=>qp,addScopes:()=>rr,addServerTelemetry:()=>zn,addSid:()=>si,addSshJwk:()=>Yn,addState:()=>$n,addThrottling:()=>Wn,addUsername:()=>Wp,instrumentBrokerParams:()=>tr});var ii={};$e(ii,{ACCESS_TOKEN:()=>Pp,BROKER_CLIENT_ID:()=>Un,BROKER_REDIRECT_URI:()=>oi,CCS_HEADER:()=>Bp,CLAIMS:()=>Ps,CLIENT_ASSERTION:()=>na,CLIENT_ASSERTION_TYPE:()=>oa,CLIENT_ID:()=>qe,CLIENT_INFO:()=>Hp,CLIENT_REQUEST_ID:()=>qs,CLIENT_SECRET:()=>ra,CODE:()=>Fs,CODE_CHALLENGE:()=>$s,CODE_CHALLENGE_METHOD:()=>Bs,CODE_VERIFIER:()=>Gs,DEVICE_CODE:()=>ta,DOMAIN_HINT:()=>ua,EAR_JWE_CRYPTO:()=>fa,EAR_JWK:()=>ha,ERROR:()=>bp,ERROR_DESCRIPTION:()=>Mp,EXPIRES_IN:()=>xp,FOCI:()=>$p,GRANT_TYPE:()=>Ms,ID_TOKEN:()=>Dp,ID_TOKEN_HINT:()=>ea,INSTANCE_AWARE:()=>$r,LOGIN_HINT:()=>la,LOGOUT_HINT:()=>ca,NATIVE_BROKER:()=>aa,NONCE:()=>Us,OBO_ASSERTION:()=>ia,ON_BEHALF_OF:()=>Fp,POST_LOGOUT_URI:()=>Zs,PROMPT:()=>Hs,REDIRECT_URI:()=>ei,REFRESH_TOKEN:()=>xs,REFRESH_TOKEN_EXPIRES_IN:()=>Lp,REQUESTED_TOKEN_USE:()=>sa,REQ_CNF:()=>ri,RESPONSE_MODE:()=>bs,RESPONSE_TYPE:()=>vs,RETURN_SPA_CODE:()=>ni,SCOPE:()=>Ds,SESSION_STATE:()=>Up,SID:()=>da,STATE:()=>Ls,TOKEN_TYPE:()=>ti,X_APP_NAME:()=>Xs,X_APP_VER:()=>Js,X_CLIENT_CPU:()=>Ys,X_CLIENT_CURR_TELEM:()=>zs,X_CLIENT_EXTRA_SKU:()=>Gp,X_CLIENT_LAST_TELEM:()=>Ws,X_CLIENT_OS:()=>js,X_CLIENT_SKU:()=>Vs,X_CLIENT_VER:()=>Ks,X_MS_LIB_CAPABILITY:()=>Qs});var qe="client_id",ei="redirect_uri",vs="response_type",bs="response_mode",Ms="grant_type",Ps="claims",Ds="scope",bp="error",Mp="error_description",Pp="access_token",Dp="id_token",xs="refresh_token",xp="expires_in",Lp="refresh_token_expires_in",Ls="state",Us="nonce",Hs="prompt",Up="session_state",Hp="client_info",Fs="code",$s="code_challenge",Bs="code_challenge_method",Gs="code_verifier",qs="client-request-id",Vs="x-client-SKU",Ks="x-client-VER",js="x-client-OS",Ys="x-client-CPU",zs="x-client-current-telemetry",Ws="x-client-last-telemetry",Qs="x-ms-lib-capability",Xs="x-app-name",Js="x-app-ver",Zs="post_logout_redirect_uri",ea="id_token_hint",ta="device_code",ra="client_secret",na="client_assertion",oa="client_assertion_type",ti="token_type",ri="req_cnf",ia="assertion",sa="requested_token_use",Fp="on_behalf_of",$p="foci",Bp="X-AnchorMailbox",ni="return_spa_code",aa="nativebroker",ca="logout_hint",da="sid",la="login_hint",ua="domain_hint",Gp="x-client-xtra-sku",Un="brk_client_id",oi="brk_redirect_uri",$r="instance_aware",ha="ear_jwk",fa="ear_jwe_crypto";function tr(r,e,t){if(!e)return;let n=r.get(qe);n&&r.has(Un)&&(t==null||t.addFields({embeddedClientId:n,embeddedRedirectUri:r.get(ei)},e))}function qp(r,e){r.set(vs,e)}function pa(r,e){r.set(bs,e||ln.QUERY)}function Vp(r){r.set(aa,"1")}function rr(r,e,t=!0,n=Qe){t&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");let o=t?[...e||[],...n]:e||[],i=new H(o);r.set(Ds,i.printScopes())}function nr(r,e){r.set(qe,e)}function or(r,e){r.set(ei,e)}function ma(r,e){r.set(Zs,e)}function ga(r,e){r.set(ea,e)}function Ea(r,e){r.set(ua,e)}function Br(r,e){r.set(la,e)}function St(r,e){r.set(D.CCS_HEADER,`UPN:${e}`)}function it(r,e){r.set(D.CCS_HEADER,`Oid:${e.uid}@${e.utid}`)}function si(r,e){r.set(da,e)}function ir(r,e,t){let n=id(e,t);try{JSON.parse(n)}catch(o){throw b(ot)}r.set(Ps,n)}function sr(r,e){r.set(qs,e)}function Hn(r,e){r.set(Vs,e.sku),r.set(Ks,e.version),e.os&&r.set(js,e.os),e.cpu&&r.set(Ys,e.cpu)}function Fn(r,e){e!=null&&e.appName&&r.set(Xs,e.appName),e!=null&&e.appVersion&&r.set(Js,e.appVersion)}function Ta(r,e){r.set(Hs,e)}function $n(r,e){e&&r.set(Ls,e)}function ya(r,e){r.set(Us,e)}function Kp(r,e,t){if(e&&t)r.set($s,e),r.set(Bs,t);else throw b(Tt)}function Aa(r,e){r.set(Fs,e)}function jp(r,e){r.set(ta,e)}function Ca(r,e){r.set(xs,e)}function Ia(r,e){r.set(Gs,e)}function Bn(r,e){r.set(ra,e)}function Gn(r,e){e&&r.set(na,e)}function qn(r,e){e&&r.set(oa,e)}function Yp(r,e){r.set(ia,e)}function zp(r,e){r.set(sa,e)}function Vn(r,e){r.set(Ms,e)}function ar(r){r.set(Wc,"1")}function Kn(r){r.has($r)||r.set($r,"true")}function st(r,e){Object.entries(e).forEach(([t,n])=>{!r.has(t)&&n&&r.set(t,n)})}function id(r,e){let t;if(!r)t={};else try{t=JSON.parse(r)}catch(n){throw b(ot)}return e&&e.length>0&&(t.hasOwnProperty(Sr.ACCESS_TOKEN)||(t[Sr.ACCESS_TOKEN]={}),t[Sr.ACCESS_TOKEN][Sr.XMS_CC]={values:e}),JSON.stringify(t)}function Wp(r,e){r.set(Do.username,e)}function Qp(r,e){r.set(Do.password,e)}function jn(r,e){e&&(r.set(ti,O.POP),r.set(ri,e))}function Yn(r,e){e&&(r.set(ti,O.SSH),r.set(ri,e))}function zn(r,e){r.set(zs,e.generateCurrentRequestHeaderValue()),r.set(Ws,e.generateLastRequestHeaderValue())}function Wn(r){r.set(Qs,Xe.X_MS_LIB_CAPABILITY_VALUE)}function Sa(r,e){r.set(ca,e)}function at(r,e,t){r.has(Un)||r.set(Un,e),r.has(oi)||r.set(oi,t)}function Xp(r,e){r.set(ha,encodeURIComponent(e));let t="eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0";r.set(fa,t)}var ci={};$e(ci,{createDiscoveredInstance:()=>Ra});function sd(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}function ad(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}function cd(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}var h={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},n_=new Map([[h.AcquireTokenByCode,"ATByCode"],[h.AcquireTokenByRefreshToken,"ATByRT"],[h.AcquireTokenSilent,"ATS"],[h.AcquireTokenSilentAsync,"ATSAsync"],[h.AcquireTokenPopup,"ATPopup"],[h.AcquireTokenRedirect,"ATRedirect"],[h.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[h.CryptoOptsSignJwt,"CryptoSignJwt"],[h.SilentCacheClientAcquireToken,"SltCacheClientAT"],[h.SilentIframeClientAcquireToken,"SltIframeClientAT"],[h.SilentRefreshClientAcquireToken,"SltRClientAT"],[h.SsoSilent,"SsoSlt"],[h.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[h.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[h.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[h.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[h.NetworkClientSendPostRequestAsync,"NetClientSendPost"],[h.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[h.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[h.BrokerHandhshake,"BrokerHandshake"],[h.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[h.AcquireTokenByBroker,"ATByBroker"],[h.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[h.RefreshTokenClientAcquireToken,"RTClientAT"],[h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[h.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[h.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[h.AcquireTokenFromCache,"ATFromCache"],[h.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[h.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[h.AcquireTokenBySilentIframe,"ATBySltIframe"],[h.InitializeBaseRequest,"InitBaseReq"],[h.InitializeSilentRequest,"InitSltReq"],[h.InitializeClientApplication,"InitClientApplication"],[h.InitializeCache,"InitCache"],[h.ImportExistingCache,"importCache"],[h.SetUserData,"setUserData"],[h.LocalStorageUpdated,"localStorageUpdated"],[h.SilentIframeClientTokenHelper,"SIClientTHelper"],[h.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[h.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[h.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[h.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[h.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[h.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[h.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[h.GetAuthCodeUrl,"GetAuthCodeUrl"],[h.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[h.HandleCodeResponse,"HandleCodeResp"],[h.HandleResponseEar,"HandleRespEar"],[h.HandleResponseCode,"HandleRespCode"],[h.HandleResponsePlatformBroker,"HandleRespPlatBroker"],[h.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[h.AuthClientAcquireToken,"AuthClientAT"],[h.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[h.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[h.PopTokenGenerateCnf,"PopTGenCnf"],[h.PopTokenGenerateKid,"PopTGenKid"],[h.HandleServerTokenResponse,"HandleServerTRes"],[h.DeserializeResponse,"DeserializeRes"],[h.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[h.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[h.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[h.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[h.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[h.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[h.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[h.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[h.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[h.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[h.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[h.AcquireTokenByCodeAsync,"ATByCodeAsync"],[h.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[h.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[h.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[h.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[h.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[h.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[h.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[h.NativeGenerateAuthResult,"NtvGenAuthRes"],[h.RemoveHiddenIframe,"RemoveHiddenIframe"],[h.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[h.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[h.GeneratePkceCodes,"GenPkceCodes"],[h.GenerateCodeVerifier,"GenCodeVerifier"],[h.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[h.Sha256Digest,"Sha256Digest"],[h.GetRandomValues,"GetRandomValues"],[h.GenerateHKDF,"genHKDF"],[h.GenerateBaseKey,"genBaseKey"],[h.Base64Decode,"b64Decode"],[h.UrlEncodeArr,"urlEncArr"],[h.Encrypt,"encrypt"],[h.Decrypt,"decrypt"],[h.GenerateEarKey,"genEarKey"],[h.DecryptEarResponse,"decryptEarResp"]]);var dd=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let s=n==null?void 0:n.startMeasurement(e,o);if(o){let a=e+"CallCount";n==null||n.incrementFields({[a]:1},o)}try{let a=r(...i);return s==null||s.end({success:!0}),t.trace(`Returning result from ${e}`),a}catch(a){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch(c){t.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a}},w=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let s=n==null?void 0:n.startMeasurement(e,o);if(o){let a=e+"CallCount";n==null||n.incrementFields({[a]:1},o)}return n==null||n.setPreQueueTime(e,o),r(...i).then(a=>(t.trace(`Returning result from ${e}`),s==null||s.end({success:!0}),a)).catch(a=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch(c){t.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a})};var cr=class{constructor(e,t,n,o){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=o}async detectRegion(e,t){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(h.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)t.region_source=Dt.ENVIRONMENT_VARIABLE;else{let i=cr.IMDS_OPTIONS;try{let s=await w(this.getRegionFromIMDS.bind(this),h.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(f.IMDS_VERSION,i);if(s.status===hn.httpSuccess&&(n=s.body,t.region_source=Dt.IMDS),s.status===hn.httpBadRequest){let a=await w(this.getCurrentVersion.bind(this),h.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!a)return t.region_source=Dt.FAILED_AUTO_DETECTION,null;let c=await w(this.getRegionFromIMDS.bind(this),h.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,i);c.status===hn.httpSuccess&&(n=c.body,t.region_source=Dt.IMDS)}}catch(s){return t.region_source=Dt.FAILED_AUTO_DETECTION,null}}return n||(t.region_source=Dt.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(e,t){var n;return(n=this.performanceClient)==null||n.addQueueMeasurement(h.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${f.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,f.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;(t=this.performanceClient)==null||t.addQueueMeasurement(h.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let n=await this.networkInterface.sendGetRequestAsync(`${f.IMDS_ENDPOINT}?format=json`,e);return n.status===hn.httpBadRequest&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?n.body["newest-versions"][0]:null}catch(n){return null}}};cr.IMDS_OPTIONS={headers:{Metadata:"true"}};var X=class{constructor(e,t,n,o,i,s,a,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=a,this.correlationId=s,this.managedIdentity=c||!1,this.regionDiscovery=new cr(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(f.CIAM_AUTH_URL))return Re.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case f.ADFS:return Re.Adfs;case f.DSTS:return Re.Dsts}return Re.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new R(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw p(de)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw p(de)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw p(de)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw p(Xt);return this.replacePath(this.metadata.end_session_endpoint)}else throw p(de)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw p(de)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw p(de)}canReplaceTenant(e){return e.PathSegments.length===1&&!X.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Re.Default&&this.protocolMode!==ke.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,o=new R(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,c)=>{let d=i[c];if(c===0&&this.canReplaceTenant(o)){let l=new R(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];d!==l&&(this.logger.verbose(`Replacing tenant domain name ${d} with id ${l}`),d=l)}a!==d&&(t=t.replace(`/${d}/`,`/${a}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Re.Adfs||this.protocolMode===ke.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var o,i;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=await w(this.updateCloudDiscoveryMetadata.bind(this),h.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let n=await w(this.updateEndpointMetadata.bind(this),h.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),(i=this.performanceClient)==null||i.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Bo(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==ce.CACHE&&(n==null?void 0:n.source)!==ce.CACHE&&(e.expiresAt=Bo(),e.canonical_authority=this.canonicalAuthority);let o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}async updateEndpointMetadata(e){var o,i,s;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===ce.HARDCODED_VALUES&&(i=this.authorityOptions.azureRegionConfiguration)!=null&&i.azureRegion&&t.metadata){let a=await w(this.updateMetadataWithRegionalInformation.bind(this),h.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);Or(e,a,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=await w(this.getEndpointMetadataFromNetwork.bind(this),h.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return(s=this.authorityOptions.azureRegionConfiguration)!=null&&s.azureRegion&&(n=await w(this.updateMetadataWithRegionalInformation.bind(this),h.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),Or(e,n,!0),ce.NETWORK;throw p(Ht,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Or(e,t,!1),{source:ce.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let o=this.getEndpointMetadataFromHardcodedValues();if(o)return Or(e,o,!1),{source:ce.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let n=Go(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:ce.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new R(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw b(Ur)}return null}async getEndpointMetadataFromNetwork(){var n;(n=this.performanceClient)==null||n.addQueueMeasurement(h.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{let o=await this.networkInterface.sendGetRequestAsync(t,e);return sd(o.body)?o.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(o){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${o}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in ks?ks[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var n,o,i;(n=this.performanceClient)==null||n.addQueueMeasurement(h.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=(o=this.authorityOptions.azureRegionConfiguration)==null?void 0:o.azureRegion;if(t){if(t!==f.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=xo.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,X.replaceWithRegionalInformation(e,t);let s=await w(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),h.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((i=this.authorityOptions.azureRegionConfiguration)==null?void 0:i.environmentRegion,this.regionDiscoveryMetadata);if(s)return this.regionDiscoveryMetadata.region_outcome=xo.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=s,X.replaceWithRegionalInformation(e,s);this.regionDiscoveryMetadata.region_outcome=xo.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let n=await w(this.getCloudDiscoveryMetadataFromNetwork.bind(this),h.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return bn(e,n,!0),ce.NETWORK;throw b(Hr)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||f.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||f.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||f.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),bn(e,t,!1),ce.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let o=nd(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),bn(e,o,!1),ce.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=Go(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),ce.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Re.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),X.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Dn(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),b(er)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),X.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${f.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={},n=null;try{let i=await this.networkInterface.sendGetRequestAsync(e,t),s,a;if(ad(i.body))s=i.body,a=s.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${s.tenant_discovery_endpoint}`);else if(cd(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),s=i.body,s.error===f.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${s.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${s.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=Dn(a,this.hostnameAndPort)}catch(i){if(i instanceof N)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{let s=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${s.name}
Error Description: ${s.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=X.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&R.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==Zt.None){let o=t.tenant?t.tenant:f.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${o}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return f.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw p(de)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Os.has(e)}static isPublicCloudAuthority(e){return f.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){let o=new R(e);o.validateAsUri();let i=o.getUrlComponents(),s=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(s=`${t}.${f.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let a=R.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:s}).urlString;return n?`${a}?${n}`:a}static replaceWithRegionalInformation(e,t){let n={...e};return n.authorization_endpoint=X.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=X.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=X.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e,o=new R(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(f.CIAM_AUTH_URL)){let i=o.HostNameAndPort.split(".")[0];t=`${t}${i}${f.AAD_TENANT_DOMAIN_SUFFIX}`}return t}};X.reservedTenantDomains=new Set(["{tenant}","{tenantid}",ye.COMMON,ye.CONSUMERS,ye.ORGANIZATIONS]);function ld(r){var o;let n=(o=new R(r).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:o.toLowerCase();switch(n){case ye.COMMON:case ye.ORGANIZATIONS:case ye.CONSUMERS:return;default:return n}}function ai(r){return r.endsWith(f.FORWARD_SLASH)?r:`${r}${f.FORWARD_SLASH}`}function _a(r){let e=r.cloudDiscoveryMetadata,t;if(e)try{t=JSON.parse(e)}catch(n){throw b(er)}return{canonicalAuthority:r.authority?ai(r.authority):void 0,knownAuthorities:r.knownAuthorities,cloudDiscoveryMetadata:t}}async function Ra(r,e,t,n,o,i,s){s==null||s.addQueueMeasurement(h.AuthorityFactoryCreateDiscoveredInstance,i);let a=X.transformCIAMAuthority(ai(r)),c=new X(a,e,t,n,o,i,s);try{return await w(c.resolveEndpointsAsync.bind(c),h.AuthorityResolveEndpointsAsync,o,s,i)(),c}catch(d){throw p(de)}}var we=class extends N{constructor(e,t,n,o,i){super(e,t,n),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,we.prototype)}};function Gr(r,e,t){var n;return{clientId:r,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:t,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||((n=e.tokenBodyParameters)==null?void 0:n.clientId)}}var Le=class{static generateThrottlingStorageKey(e){return`${Xe.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){var i;let n=Le.generateThrottlingStorageKey(t),o=e.getThrottlingCache(n);if(o){if(o.throttleTime<Date.now()){e.removeItem(n);return}throw new we(((i=o.errorCodes)==null?void 0:i.join(" "))||f.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,n){if(Le.checkResponseStatus(n)||Le.checkResponseForRetryAfter(n)){let o={throttleTime:Le.calculateThrottleTime(parseInt(n.headers[D.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(Le.generateThrottlingStorageKey(t),o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(D.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(t||Xe.DEFAULT_THROTTLE_TIME_SECONDS),n+Xe.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,n,o){let i=Gr(t,n,o),s=this.generateThrottlingStorageKey(i);e.removeItem(s)}};var qr=class extends N{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,qr.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}};var ue=class{constructor(e,t){this.config=od(e),this.logger=new _e(this.config.loggerOptions,Ho,kr),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[D.CONTENT_TYPE]=f.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case le.HOME_ACCOUNT_ID:try{let n=Be(e.credential);t[D.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case le.UPN:t[D.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,n,o,i,s){var c;s&&((c=this.performanceClient)==null||c.addQueueMeasurement(s,i));let a=await this.sendPostRequest(o,e,{body:t,headers:n},i);return this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,n,o){var s,a,c;Le.preProcess(this.cacheManager,e);let i;try{i=await w(this.networkClient.sendPostRequestAsync.bind(this.networkClient),h.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,o)(t,n);let d=i.headers||{};(a=this.performanceClient)==null||a.addFields({refreshTokenSize:((s=i.body.refresh_token)==null?void 0:s.length)||0,httpVerToken:d[D.X_MS_HTTP_VERSION]||"",requestId:d[D.X_MS_REQUEST_ID]||""},o)}catch(d){if(d instanceof qr){let l=d.responseHeaders;throw l&&((c=this.performanceClient)==null||c.addFields({httpVerToken:l[D.X_MS_HTTP_VERSION]||"",requestId:l[D.X_MS_REQUEST_ID]||"",contentTypeHeader:l[D.CONTENT_TYPE]||void 0,contentLengthHeader:l[D.CONTENT_LENGTH]||void 0,httpStatus:d.httpStatus},o)),d.error}throw d instanceof N?d:p(Ut)}return Le.postProcess(this.cacheManager,e,i),i}async updateAuthority(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(h.UpdateTokenEndpointAuthority,t);let n=`https://${e}/${this.authority.tenant}/`,o=await Ra(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=o}createTokenQueryParameters(e){let t=new Map;return e.embeddedClientId&&at(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&st(t,e.tokenQueryParameters),sr(t,e.correlationId),tr(t,e.correlationId,this.performanceClient),Ge(t)}};var dr="no_tokens_found",di="native_account_unavailable",li="refresh_token_expired",ud="interaction_required",hd="consent_required",fd="login_required",lr="bad_token";var pd=[ud,hd,fd,lr],Jp=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],ui={[dr]:"No refresh token found in the cache. Please sign-in.",[di]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[li]:"Refresh token has expired.",[lr]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."},lR={noTokensFoundError:{code:dr,desc:ui[dr]},native_account_unavailable:{code:di,desc:ui[di]},bad_token:{code:lr,desc:ui[lr]}},Oe=class extends N{constructor(e,t,n,o,i,s,a,c){super(e,t,n),Object.setPrototypeOf(this,Oe.prototype),this.timestamp=o||f.EMPTY_STRING,this.traceId=i||f.EMPTY_STRING,this.correlationId=s||f.EMPTY_STRING,this.claims=a||f.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}};function hi(r,e,t){let n=!!r&&pd.indexOf(r)>-1,o=!!t&&Jp.indexOf(t)>-1,i=!!e&&pd.some(s=>e.indexOf(s)>-1);return n||i||o}function ka(r){return new Oe(r,ui[r])}var Vr=class{static setRequestState(e,t,n){let o=Vr.generateLibraryState(e,n);return t?`${o}${f.RESOURCE_DELIM}${t}`:o}static generateLibraryState(e,t){if(!e)throw p(gt);let n={id:e.createNewGuid()};t&&(n.meta=t);let o=JSON.stringify(n);return e.base64Encode(o)}static parseRequestState(e,t){if(!e)throw p(gt);if(!t)throw p(xe);try{let n=t.split(f.RESOURCE_DELIM),o=n[0],i=n.length>1?n.slice(1).join(f.RESOURCE_DELIM):f.EMPTY_STRING,s=e.base64Decode(o),a=JSON.parse(s);return{userRequestState:i||f.EMPTY_STRING,libraryState:a}}catch(n){throw p(xe)}}};var Zp={SW:"sw",UHW:"uhw"},_t=class{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(h.PopTokenGenerateCnf,e.correlationId);let n=await w(this.generateKid.bind(this),h.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:o}}async generateKid(e){var n;return(n=this.performanceClient)==null||n.addQueueMeasurement(h.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:Zp.SW}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,o){let{resourceRequestMethod:i,resourceRequestUri:s,shrClaims:a,shrNonce:c,shrOptions:d}=n,l=s?new R(s):void 0,u=l==null?void 0:l.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Ae(),m:i==null?void 0:i.toUpperCase(),u:u==null?void 0:u.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:u==null?void 0:u.AbsolutePath,q:u!=null&&u.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0,...o},t,d,n.correlationId)}};var Ue=class{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};var G=class{constructor(e,t,n,o,i,s,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=o,this.serializableCache=i,this.persistencePlugin=s,this.performanceClient=a}validateTokenResponse(e,t){var n;if(e.error||e.error_description||e.suberror){let o=`Error(s): ${e.error_codes||f.NOT_AVAILABLE} - Timestamp: ${e.timestamp||f.NOT_AVAILABLE} - Description: ${e.error_description||f.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||f.NOT_AVAILABLE} - Trace ID: ${e.trace_id||f.NOT_AVAILABLE}`,i=(n=e.error_codes)!=null&&n.length?e.error_codes[0]:void 0,s=new we(e.error,o,e.suberror,i,e.status);if(t&&e.status&&e.status>=M.SERVER_ERROR_RANGE_START&&e.status<=M.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${s}`);return}else if(t&&e.status&&e.status>=M.CLIENT_ERROR_RANGE_START&&e.status<=M.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${s}`);return}throw hi(e.error,e.error_description,e.suberror)?new Oe(e.error,e.error_description,e.suberror,e.timestamp||f.EMPTY_STRING,e.trace_id||f.EMPTY_STRING,e.correlation_id||f.EMPTY_STRING,e.claims||f.EMPTY_STRING,i):s}}async handleServerTokenResponse(e,t,n,o,i,s,a,c,d){var A;(A=this.performanceClient)==null||A.addQueueMeasurement(h.HandleServerTokenResponse,e.correlation_id);let l;if(e.id_token){if(l=rt(e.id_token||f.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&l.nonce!==i.nonce)throw p(Bt);if(o.maxAge||o.maxAge===0){let C=l.auth_time;if(!C)throw p(Je);On(C,o.maxAge)}}this.homeAccountIdentifier=Q.generateHomeAccountId(e.client_info||f.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,l);let u;i&&i.state&&(u=Vr.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;let g=this.generateCacheRecord(e,t,n,o,l,s,i),m;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new Ue(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(m)),a&&!c&&g.account){let C=g.account.generateAccountKey();if(!this.cacheStorage.getAccount(C))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await G.generateAuthenticationResult(this.cryptoObj,t,g,!1,o,l,u,void 0,d)}await this.cacheStorage.saveCacheRecord(g,o.correlationId,o.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&m&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(m))}return G.generateAuthenticationResult(this.cryptoObj,t,g,!1,o,l,u,e,d)}generateCacheRecord(e,t,n,o,i,s,a){let c=t.getPreferredCache();if(!c)throw p(et);let d=Xo(i),l,u;e.id_token&&i&&(l=Is(this.homeAccountIdentifier,c,e.id_token,this.clientId,d||""),u=md(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i,e.client_info,c,d,a,void 0,this.logger));let g=null;if(e.access_token){let C=e.scope?H.fromString(e.scope):new H(o.scopes||[]),L=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,K=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,V=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,ee=n+L,me=ee+K,ze=V&&V>0?n+V:void 0;g=Ss(this.homeAccountIdentifier,c,e.access_token,this.clientId,d||t.tenant||"",C.printScopes(),ee,me,this.cryptoObj.base64Decode,ze,e.token_type,s,e.key_id,o.claims,o.requestedClaimsHash)}let m=null;if(e.refresh_token){let C;if(e.refresh_token_expires_in){let L=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;C=n+L}m=_s(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,s,C)}let A=null;return e.foci&&(A={clientId:this.clientId,environment:c,familyId:e.foci}),{account:u,idToken:l,accessToken:g,refreshToken:m,appMetadata:A}}static async generateAuthenticationResult(e,t,n,o,i,s,a,c,d){var ee,me,ze,Io,So;let l=f.EMPTY_STRING,u=[],g=null,m,A,C=f.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===O.POP&&!i.popKid){let ls=new _t(e),{secret:_o,keyId:us}=n.accessToken;if(!us)throw p(Jt);l=await ls.signPopToken(_o,us,i)}else l=n.accessToken.secret;u=H.fromString(n.accessToken.target).asArray(),g=Nn(n.accessToken.expiresOn),m=Nn(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(A=Nn(n.accessToken.refreshOn))}n.appMetadata&&(C=n.appMetadata.familyId===ut?ut:"");let L=(s==null?void 0:s.oid)||(s==null?void 0:s.sub)||"",K=(s==null?void 0:s.tid)||"";c!=null&&c.spa_accountid&&n.account&&(n.account.nativeAccountId=c==null?void 0:c.spa_accountid);let V=n.account?Qo(n.account.getAccountInfo(),void 0,s,(ee=n.idToken)==null?void 0:ee.secret):null;return{authority:t.canonicalAuthority,uniqueId:L,tenantId:K,scopes:u,account:V,idToken:((me=n==null?void 0:n.idToken)==null?void 0:me.secret)||"",idTokenClaims:s||{},accessToken:l,fromCache:o,expiresOn:g,extExpiresOn:m,refreshOn:A,correlationId:i.correlationId,requestId:d||f.EMPTY_STRING,familyId:C,tokenType:((ze=n.accessToken)==null?void 0:ze.tokenType)||f.EMPTY_STRING,state:a?a.userRequestState:f.EMPTY_STRING,cloudGraphHostName:((Io=n.account)==null?void 0:Io.cloudGraphHostName)||f.EMPTY_STRING,msGraphHost:((So=n.account)==null?void 0:So.msGraphHost)||f.EMPTY_STRING,code:c==null?void 0:c.spa_code,fromNativeBroker:!1}}};function md(r,e,t,n,o,i,s,a,c,d,l){l==null||l.verbose("setCachedAccount called");let g=r.getAccountKeys().find(K=>K.startsWith(t)),m=null;g&&(m=r.getAccount(g));let A=m||Q.createAccount({homeAccountId:t,idTokenClaims:o,clientInfo:i,environment:s,cloudGraphHostName:c==null?void 0:c.cloud_graph_host_name,msGraphHost:c==null?void 0:c.msgraph_host,nativeAccountId:d},e,n),C=A.tenantProfiles||[],L=a||A.realm;if(L&&!C.find(K=>K.tenantId===L)){let K=Pn(t,A.localAccountId,L,o);C.push(K)}return A.tenantProfiles=C,A}var fi=class{static validateRedirectUri(e){if(!e)throw b(Nr)}static validatePrompt(e){let t=[];for(let n in lt)t.push(lt[n]);if(t.indexOf(e)<0)throw b(Pr)}static validateClaims(e){try{JSON.parse(e)}catch(t){throw b(ot)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw b(Tt);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Mo.PLAIN,Mo.S256].indexOf(e)<0)throw b(Lr)}};async function he(r,e,t){return typeof r=="string"?r:r({clientId:e,tokenEndpoint:t})}var Qn=class extends ue{constructor(e,t){var n;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=(n=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:n.defaultScopes}async acquireToken(e,t){var a,c;if((a=this.performanceClient)==null||a.addQueueMeasurement(h.AuthClientAcquireToken,e.correlationId),!e.code)throw p(Vt);let n=Ae(),o=await w(this.executeTokenRequest.bind(this),h.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=(c=o.headers)==null?void 0:c[D.X_MS_REQUEST_ID],s=new G(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(o.body),w(s.handleServerTokenResponse.bind(s),h.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,n,e,t,void 0,void 0,void 0,i)}getLogoutUri(e){if(!e)throw b(xr);let t=this.createLogoutUrlQueryString(e);return R.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var d;(d=this.performanceClient)==null||d.addQueueMeasurement(h.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),o=R.appendQueryString(e.tokenEndpoint,n),i=await w(this.createTokenRequestBody.bind(this),h.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),s;if(t.clientInfo)try{let l=Fr(t.clientInfo,this.cryptoUtils.base64Decode);s={credential:`${l.uid}${$.CLIENT_INFO_SEPARATOR}${l.utid}`,type:le.HOME_ACCOUNT_ID}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}let a=this.createTokenRequestHeaders(s||t.ccsCredential),c=Gr(this.config.authOptions.clientId,t);return w(this.executePostToTokenEndpoint.bind(this),h.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(o,i,a,c,t.correlationId,h.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var o,i;(o=this.performanceClient)==null||o.addQueueMeasurement(h.AuthClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(nr(t,e.embeddedClientId||((i=e.tokenBodyParameters)==null?void 0:i[qe])||this.config.authOptions.clientId),this.includeRedirectUri?or(t,e.redirectUri):fi.validateRedirectUri(e.redirectUri),rr(t,e.scopes,!0,this.oidcDefaultScopes),Aa(t,e.code),Hn(t,this.config.libraryInfo),Fn(t,this.config.telemetry.application),Wn(t),this.serverTelemetryManager&&!Zo(this.config)&&zn(t,this.serverTelemetryManager),e.codeVerifier&&Ia(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&Bn(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let s=this.config.clientCredentials.clientAssertion;Gn(t,await he(s.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),qn(t,s.assertionType)}if(Vn(t,De.AUTHORIZATION_CODE_GRANT),ar(t),e.authenticationScheme===O.POP){let s=new _t(this.cryptoUtils,this.performanceClient),a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(await w(s.generateCnf.bind(s),h.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,jn(t,a)}else if(e.authenticationScheme===O.SSH)if(e.sshJwk)Yn(t,e.sshJwk);else throw b(yt);(!B.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&ir(t,e.claims,this.config.authOptions.clientCapabilities);let n;if(e.clientInfo)try{let s=Fr(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${s.uid}${$.CLIENT_INFO_SEPARATOR}${s.utid}`,type:le.HOME_ACCOUNT_ID}}catch(s){this.logger.verbose("Could not parse client info for CCS Header: "+s)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case le.HOME_ACCOUNT_ID:try{let s=Be(n.credential);it(t,s)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case le.UPN:St(t,n.credential);break}return e.embeddedClientId&&at(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&st(t,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[ni])&&st(t,{[ni]:"1"}),tr(t,e.correlationId,this.performanceClient),Ge(t)}createLogoutUrlQueryString(e){let t=new Map;return e.postLogoutRedirectUri&&ma(t,e.postLogoutRedirectUri),e.correlationId&&sr(t,e.correlationId),e.idTokenHint&&ga(t,e.idTokenHint),e.state&&$n(t,e.state),e.logoutHint&&Sa(t,e.logoutHint),e.extraQueryParameters&&st(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Kn(t),Ge(t)}};var em=300,ur=class extends ue{constructor(e,t){super(e,t)}async acquireToken(e){var s,a;(s=this.performanceClient)==null||s.addQueueMeasurement(h.RefreshTokenClientAcquireToken,e.correlationId);let t=Ae(),n=await w(this.executeTokenRequest.bind(this),h.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=(a=n.headers)==null?void 0:a[D.X_MS_REQUEST_ID],i=new G(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),w(i.handleServerTokenResponse.bind(i),h.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){var n;if(!e)throw b(Dr);if((n=this.performanceClient)==null||n.addQueueMeasurement(h.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw p(Ze);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await w(this.acquireTokenWithCachedRefreshToken.bind(this),h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(o){let i=o instanceof Oe&&o.errorCode===dr,s=o instanceof we&&o.errorCode===Po.INVALID_GRANT_ERROR&&o.subError===Po.CLIENT_MISMATCH_ERROR;if(i||s)return w(this.acquireTokenWithCachedRefreshToken.bind(this),h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw o}return w(this.acquireTokenWithCachedRefreshToken.bind(this),h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var i,s,a;(i=this.performanceClient)==null||i.addQueueMeasurement(h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let n=dd(this.cacheManager.getRefreshToken.bind(this.cacheManager),h.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!n)throw ka(dr);if(n.expiresOn&&wr(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||em))throw(s=this.performanceClient)==null||s.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),ka(li);let o={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||O.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:le.HOME_ACCOUNT_ID}};try{return await w(this.acquireToken.bind(this),h.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(c){if(c instanceof Oe&&((a=this.performanceClient)==null||a.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),c.subError===lr)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let d=vn(n);this.cacheManager.removeRefreshToken(d)}throw c}}async executeTokenRequest(e,t){var c;(c=this.performanceClient)==null||c.addQueueMeasurement(h.RefreshTokenClientExecuteTokenRequest,e.correlationId);let n=this.createTokenQueryParameters(e),o=R.appendQueryString(t.tokenEndpoint,n),i=await w(this.createTokenRequestBody.bind(this),h.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),a=Gr(this.config.authOptions.clientId,e);return w(this.executePostToTokenEndpoint.bind(this),h.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,s,a,e.correlationId,h.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var n,o,i;(n=this.performanceClient)==null||n.addQueueMeasurement(h.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=new Map;if(nr(t,e.embeddedClientId||((o=e.tokenBodyParameters)==null?void 0:o[qe])||this.config.authOptions.clientId),e.redirectUri&&or(t,e.redirectUri),rr(t,e.scopes,!0,(i=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:i.defaultScopes),Vn(t,De.REFRESH_TOKEN_GRANT),ar(t),Hn(t,this.config.libraryInfo),Fn(t,this.config.telemetry.application),Wn(t),this.serverTelemetryManager&&!Zo(this.config)&&zn(t,this.serverTelemetryManager),Ca(t,e.refreshToken),this.config.clientCredentials.clientSecret&&Bn(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let s=this.config.clientCredentials.clientAssertion;Gn(t,await he(s.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),qn(t,s.assertionType)}if(e.authenticationScheme===O.POP){let s=new _t(this.cryptoUtils,this.performanceClient),a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(await w(s.generateCnf.bind(s),h.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,jn(t,a)}else if(e.authenticationScheme===O.SSH)if(e.sshJwk)Yn(t,e.sshJwk);else throw b(yt);if((!B.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&ir(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case le.HOME_ACCOUNT_ID:try{let s=Be(e.ccsCredential.credential);it(t,s)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case le.UPN:St(t,e.ccsCredential.credential);break}return e.embeddedClientId&&at(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&st(t,e.tokenBodyParameters),tr(t,e.correlationId,this.performanceClient),Ge(t)}};var Xn=class extends ue{constructor(e,t){super(e,t)}async acquireCachedToken(e){var c;(c=this.performanceClient)==null||c.addQueueMeasurement(h.SilentFlowClientAcquireCachedToken,e.correlationId);let t=U.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!B.isEmptyObj(e.claims))throw this.setCacheOutcome(U.FORCE_REFRESH_OR_CLAIMS,e.correlationId),p(tt);if(!e.account)throw p(Ze);let n=e.account.tenantId||ld(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,n,this.performanceClient,e.correlationId);if(i){if(Cs(i.cachedAt)||wr(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(U.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),p(tt);i.refreshOn&&wr(i.refreshOn,0)&&(t=U.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(U.NO_CACHED_ACCESS_TOKEN,e.correlationId),p(tt);let s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,o,n,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await w(this.generateResultFromCacheRecord.bind(this),h.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){var n,o;(n=this.serverTelemetryManager)==null||n.setCacheOutcome(e),(o=this.performanceClient)==null||o.addFields({cacheOutcome:e},t),e!==U.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(h.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let n;if(e.idToken&&(n=rt(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){let i=n==null?void 0:n.auth_time;if(!i)throw p(Je);On(i,t.maxAge)}return G.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}};var Jn={};$e(Jn,{getAuthorizationCodePayload:()=>nm,getAuthorizeUrl:()=>rm,getStandardAuthorizeRequestParameters:()=>tm,validateAuthorizationResponse:()=>gd});function tm(r,e,t,n){var a,c;let o=e.correlationId,i=new Map;nr(i,e.embeddedClientId||((a=e.extraQueryParameters)==null?void 0:a[qe])||r.clientId);let s=[...e.scopes||[],...e.extraScopesToConsent||[]];if(rr(i,s,!0,(c=r.authority.options.OIDCOptions)==null?void 0:c.defaultScopes),or(i,e.redirectUri),sr(i,o),pa(i,e.responseMode),ar(i),e.prompt&&(Ta(i,e.prompt),n==null||n.addFields({prompt:e.prompt},o)),e.domainHint&&(Ea(i,e.domainHint),n==null||n.addFields({domainHintFromRequest:!0},o)),e.prompt!==lt.SELECT_ACCOUNT)if(e.sid&&e.prompt===lt.NONE)t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),si(i,e.sid),n==null||n.addFields({sidFromRequest:!0},o);else if(e.account){let d=im(e.account),l=sm(e.account);if(l&&e.domainHint&&(t.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){t.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Br(i,l),n==null||n.addFields({loginHintFromClaim:!0},o);try{let u=Be(e.account.homeAccountId);it(i,u)}catch(u){t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(d&&e.prompt===lt.NONE){t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),si(i,d),n==null||n.addFields({sidFromClaim:!0},o);try{let u=Be(e.account.homeAccountId);it(i,u)}catch(u){t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)t.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Br(i,e.loginHint),St(i,e.loginHint),n==null||n.addFields({loginHintFromRequest:!0},o);else if(e.account.username){t.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Br(i,e.account.username),n==null||n.addFields({loginHintFromUpn:!0},o);try{let u=Be(e.account.homeAccountId);it(i,u)}catch(u){t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(t.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Br(i,e.loginHint),St(i,e.loginHint),n==null||n.addFields({loginHintFromRequest:!0},o));else t.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&ya(i,e.nonce),e.state&&$n(i,e.state),(e.claims||r.clientCapabilities&&r.clientCapabilities.length>0)&&ir(i,e.claims,r.clientCapabilities),e.embeddedClientId&&at(i,r.clientId,r.redirectUri),r.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes($r))&&Kn(i),i}function rm(r,e){let t=Ge(e);return R.appendQueryString(r.authorizationEndpoint,t)}function nm(r,e){if(gd(r,e),!r.code)throw p(Wt);return r}function gd(r,e){if(!r.state||!e)throw r.state?p(pt,"Cached State"):p(pt,"Server State");let t,n;try{t=decodeURIComponent(r.state)}catch(o){throw p(xe,r.state)}try{n=decodeURIComponent(e)}catch(o){throw p(xe,r.state)}if(t!==n)throw p($t);if(r.error||r.error_description||r.suberror){let o=om(r);throw hi(r.error,r.error_description,r.suberror)?new Oe(r.error||"",r.error_description,r.suberror,r.timestamp||"",r.trace_id||"",r.correlation_id||"",r.claims||"",o):new we(r.error||"",r.error_description,r.suberror,o)}}function om(r){var n,o;let e="code=",t=(n=r.error_uri)==null?void 0:n.lastIndexOf(e);return t&&t>=0?(o=r.error_uri)==null?void 0:o.substring(t+e.length):void 0}function im(r){var e;return((e=r.idTokenClaims)==null?void 0:e.sid)||null}function sm(r){var e;return((e=r.idTokenClaims)==null?void 0:e.login_hint)||null}var Ed=",",Td="|";function am(r){let{skus:e,libraryName:t,libraryVersion:n,extensionName:o,extensionVersion:i}=r,s=new Map([[0,[t,n]],[2,[o,i]]]),a=[];if(e!=null&&e.length){if(a=e.split(Ed),a.length<4)return e}else a=Array.from({length:4},()=>Td);return s.forEach((c,d)=>{var l,u;c.length===2&&((l=c[0])!=null&&l.length)&&((u=c[1])!=null&&u.length)&&cm({skuArr:a,index:d,skuName:c[0],skuVersion:c[1]})}),a.join(Ed)}function cm(r){let{skuArr:e,index:t,skuName:n,skuVersion:o}=r;t>=e.length||(e[t]=[n,o].join(Td))}var Rt=class{constructor(e,t){this.cacheOutcome=U.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||f.EMPTY_STRING,this.wrapperVer=e.wrapperVer||f.EMPTY_STRING,this.telemetryCacheKey=Y.CACHE_KEY+$.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${Y.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n!=null&&n.length&&t.push(`broker_error=${n}`);let o=t.join(Y.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),s=[e,i].join(Y.VALUE_SEPARATOR);return[Y.SCHEMA_VERSION,s,o].join(Y.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=Rt.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(Y.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(Y.VALUE_SEPARATOR),i=e.errors.length,s=t<i?Y.OVERFLOW_TRUE:Y.OVERFLOW_FALSE,a=[i,s].join(Y.VALUE_SEPARATOR);return[Y.SCHEMA_VERSION,e.cacheHits,n,o,a].join(Y.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=Y.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof N?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Y.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),t=Rt.maxErrorsToSend(e),n=e.errors.length;if(t===n)this.cacheManager.removeItem(this.telemetryCacheKey);else{let o={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}}static maxErrorsToSend(e){let t,n=0,o=0,i=e.errors.length;for(t=0;t<i;t++){let s=e.failedRequests[2*t]||f.EMPTY_STRING,a=e.failedRequests[2*t+1]||f.EMPTY_STRING,c=e.errors[t]||f.EMPTY_STRING;if(o+=s.toString().length+a.toString().length+c.length+3,o<Y.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||f.EMPTY_STRING),e.push(this.regionSource||f.EMPTY_STRING),e.push(this.regionOutcome||f.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return am(e)}};var kt=class{static deserializeJSONBlob(e){return e?JSON.parse(e):{}}static deserializeAccounts(e){let t={};return e&&Object.keys(e).map(function(n){var a;let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,realm:o.realm,localAccountId:o.local_account_id,username:o.username,authorityType:o.authority_type,name:o.name,clientInfo:o.client_info,lastModificationTime:o.last_modification_time,lastModificationApp:o.last_modification_app,tenantProfiles:(a=o.tenantProfiles)==null?void 0:a.map(c=>JSON.parse(c))},s=new Q;It.toObject(s,i),t[n]=s}),t}static deserializeIdTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm};t[n]=i}),t}static deserializeAccessTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,realm:o.realm,target:o.target,cachedAt:o.cached_at,expiresOn:o.expires_on,extendedExpiresOn:o.extended_expires_on,refreshOn:o.refresh_on,keyId:o.key_id,tokenType:o.token_type,requestedClaims:o.requestedClaims,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:o.userAssertionHash};t[n]=i}),t}static deserializeRefreshTokens(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n],i={homeAccountId:o.home_account_id,environment:o.environment,credentialType:o.credential_type,clientId:o.client_id,secret:o.secret,familyId:o.family_id,target:o.target,realm:o.realm};t[n]=i}),t}static deserializeAppMetadata(e){let t={};return e&&Object.keys(e).map(function(n){let o=e[n];t[n]={clientId:o.client_id,environment:o.environment,familyId:o.family_id}}),t}static deserializeAllCache(e){return{accounts:e.Account?this.deserializeAccounts(e.Account):{},idTokens:e.IdToken?this.deserializeIdTokens(e.IdToken):{},accessTokens:e.AccessToken?this.deserializeAccessTokens(e.AccessToken):{},refreshTokens:e.RefreshToken?this.deserializeRefreshTokens(e.RefreshToken):{},appMetadata:e.AppMetadata?this.deserializeAppMetadata(e.AppMetadata):{}}}};var lm="managed_identity",um=`https://login.microsoftonline.com/${lm}/`,ie={AZURE_POD_IDENTITY_AUTHORITY_HOST:"AZURE_POD_IDENTITY_AUTHORITY_HOST",IDENTITY_ENDPOINT:"IDENTITY_ENDPOINT",IDENTITY_HEADER:"IDENTITY_HEADER",IDENTITY_SERVER_THUMBPRINT:"IDENTITY_SERVER_THUMBPRINT",IMDS_ENDPOINT:"IMDS_ENDPOINT",MSI_ENDPOINT:"MSI_ENDPOINT",MSI_SECRET:"MSI_SECRET"};var He={SYSTEM_ASSIGNED:"system-assigned",USER_ASSIGNED_CLIENT_ID:"user-assigned-client-id",USER_ASSIGNED_RESOURCE_ID:"user-assigned-resource-id",USER_ASSIGNED_OBJECT_ID:"user-assigned-object-id"},J={GET:"get",POST:"post"},pi={SUCCESS:M.SUCCESS,SUCCESS_RANGE_START:M.SUCCESS_RANGE_START,SUCCESS_RANGE_END:M.SUCCESS_RANGE_END,SERVER_ERROR:M.SERVER_ERROR},yd="REGION_NAME",Ad="MSAL_FORCE_REGION",Cd=32,Id={SHA256:"sha256"},mi={CV_CHARSET:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~"},Ne={MSAL_SKU:"msal.js.node",JWT_BEARER_ASSERTION_TYPE:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",AUTHORIZATION_PENDING:"authorization_pending",HTTP_PROTOCOL:"http://",LOCALHOST:"localhost"},wt={acquireTokenSilent:62,acquireTokenByUsernamePassword:371,acquireTokenByDeviceCode:671,acquireTokenByClientCredential:771,acquireTokenByCode:871,acquireTokenByRefreshToken:872},ve={ALGORITHM:"alg",RSA_256:"RS256",PSS_256:"PS256",X5T_256:"x5t#S256",X5T:"x5t",X5C:"x5c",AUDIENCE:"aud",EXPIRATION_TIME:"exp",ISSUER:"iss",SUBJECT:"sub",NOT_BEFORE:"nbf",JWT_ID:"jti"};var hm=[M.NOT_FOUND,M.REQUEST_TIMEOUT,M.TOO_MANY_REQUESTS,M.SERVER_ERROR,M.SERVICE_UNAVAILABLE,M.GATEWAY_TIMEOUT];var Kr=class{static getNetworkResponse(e,t,n){return{headers:e,body:t,status:n}}static urlToHttpOptions(e){let t={protocol:e.protocol,hostname:e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return e.port!==""&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${decodeURIComponent(e.username)}:${decodeURIComponent(e.password)}`),t}};var gi=Se(require("http"),1),wa=Se(require("https"),1);var Zn=class{constructor(e,t){this.proxyUrl=e||"",this.customAgentOptions=t||{}}async sendGetRequestAsync(e,t,n){return this.proxyUrl?Sd(e,this.proxyUrl,J.GET,t,this.customAgentOptions,n):_d(e,J.GET,t,this.customAgentOptions,n)}async sendPostRequestAsync(e,t){return this.proxyUrl?Sd(e,this.proxyUrl,J.POST,t,this.customAgentOptions):_d(e,J.POST,t,this.customAgentOptions)}},Sd=(r,e,t,n,o,i)=>{let s=new URL(r),a=new URL(e),c=(n==null?void 0:n.headers)||{},d={host:a.hostname,port:a.port,method:"CONNECT",path:s.hostname,headers:c};o&&Object.keys(o).length&&(d.agent=new gi.default.Agent(o));let l="";if(t===J.POST){let g=(n==null?void 0:n.body)||"";l=`Content-Type: application/x-www-form-urlencoded\r
Content-Length: ${g.length}\r
\r
${g}`}else i&&(d.timeout=i);let u=`${t.toUpperCase()} ${s.href} HTTP/1.1\r
Host: ${s.host}\r
Connection: close\r
`+l+`\r
`;return new Promise((g,m)=>{let A=gi.default.request(d);i&&A.on("timeout",()=>{A.destroy(),m(new Error("Request time out"))}),A.end(),A.on("connect",(C,L)=>{let K=(C==null?void 0:C.statusCode)||pi.SERVER_ERROR;(K<pi.SUCCESS_RANGE_START||K>pi.SUCCESS_RANGE_END)&&(A.destroy(),L.destroy(),m(new Error(`Error connecting to proxy. Http status code: ${C.statusCode}. Http status message: ${(C==null?void 0:C.statusMessage)||"Unknown"}`))),L.write(u);let V=[];L.on("data",ee=>{V.push(ee)}),L.on("end",()=>{let me=Buffer.concat([...V]).toString().split(`\r
`),ze=parseInt(me[0].split(" ")[1]),Io=me[0].split(" ").slice(2).join(" "),So=me[me.length-1],ls=me.slice(1,me.length-2),_o=new Map;ls.forEach(Lf=>{let Fc=Lf.split(new RegExp(/:\s(.*)/s)),Uf=Fc[0],hs=Fc[1];try{let Ro=JSON.parse(hs);Ro&&typeof Ro=="object"&&(hs=Ro)}catch(Ro){}_o.set(Uf,hs)});let Uc=Object.fromEntries(_o),Hc=Kr.getNetworkResponse(Uc,Rd(ze,Io,Uc,So),ze);(ze<M.SUCCESS_RANGE_START||ze>M.SUCCESS_RANGE_END)&&Hc.body.error!==Ne.AUTHORIZATION_PENDING&&A.destroy(),g(Hc)}),L.on("error",ee=>{A.destroy(),L.destroy(),m(new Error(ee.toString()))})}),A.on("error",C=>{A.destroy(),m(new Error(C.toString()))})})},_d=(r,e,t,n,o)=>{let i=e===J.POST,s=(t==null?void 0:t.body)||"",a=new URL(r),c=(t==null?void 0:t.headers)||{},d={method:e,headers:c,...Kr.urlToHttpOptions(a)};return n&&Object.keys(n).length&&(d.agent=new wa.default.Agent(n)),i?d.headers={...d.headers,"Content-Length":s.length}:o&&(d.timeout=o),new Promise((l,u)=>{let g;d.protocol==="http:"?g=gi.default.request(d):g=wa.default.request(d),i&&g.write(s),o&&g.on("timeout",()=>{g.destroy(),u(new Error("Request time out"))}),g.end(),g.on("response",m=>{let A=m.headers,C=m.statusCode,L=m.statusMessage,K=[];m.on("data",V=>{K.push(V)}),m.on("end",()=>{let V=Buffer.concat([...K]).toString(),ee=A,me=Kr.getNetworkResponse(ee,Rd(C,L,ee,V),C);(C<M.SUCCESS_RANGE_START||C>M.SUCCESS_RANGE_END)&&me.body.error!==Ne.AUTHORIZATION_PENDING&&g.destroy(),l(me)})}),g.on("error",m=>{g.destroy(),u(new Error(m.toString()))})})},Rd=(r,e,t,n)=>{let o;try{o=JSON.parse(n)}catch(i){let s,a;r>=M.CLIENT_ERROR_RANGE_START&&r<=M.CLIENT_ERROR_RANGE_END?(s="client_error",a="A client"):r>=M.SERVER_ERROR_RANGE_START&&r<=M.SERVER_ERROR_RANGE_END?(s="server_error",a="A server"):(s="unknown_error",a="An unknown"),o={error:s,error_description:`${a} error occured.
Http status code: ${r}
Http status message: ${e||"Unknown"}
Headers: ${JSON.stringify(t)}`}}return o};var Oa="invalid_file_extension",Na="invalid_file_path",eo="invalid_managed_identity_id_type",va="invalid_secret",kd="missing_client_id",wd="network_unavailable",ba="platform_not_supported",Ma="unable_to_create_azure_arc",Pa="unable_to_create_cloud_shell",Da="unable_to_create_source",xa="unable_to_read_secret_file",Od="user_assigned_not_available_at_runtime",La="www_authenticate_header_missing",Ua="www_authenticate_header_unsupported_format",hr={[ie.AZURE_POD_IDENTITY_AUTHORITY_HOST]:"azure_pod_identity_authority_host_url_malformed",[ie.IDENTITY_ENDPOINT]:"identity_endpoint_url_malformed",[ie.IMDS_ENDPOINT]:"imds_endpoint_url_malformed",[ie.MSI_ENDPOINT]:"msi_endpoint_url_malformed"};var fm={[Oa]:"The file path in the WWW-Authenticate header does not contain a .key file.",[Na]:"The file path in the WWW-Authenticate header is not in a valid Windows or Linux Format.",[eo]:"More than one ManagedIdentityIdType was provided.",[va]:"The secret in the file on the file path in the WWW-Authenticate header is greater than 4096 bytes.",[ba]:"The platform is not supported by Azure Arc. Azure Arc only supports Windows and Linux.",[kd]:"A ManagedIdentityId id was not provided.",[hr.AZURE_POD_IDENTITY_AUTHORITY_HOST]:`The Managed Identity's '${ie.AZURE_POD_IDENTITY_AUTHORITY_HOST}' environment variable is malformed.`,[hr.IDENTITY_ENDPOINT]:`The Managed Identity's '${ie.IDENTITY_ENDPOINT}' environment variable is malformed.`,[hr.IMDS_ENDPOINT]:`The Managed Identity's '${ie.IMDS_ENDPOINT}' environment variable is malformed.`,[hr.MSI_ENDPOINT]:`The Managed Identity's '${ie.MSI_ENDPOINT}' environment variable is malformed.`,[wd]:"Authentication unavailable. The request to the managed identity endpoint timed out.",[Ma]:"Azure Arc Managed Identities can only be system assigned.",[Pa]:"Cloud Shell Managed Identities can only be system assigned.",[Da]:"Unable to create a Managed Identity source based on environment variables.",[xa]:"Unable to read the secret file.",[Od]:"Service Fabric user assigned managed identity ClientId or ResourceId is not configurable at runtime.",[La]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is missing.",[Ua]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is in an unsupported format."},to=class extends N{constructor(e){super(e,fm[e]),this.name="ManagedIdentityError",Object.setPrototypeOf(this,to.prototype)}};function fr(r){return new to(r)}var te={invalidLoopbackAddressType:{code:"invalid_loopback_server_address_type",desc:"Loopback server address is not type string. This is unexpected."},unableToLoadRedirectUri:{code:"unable_to_load_redirectUrl",desc:"Loopback server callback was invoked without a url. This is unexpected."},noAuthCodeInResponse:{code:"no_auth_code_in_response",desc:"No auth code found in the server response. Please check your network trace to determine what happened."},noLoopbackServerExists:{code:"no_loopback_server_exists",desc:"No loopback server exists yet."},loopbackServerAlreadyExists:{code:"loopback_server_already_exists",desc:"Loopback server already exists. Cannot create another."},loopbackServerTimeout:{code:"loopback_server_timeout",desc:"Timed out waiting for auth code listener to be registered."},stateNotFoundError:{code:"state_not_found",desc:"State not found. Please verify that the request originated from msal."},thumbprintMissing:{code:"thumbprint_missing_from_client_certificate",desc:"Client certificate does not contain a SHA-1 or SHA-256 thumbprint."}},re=class extends N{constructor(e,t){super(e,t),this.name="NodeAuthError"}static createInvalidLoopbackAddressTypeError(){return new re(te.invalidLoopbackAddressType.code,`${te.invalidLoopbackAddressType.desc}`)}static createUnableToLoadRedirectUrlError(){return new re(te.unableToLoadRedirectUri.code,`${te.unableToLoadRedirectUri.desc}`)}static createNoAuthCodeInResponseError(){return new re(te.noAuthCodeInResponse.code,`${te.noAuthCodeInResponse.desc}`)}static createNoLoopbackServerExistsError(){return new re(te.noLoopbackServerExists.code,`${te.noLoopbackServerExists.desc}`)}static createLoopbackServerAlreadyExistsError(){return new re(te.loopbackServerAlreadyExists.code,`${te.loopbackServerAlreadyExists.desc}`)}static createLoopbackServerTimeoutError(){return new re(te.loopbackServerTimeout.code,`${te.loopbackServerTimeout.desc}`)}static createStateNotFoundError(){return new re(te.stateNotFoundError.code,te.stateNotFoundError.desc)}static createThumbprintMissingError(){return new re(te.thumbprintMissing.code,te.thumbprintMissing.desc)}};var pm={clientId:f.EMPTY_STRING,authority:f.DEFAULT_AUTHORITY,clientSecret:f.EMPTY_STRING,clientAssertion:f.EMPTY_STRING,clientCertificate:{thumbprint:f.EMPTY_STRING,thumbprintSha256:f.EMPTY_STRING,privateKey:f.EMPTY_STRING,x5c:f.EMPTY_STRING},knownAuthorities:[],cloudDiscoveryMetadata:f.EMPTY_STRING,authorityMetadata:f.EMPTY_STRING,clientCapabilities:[],protocolMode:ke.AAD,azureCloudOptions:{azureCloudInstance:Zt.None,tenant:f.EMPTY_STRING},skipAuthorityMetadataCache:!1},mm={claimsBasedCachingEnabled:!1},Nd={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:q.Info},gm={loggerOptions:Nd,networkClient:new Zn,proxyUrl:f.EMPTY_STRING,customAgentOptions:{},disableInternalRetries:!1},Em={application:{appName:f.EMPTY_STRING,appVersion:f.EMPTY_STRING}};function vd({auth:r,broker:e,cache:t,system:n,telemetry:o}){let i={...gm,networkClient:new Zn(n==null?void 0:n.proxyUrl,n==null?void 0:n.customAgentOptions),loggerOptions:(n==null?void 0:n.loggerOptions)||Nd,disableInternalRetries:(n==null?void 0:n.disableInternalRetries)||!1};if(r.clientCertificate&&!r.clientCertificate.thumbprint&&!r.clientCertificate.thumbprintSha256)throw re.createStateNotFoundError();return{auth:{...pm,...r},broker:{...e},cache:{...mm,...t},system:{...i,...n},telemetry:{...Em,...o}}}var Ei,Tm=new Uint8Array(16);function Ha(){if(!Ei&&(Ei=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Ei))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ei(Tm)}var bd=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ym(r){return typeof r=="string"&&bd.test(r)}var Md=ym;var ne=[];for(Ti=0;Ti<256;++Ti)ne.push((Ti+256).toString(16).substr(1));var Ti;function Am(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(ne[r[e+0]]+ne[r[e+1]]+ne[r[e+2]]+ne[r[e+3]]+"-"+ne[r[e+4]]+ne[r[e+5]]+"-"+ne[r[e+6]]+ne[r[e+7]]+"-"+ne[r[e+8]]+ne[r[e+9]]+"-"+ne[r[e+10]]+ne[r[e+11]]+ne[r[e+12]]+ne[r[e+13]]+ne[r[e+14]]+ne[r[e+15]]).toLowerCase();if(!Md(t))throw TypeError("Stringified UUID is invalid");return t}var Pd=Am;function Cm(r,e,t){r=r||{};var n=r.random||(r.rng||Ha)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var o=0;o<16;++o)e[t+o]=n[o];return e}return Pd(n)}var Fa=Cm;var yi=class{generateGuid(){return Fa()}isGuid(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}};var se=class{static base64Encode(e,t){return Buffer.from(e,t).toString("base64")}static base64EncodeUrl(e,t){return se.base64Encode(e,t).replace(/=/g,f.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")}static base64Decode(e){return Buffer.from(e,"base64").toString("utf8")}static base64DecodeUrl(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4;)t+="=";return se.base64Decode(t)}};var Dd=Se(require("crypto"),1);var jr=class{sha256(e){return Dd.default.createHash(Id.SHA256).update(e).digest()}};var xd=Se(require("crypto"),1);var Ai=class{constructor(){this.hashUtils=new jr}async generatePkceCodes(){let e=this.generateCodeVerifier(),t=this.generateCodeChallengeFromVerifier(e);return{verifier:e,challenge:t}}generateCodeVerifier(){let e=[],t=256-256%mi.CV_CHARSET.length;for(;e.length<=Cd;){let o=xd.default.randomBytes(1)[0];if(o>=t)continue;let i=o%mi.CV_CHARSET.length;e.push(mi.CV_CHARSET[i])}let n=e.join(f.EMPTY_STRING);return se.base64EncodeUrl(n)}generateCodeChallengeFromVerifier(e){return se.base64EncodeUrl(this.hashUtils.sha256(e).toString("base64"),"base64")}};var Yr=class{constructor(){this.pkceGenerator=new Ai,this.guidGenerator=new yi,this.hashUtils=new jr}base64UrlEncode(){throw new Error("Method not implemented.")}encodeKid(){throw new Error("Method not implemented.")}createNewGuid(){return this.guidGenerator.generateGuid()}base64Encode(e){return se.base64Encode(e)}base64Decode(e){return se.base64Decode(e)}generatePkceCodes(){return this.pkceGenerator.generatePkceCodes()}getPublicKeyThumbprint(){throw new Error("Method not implemented.")}removeTokenBindingKey(){throw new Error("Method not implemented.")}clearKeystore(){throw new Error("Method not implemented.")}signJwt(){throw new Error("Method not implemented.")}async hashString(e){return se.base64EncodeUrl(this.hashUtils.sha256(e).toString("base64"),"base64")}};var pr=class extends It{constructor(e,t,n,o){super(t,n,e,o),this.cache={},this.changeEmitters=[],this.logger=e}registerChangeEmitter(e){this.changeEmitters.push(e)}emitChange(){this.changeEmitters.forEach(e=>e.call(null))}cacheToInMemoryCache(e){let t={accounts:{},idTokens:{},accessTokens:{},refreshTokens:{},appMetadata:{}};for(let n in e){let o=e[n];if(typeof o=="object")if(o instanceof Q)t.accounts[n]=o;else if(W.isIdTokenEntity(o))t.idTokens[n]=o;else if(W.isAccessTokenEntity(o))t.accessTokens[n]=o;else if(W.isRefreshTokenEntity(o))t.refreshTokens[n]=o;else if(W.isAppMetadataEntity(n,o))t.appMetadata[n]=o;else continue}return t}inMemoryCacheToCache(e){let t=this.getCache();return t={...t,...e.accounts,...e.idTokens,...e.accessTokens,...e.refreshTokens,...e.appMetadata},t}getInMemoryCache(){return this.logger.trace("Getting in-memory cache"),this.cacheToInMemoryCache(this.getCache())}setInMemoryCache(e){this.logger.trace("Setting in-memory cache");let t=this.inMemoryCacheToCache(e);this.setCache(t),this.emitChange()}getCache(){return this.logger.trace("Getting cache key-value store"),this.cache}setCache(e){this.logger.trace("Setting cache key value store"),this.cache=e,this.emitChange()}getItem(e){return this.logger.tracePii(`Item key: ${e}`),this.getCache()[e]}setItem(e,t){this.logger.tracePii(`Item key: ${e}`);let n=this.getCache();n[e]=t,this.setCache(n)}getAccountKeys(){let e=this.getInMemoryCache();return Object.keys(e.accounts)}getTokenKeys(){let e=this.getInMemoryCache();return{idToken:Object.keys(e.idTokens),accessToken:Object.keys(e.accessTokens),refreshToken:Object.keys(e.refreshTokens)}}getAccount(e){return this.getItem(e)?Object.assign(new Q,this.getItem(e)):null}async setAccount(e){let t=e.generateAccountKey();this.setItem(t,e)}getIdTokenCredential(e){let t=this.getItem(e);return W.isIdTokenEntity(t)?t:null}async setIdTokenCredential(e){let t=W.generateCredentialKey(e);this.setItem(t,e)}getAccessTokenCredential(e){let t=this.getItem(e);return W.isAccessTokenEntity(t)?t:null}async setAccessTokenCredential(e){let t=W.generateCredentialKey(e);this.setItem(t,e)}getRefreshTokenCredential(e){let t=this.getItem(e);return W.isRefreshTokenEntity(t)?t:null}async setRefreshTokenCredential(e){let t=W.generateCredentialKey(e);this.setItem(t,e)}getAppMetadata(e){let t=this.getItem(e);return W.isAppMetadataEntity(e,t)?t:null}setAppMetadata(e){let t=W.generateAppMetadataKey(e);this.setItem(t,e)}getServerTelemetry(e){let t=this.getItem(e);return t&&W.isServerTelemetryEntity(e,t)?t:null}setServerTelemetry(e,t){this.setItem(e,t)}getAuthorityMetadata(e){let t=this.getItem(e);return t&&W.isAuthorityMetadataEntity(e,t)?t:null}getAuthorityMetadataKeys(){return this.getKeys().filter(e=>this.isAuthorityMetadata(e))}setAuthorityMetadata(e,t){this.setItem(e,t)}getThrottlingCache(e){let t=this.getItem(e);return t&&W.isThrottlingEntity(e,t)?t:null}setThrottlingCache(e,t){this.setItem(e,t)}removeItem(e){this.logger.tracePii(`Item key: ${e}`);let t=!1,n=this.getCache();return n[e]&&(delete n[e],t=!0),t&&(this.setCache(n),this.emitChange()),t}removeOutdatedAccount(e){this.removeItem(e)}containsKey(e){return this.getKeys().includes(e)}getKeys(){this.logger.trace("Retrieving all cache keys");let e=this.getCache();return[...Object.keys(e)]}clear(){this.logger.trace("Clearing cache entries created by MSAL"),this.getKeys().forEach(t=>{this.removeItem(t)}),this.emitChange()}static generateInMemoryCache(e){return kt.deserializeAllCache(kt.deserializeJSONBlob(e))}static generateJsonCache(e){return Pt.serializeAllCache(e)}updateCredentialCacheKey(e,t){let n=W.generateCredentialKey(t);if(e!==n){let o=this.getItem(e);if(o)return this.removeItem(e),this.setItem(n,o),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}};var ro={Account:{},IdToken:{},AccessToken:{},RefreshToken:{},AppMetadata:{}},no=class{constructor(e,t,n){this.cacheHasChanged=!1,this.storage=e,this.storage.registerChangeEmitter(this.handleChangeEvent.bind(this)),n&&(this.persistence=n),this.logger=t}hasChanged(){return this.cacheHasChanged}serialize(){this.logger.trace("Serializing in-memory cache");let e=Pt.serializeAllCache(this.storage.getInMemoryCache());return this.cacheSnapshot?(this.logger.trace("Reading cache snapshot from disk"),e=this.mergeState(JSON.parse(this.cacheSnapshot),e)):this.logger.trace("No cache snapshot to merge"),this.cacheHasChanged=!1,JSON.stringify(e)}deserialize(e){if(this.logger.trace("Deserializing JSON to in-memory cache"),this.cacheSnapshot=e,this.cacheSnapshot){this.logger.trace("Reading cache snapshot from disk");let t=kt.deserializeAllCache(this.overlayDefaults(JSON.parse(this.cacheSnapshot)));this.storage.setInMemoryCache(t)}else this.logger.trace("No cache snapshot to deserialize")}getKVStore(){return this.storage.getCache()}getCacheSnapshot(){let e=pr.generateInMemoryCache(this.cacheSnapshot);return this.storage.inMemoryCacheToCache(e)}async getAllAccounts(){this.logger.trace("getAllAccounts called");let e;try{return this.persistence&&(e=new Ue(this,!1),await this.persistence.beforeCacheAccess(e)),this.storage.getAllAccounts()}finally{this.persistence&&e&&await this.persistence.afterCacheAccess(e)}}async getAccountByHomeId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.homeAccountId===e)[0]||null}async getAccountByLocalId(e){let t=await this.getAllAccounts();return e&&t&&t.length&&t.filter(n=>n.localAccountId===e)[0]||null}async removeAccount(e){this.logger.trace("removeAccount called");let t;try{this.persistence&&(t=new Ue(this,!0),await this.persistence.beforeCacheAccess(t)),await this.storage.removeAccount(Q.generateAccountCacheKey(e))}finally{this.persistence&&t&&await this.persistence.afterCacheAccess(t)}}async overwriteCache(){if(!this.persistence){this.logger.info("No persistence layer specified, cache cannot be overwritten");return}this.logger.info("Overwriting in-memory cache with persistent cache"),this.storage.clear();let e=new Ue(this,!1);await this.persistence.beforeCacheAccess(e);let t=this.getCacheSnapshot();this.storage.setCache(t),await this.persistence.afterCacheAccess(e)}handleChangeEvent(){this.cacheHasChanged=!0}mergeState(e,t){this.logger.trace("Merging in-memory cache with cache snapshot");let n=this.mergeRemovals(e,t);return this.mergeUpdates(n,t)}mergeUpdates(e,t){return Object.keys(t).forEach(n=>{let o=t[n];if(!e.hasOwnProperty(n))o!==null&&(e[n]=o);else{let i=o!==null,s=typeof o=="object",a=!Array.isArray(o),c=typeof e[n]!="undefined"&&e[n]!==null;i&&s&&a&&c?this.mergeUpdates(e[n],o):e[n]=o}}),e}mergeRemovals(e,t){this.logger.trace("Remove updated entries in cache");let n=e.Account?this.mergeRemovalsDict(e.Account,t.Account):e.Account,o=e.AccessToken?this.mergeRemovalsDict(e.AccessToken,t.AccessToken):e.AccessToken,i=e.RefreshToken?this.mergeRemovalsDict(e.RefreshToken,t.RefreshToken):e.RefreshToken,s=e.IdToken?this.mergeRemovalsDict(e.IdToken,t.IdToken):e.IdToken,a=e.AppMetadata?this.mergeRemovalsDict(e.AppMetadata,t.AppMetadata):e.AppMetadata;return{...e,Account:n,AccessToken:o,RefreshToken:i,IdToken:s,AppMetadata:a}}mergeRemovalsDict(e,t){let n={...e};return Object.keys(e).forEach(o=>{(!t||!t.hasOwnProperty(o))&&delete n[o]}),n}overlayDefaults(e){return this.logger.trace("Overlaying input cache with the default cache"),{Account:{...ro.Account,...e.Account},IdToken:{...ro.IdToken,...e.IdToken},AccessToken:{...ro.AccessToken,...e.AccessToken},RefreshToken:{...ro.RefreshToken,...e.RefreshToken},AppMetadata:{...ro.AppMetadata,...e.AppMetadata}}}};var mf=Se(pf(),1);var Pe=class{static fromAssertion(e){let t=new Pe;return t.jwt=e,t}static fromCertificate(e,t,n){let o=new Pe;return o.privateKey=t,o.thumbprint=e,o.useSha256=!1,n&&(o.publicCertificate=this.parseCertificate(n)),o}static fromCertificateWithSha256Thumbprint(e,t,n){let o=new Pe;return o.privateKey=t,o.thumbprint=e,o.useSha256=!0,n&&(o.publicCertificate=this.parseCertificate(n)),o}getJwt(e,t,n){if(this.privateKey&&this.thumbprint)return this.jwt&&!this.isExpired()&&t===this.issuer&&n===this.jwtAudience?this.jwt:this.createJwt(e,t,n);if(this.jwt)return this.jwt;throw p(z.invalidAssertion)}createJwt(e,t,n){this.issuer=t,this.jwtAudience=n;let o=Z.nowSeconds();this.expirationTime=o+600;let s={alg:this.useSha256?ve.PSS_256:ve.RSA_256},a=this.useSha256?ve.X5T_256:ve.X5T;Object.assign(s,{[a]:se.base64EncodeUrl(this.thumbprint,"hex")}),this.publicCertificate&&Object.assign(s,{[ve.X5C]:this.publicCertificate});let c={[ve.AUDIENCE]:this.jwtAudience,[ve.EXPIRATION_TIME]:this.expirationTime,[ve.ISSUER]:this.issuer,[ve.SUBJECT]:this.issuer,[ve.NOT_BEFORE]:o,[ve.JWT_ID]:e.createNewGuid()};return this.jwt=mf.default.sign(c,this.privateKey,{header:s}),this.jwt}isExpired(){return this.expirationTime<Z.nowSeconds()}static parseCertificate(e){let t=/-----BEGIN CERTIFICATE-----\r*\n(.+?)\r*\n-----END CERTIFICATE-----/gs,n=[],o;for(;(o=t.exec(e))!==null;)n.push(o[1].replace(/\r*\n/g,f.EMPTY_STRING));return n}};var Sc="@azure/msal-node",vt="3.4.1";var go=class extends ue{constructor(e){super(e)}async acquireToken(e){this.logger.info("in acquireToken call in username-password client");let t=Z.nowSeconds(),n=await this.executeTokenRequest(this.authority,e),o=new G(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n.body),o.handleServerTokenResponse(n.body,this.authority,t,e)}async executeTokenRequest(e,t){let n=this.createTokenQueryParameters(t),o=R.appendQueryString(e.tokenEndpoint,n),i=await this.createTokenRequestBody(t),s=this.createTokenRequestHeaders({credential:t.username,type:le.UPN}),a={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return this.executePostToTokenEndpoint(o,i,s,a,t.correlationId)}async createTokenRequestBody(e){let t=new Map;I.addClientId(t,this.config.authOptions.clientId),I.addUsername(t,e.username),I.addPassword(t,e.password),I.addScopes(t,e.scopes),I.addResponseType(t,dn.IDTOKEN_TOKEN),I.addGrantType(t,De.RESOURCE_OWNER_PASSWORD_GRANT),I.addClientInfo(t),I.addLibraryInfo(t,this.config.libraryInfo),I.addApplicationTelemetry(t,this.config.telemetry.application),I.addThrottling(t),this.serverTelemetryManager&&I.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();I.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&I.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(I.addClientAssertion(t,await he(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),I.addClientAssertionType(t,o.assertionType)),(!B.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.username&&I.addCcsUpn(t,e.username),At.mapToQueryString(t)}};function gf(r,e,t,n){let o=Jn.getStandardAuthorizeRequestParameters({...r.auth,authority:e,redirectUri:t.redirectUri||""},t,n);return I.addLibraryInfo(o,{sku:Ne.MSAL_SKU,version:vt,cpu:process.arch||"",os:process.platform||""}),r.auth.protocolMode!==ke.OIDC&&I.addApplicationTelemetry(o,r.telemetry.application),I.addResponseType(o,dn.CODE),t.codeChallenge&&t.codeChallengeMethod&&I.addCodeChallengeParams(o,t.codeChallenge,t.codeChallengeMethod),I.addExtraQueryParameters(o,t.extraQueryParameters||{}),Jn.getAuthorizeUrl(e,o)}var on=class{constructor(e){this.config=vd(e),this.cryptoProvider=new Yr,this.logger=new _e(this.config.system.loggerOptions,Sc,vt),this.storage=new pr(this.logger,this.config.auth.clientId,this.cryptoProvider,_a(this.config.auth)),this.tokenCache=new no(this.storage,this.logger,this.config.cache.cachePlugin)}async getAuthCodeUrl(e){this.logger.info("getAuthCodeUrl called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),responseMode:e.responseMode||ln.QUERY,authenticationScheme:O.BEARER,state:e.state||"",nonce:e.nonce||""},n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions);return gf(this.config,n,t,this.logger)}async acquireTokenByCode(e,t){this.logger.info("acquireTokenByCode called"),e.state&&t&&(this.logger.info("acquireTokenByCode - validating state"),this.validateState(e.state,t.state||""),t={...t,state:""});let n={...e,...await this.initializeBaseRequest(e),authenticationScheme:O.BEARER},o=this.initializeServerTelemetryManager(wt.acquireTokenByCode,n.correlationId);try{let i=await this.createAuthority(n.authority,n.correlationId,void 0,e.azureCloudOptions),s=await this.buildOauthClientConfiguration(i,n.correlationId,n.redirectUri,o),a=new Qn(s);return this.logger.verbose("Auth code client created",n.correlationId),await a.acquireToken(n,t)}catch(i){throw i instanceof N&&i.setCorrelationId(n.correlationId),o.cacheFailedRequest(i),i}}async acquireTokenByRefreshToken(e){this.logger.info("acquireTokenByRefreshToken called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e),authenticationScheme:O.BEARER},n=this.initializeServerTelemetryManager(wt.acquireTokenByRefreshToken,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),s=new ur(i);return this.logger.verbose("Refresh token client created",t.correlationId),await s.acquireToken(t)}catch(o){throw o instanceof N&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireTokenSilent(e){let t={...e,...await this.initializeBaseRequest(e),forceRefresh:e.forceRefresh||!1},n=this.initializeServerTelemetryManager(wt.acquireTokenSilent,t.correlationId,t.forceRefresh);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,t.redirectUri||"",n),s=new Xn(i);this.logger.verbose("Silent flow client created",t.correlationId);try{return await this.tokenCache.overwriteCache(),await this.acquireCachedTokenSilent(t,s,i)}catch(a){if(a instanceof Et&&a.errorCode===z.tokenRefreshRequired)return new ur(i).acquireTokenByRefreshToken(t);throw a}}catch(o){throw o instanceof N&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}async acquireCachedTokenSilent(e,t,n){var s;let[o,i]=await t.acquireCachedToken({...e,scopes:(s=e.scopes)!=null&&s.length?e.scopes:[...Qe]});if(i===U.PROACTIVELY_REFRESHED){this.logger.info("ClientApplication:acquireCachedTokenSilent - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");let a=new ur(n);try{await a.acquireTokenByRefreshToken(e)}catch(c){}}return o}async acquireTokenByUsernamePassword(e){this.logger.info("acquireTokenByUsernamePassword called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)},n=this.initializeServerTelemetryManager(wt.acquireTokenByUsernamePassword,t.correlationId);try{let o=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(o,t.correlationId,"",n),s=new go(i);return this.logger.verbose("Username password client created",t.correlationId),await s.acquireToken(t)}catch(o){throw o instanceof N&&o.setCorrelationId(t.correlationId),n.cacheFailedRequest(o),o}}getTokenCache(){return this.logger.info("getTokenCache called"),this.tokenCache}validateState(e,t){if(!e)throw re.createStateNotFoundError();if(e!==t)throw p(z.stateMismatch)}getLogger(){return this.logger}setLogger(e){this.logger=e}async buildOauthClientConfiguration(e,t,n,o){return this.logger.verbose("buildOauthClientConfiguration called",t),this.logger.info(`Building oauth client configuration with the following authority: ${e.tokenEndpoint}.`,t),o==null||o.updateRegionDiscoveryMetadata(e.regionDiscoveryMetadata),{authOptions:{clientId:this.config.auth.clientId,authority:e,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:n},loggerOptions:{logLevel:this.config.system.loggerOptions.logLevel,loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,correlationId:t},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.cryptoProvider,networkInterface:this.config.system.networkClient,storageInterface:this.storage,serverTelemetryManager:o,clientCredentials:{clientSecret:this.clientSecret,clientAssertion:await this.getClientAssertion(e)},libraryInfo:{sku:Ne.MSAL_SKU,version:vt,cpu:process.arch||f.EMPTY_STRING,os:process.platform||f.EMPTY_STRING},telemetry:this.config.telemetry,persistencePlugin:this.config.cache.cachePlugin,serializableCache:this.tokenCache}}async getClientAssertion(e){return this.developerProvidedClientAssertion&&(this.clientAssertion=Pe.fromAssertion(await he(this.developerProvidedClientAssertion,this.config.auth.clientId,e.tokenEndpoint))),this.clientAssertion&&{assertion:this.clientAssertion.getJwt(this.cryptoProvider,this.config.auth.clientId,e.tokenEndpoint),assertionType:Ne.JWT_BEARER_ASSERTION_TYPE}}async initializeBaseRequest(e){return this.logger.verbose("initializeRequestScopes called",e.correlationId),e.authenticationScheme&&e.authenticationScheme===O.POP&&this.logger.verbose("Authentication Scheme 'pop' is not supported yet, setting Authentication Scheme to 'Bearer' for request",e.correlationId),e.authenticationScheme=O.BEARER,this.config.cache.claimsBasedCachingEnabled&&e.claims&&!B.isEmptyObj(e.claims)&&(e.requestedClaimsHash=await this.cryptoProvider.hashString(e.claims)),{...e,scopes:[...e&&e.scopes||[],...Qe],correlationId:e&&e.correlationId||this.cryptoProvider.createNewGuid(),authority:e.authority||this.config.auth.authority}}initializeServerTelemetryManager(e,t,n){let o={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:n||!1};return new Rt(o,this.storage)}async createAuthority(e,t,n,o){this.logger.verbose("createAuthority called",t);let i=X.generateAuthority(e,o||this.config.auth.azureCloudOptions),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,azureRegionConfiguration:n,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};return ci.createDiscoveredInstance(i,this.config.system.networkClient,this.storage,s,this.logger,t)}clearCache(){this.storage.clear()}};var kC=Se(require("http"),1);var sn=class extends ue{constructor(e,t){super(e),this.appTokenProvider=t}async acquireToken(e){if(e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority);let[t,n]=await this.getCachedAuthenticationResult(e,this.config,this.cryptoUtils,this.authority,this.cacheManager,this.serverTelemetryManager);if(t){if(n===U.PROACTIVELY_REFRESHED){this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");let o=!0;await this.executeTokenRequest(e,this.authority,o)}return t}else return this.executeTokenRequest(e,this.authority)}async getCachedAuthenticationResult(e,t,n,o,i,s){var g,m;let a=t,c=t,d=U.NOT_APPLICABLE,l;a.serializableCache&&a.persistencePlugin&&(l=new Ue(a.serializableCache,!1),await a.persistencePlugin.beforeCacheAccess(l));let u=this.readAccessTokenFromCache(o,((g=c.managedIdentityId)==null?void 0:g.id)||a.authOptions.clientId,new H(e.scopes||[]),i);return a.serializableCache&&a.persistencePlugin&&l&&await a.persistencePlugin.afterCacheAccess(l),u?Z.isTokenExpired(u.expiresOn,((m=a.systemOptions)==null?void 0:m.tokenRenewalOffsetSeconds)||fn)?(s==null||s.setCacheOutcome(U.CACHED_ACCESS_TOKEN_EXPIRED),[null,U.CACHED_ACCESS_TOKEN_EXPIRED]):(u.refreshOn&&Z.isTokenExpired(u.refreshOn.toString(),0)&&(d=U.PROACTIVELY_REFRESHED,s==null||s.setCacheOutcome(U.PROACTIVELY_REFRESHED)),[await G.generateAuthenticationResult(n,o,{account:null,idToken:null,accessToken:u,refreshToken:null,appMetadata:null},!0,e),d]):(s==null||s.setCacheOutcome(U.NO_CACHED_ACCESS_TOKEN),[null,U.NO_CACHED_ACCESS_TOKEN])}readAccessTokenFromCache(e,t,n,o){let i={homeAccountId:f.EMPTY_STRING,environment:e.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:v.ACCESS_TOKEN,clientId:t,realm:e.tenant,target:H.createSearchScopes(n.asArray())},s=o.getAccessTokensByFilter(i);if(s.length<1)return null;if(s.length>1)throw p(z.multipleMatchingTokens);return s[0]}async executeTokenRequest(e,t,n){let o,i;if(this.appTokenProvider){this.logger.info("Using appTokenProvider extensibility.");let c={correlationId:e.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:e.scopes,claims:e.claims};i=Z.nowSeconds();let d=await this.appTokenProvider(c);o={access_token:d.accessToken,expires_in:d.expiresInSeconds,refresh_in:d.refreshInSeconds,token_type:O.BEARER}}else{let c=this.createTokenQueryParameters(e),d=R.appendQueryString(t.tokenEndpoint,c),l=await this.createTokenRequestBody(e),u=this.createTokenRequestHeaders(),g={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};this.logger.info("Sending token request to endpoint: "+t.tokenEndpoint),i=Z.nowSeconds();let m=await this.executePostToTokenEndpoint(d,l,u,g,e.correlationId);o=m.body,o.status=m.status}let s=new G(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return s.validateTokenResponse(o,n),await s.handleServerTokenResponse(o,this.authority,i,e)}async createTokenRequestBody(e){let t=new Map;I.addClientId(t,this.config.authOptions.clientId),I.addScopes(t,e.scopes,!1),I.addGrantType(t,De.CLIENT_CREDENTIALS_GRANT),I.addLibraryInfo(t,this.config.libraryInfo),I.addApplicationTelemetry(t,this.config.telemetry.application),I.addThrottling(t),this.serverTelemetryManager&&I.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();I.addCorrelationId(t,n),this.config.clientCredentials.clientSecret&&I.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=e.clientAssertion||this.config.clientCredentials.clientAssertion;return o&&(I.addClientAssertion(t,await he(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),I.addClientAssertionType(t,o.assertionType)),(!B.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),At.mapToQueryString(t)}};var Eo=class extends ue{constructor(e){super(e)}async acquireToken(e){if(this.scopeSet=new H(e.scopes||[]),this.userAssertionHash=await this.cryptoUtils.hashString(e.oboAssertion),e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority,this.userAssertionHash);try{return await this.getCachedAuthenticationResult(e)}catch(t){return await this.executeTokenRequest(e,this.authority,this.userAssertionHash)}}async getCachedAuthenticationResult(e){var s,a;let t=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,e);if(t){if(Z.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(a=this.serverTelemetryManager)==null||a.setCacheOutcome(U.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info(`OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),p(z.tokenRefreshRequired)}else throw(s=this.serverTelemetryManager)==null||s.setCacheOutcome(U.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),p(z.tokenRefreshRequired);let n=this.readIdTokenFromCacheForOBO(t.homeAccountId),o,i=null;if(n){o=Fo.extractTokenClaims(n.secret,se.base64Decode);let c=o.oid||o.sub,d={homeAccountId:n.homeAccountId,environment:n.environment,tenantId:n.realm,username:f.EMPTY_STRING,localAccountId:c||f.EMPTY_STRING};i=this.cacheManager.readAccountFromCache(d)}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),G.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:i,accessToken:t,idToken:n,refreshToken:null,appMetadata:null},!0,e,o)}readIdTokenFromCacheForOBO(e){let t={homeAccountId:e,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:v.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},n=this.cacheManager.getIdTokensByFilter(t);return Object.values(n).length<1?null:Object.values(n)[0]}readAccessTokenFromCacheForOBO(e,t){let n=t.authenticationScheme||O.BEARER,i={credentialType:n&&n.toLowerCase()!==O.BEARER.toLowerCase()?v.ACCESS_TOKEN_WITH_AUTH_SCHEME:v.ACCESS_TOKEN,clientId:e,target:H.createSearchScopes(this.scopeSet.asArray()),tokenType:n,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash,userAssertionHash:this.userAssertionHash},s=this.cacheManager.getAccessTokensByFilter(i),a=s.length;if(a<1)return null;if(a>1)throw p(z.multipleMatchingTokens);return s[0]}async executeTokenRequest(e,t,n){let o=this.createTokenQueryParameters(e),i=R.appendQueryString(t.tokenEndpoint,o),s=await this.createTokenRequestBody(e),a=this.createTokenRequestHeaders(),c={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},d=Z.nowSeconds(),l=await this.executePostToTokenEndpoint(i,s,a,c,e.correlationId),u=new G(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return u.validateTokenResponse(l.body),await u.handleServerTokenResponse(l.body,this.authority,d,e,void 0,n)}async createTokenRequestBody(e){let t=new Map;I.addClientId(t,this.config.authOptions.clientId),I.addScopes(t,e.scopes),I.addGrantType(t,De.JWT_BEARER),I.addClientInfo(t),I.addLibraryInfo(t,this.config.libraryInfo),I.addApplicationTelemetry(t,this.config.telemetry.application),I.addThrottling(t),this.serverTelemetryManager&&I.addServerTelemetry(t,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();I.addCorrelationId(t,n),I.addRequestTokenUse(t,ii.ON_BEHALF_OF),I.addOboAssertion(t,e.oboAssertion),this.config.clientCredentials.clientSecret&&I.addClientSecret(t,this.config.clientCredentials.clientSecret);let o=this.config.clientCredentials.clientAssertion;return o&&(I.addClientAssertion(t,await he(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),I.addClientAssertionType(t,o.assertionType)),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&I.addClaims(t,e.claims,this.config.authOptions.clientCapabilities),At.mapToQueryString(t)}};var To=class extends on{constructor(e){var i,s,a;super(e);let t=!!this.config.auth.clientSecret,n=!!this.config.auth.clientAssertion,o=(!!((i=this.config.auth.clientCertificate)!=null&&i.thumbprint)||!!((s=this.config.auth.clientCertificate)!=null&&s.thumbprintSha256))&&!!((a=this.config.auth.clientCertificate)!=null&&a.privateKey);if(!this.appTokenProvider){if(t&&n||n&&o||t&&o)throw p(z.invalidClientCredential);if(this.config.auth.clientSecret){this.clientSecret=this.config.auth.clientSecret;return}if(this.config.auth.clientAssertion){this.developerProvidedClientAssertion=this.config.auth.clientAssertion;return}if(o)this.clientAssertion=this.config.auth.clientCertificate.thumbprintSha256?Pe.fromCertificateWithSha256Thumbprint(this.config.auth.clientCertificate.thumbprintSha256,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c):Pe.fromCertificate(this.config.auth.clientCertificate.thumbprint,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c);else throw p(z.invalidClientCredential);this.appTokenProvider=void 0}}SetAppTokenProvider(e){this.appTokenProvider=e}async acquireTokenByClientCredential(e){this.logger.info("acquireTokenByClientCredential called",e.correlationId);let t;e.clientAssertion&&(t={assertion:await he(e.clientAssertion,this.config.auth.clientId),assertionType:Ne.JWT_BEARER_ASSERTION_TYPE});let n=await this.initializeBaseRequest(e),o={...n,scopes:n.scopes.filter(g=>!Qe.includes(g))},i={...e,...o,clientAssertion:t},a=new R(i.authority).getUrlComponents().PathSegments[0];if(Object.values(ye).includes(a))throw p(z.missingTenantIdError);let c=process.env[Ad],d;i.azureRegion!=="DisableMsalForceRegion"&&(!i.azureRegion&&c?d=c:d=i.azureRegion);let l={azureRegion:d,environmentRegion:process.env[yd]},u=this.initializeServerTelemetryManager(wt.acquireTokenByClientCredential,i.correlationId,i.skipCache);try{let g=await this.createAuthority(i.authority,i.correlationId,l,e.azureCloudOptions),m=await this.buildOauthClientConfiguration(g,i.correlationId,"",u),A=new sn(m,this.appTokenProvider);return this.logger.verbose("Client credential client created",i.correlationId),await A.acquireToken(i)}catch(g){throw g instanceof N&&g.setCorrelationId(i.correlationId),u.cacheFailedRequest(g),g}}async acquireTokenOnBehalfOf(e){this.logger.info("acquireTokenOnBehalfOf called",e.correlationId);let t={...e,...await this.initializeBaseRequest(e)};try{let n=await this.createAuthority(t.authority,t.correlationId,void 0,e.azureCloudOptions),o=await this.buildOauthClientConfiguration(n,t.correlationId,"",void 0),i=new Eo(o);return this.logger.verbose("On behalf of client created",t.correlationId),await i.acquireToken(t)}catch(n){throw n instanceof N&&n.setCorrelationId(t.correlationId),n}}};function Ef(r){if(typeof r!="string")return!1;let e=new Date(r);return!isNaN(e.getTime())&&e.toISOString()===r}var Qi=class{constructor(e,t){this.httpClientNoRetries=e,this.retryPolicy=t}async sendNetworkRequestAsyncHelper(e,t,n){return e===J.GET?this.httpClientNoRetries.sendGetRequestAsync(t,n):this.httpClientNoRetries.sendPostRequestAsync(t,n)}async sendNetworkRequestAsync(e,t,n){let o=await this.sendNetworkRequestAsyncHelper(e,t,n),i=0;for(;await this.retryPolicy.pauseForRetry(o.status,i,o.headers[D.RETRY_AFTER]);)o=await this.sendNetworkRequestAsyncHelper(e,t,n),i++;return o}async sendGetRequestAsync(e,t){return this.sendNetworkRequestAsync(J.GET,e,t)}async sendPostRequestAsync(e,t){return this.sendNetworkRequestAsync(J.POST,e,t)}};var Xi={MANAGED_IDENTITY_CLIENT_ID:"client_id",MANAGED_IDENTITY_OBJECT_ID:"object_id",MANAGED_IDENTITY_RESOURCE_ID_IMDS:"msi_res_id",MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS:"mi_res_id"},ct=class{constructor(e,t,n,o,i){this.logger=e,this.nodeStorage=t,this.networkClient=n,this.cryptoProvider=o,this.disableInternalRetries=i}async getServerTokenResponseAsync(e,t,n,o){return this.getServerTokenResponse(e)}getServerTokenResponse(e){var i,s;let t,n;return e.body.expires_on&&(Ef(e.body.expires_on)&&(e.body.expires_on=new Date(e.body.expires_on).getTime()/1e3),n=e.body.expires_on-Z.nowSeconds(),n>2*3600&&(t=n/2)),{status:e.status,access_token:e.body.access_token,expires_in:n,scope:e.body.resource,token_type:e.body.token_type,refresh_in:t,correlation_id:e.body.correlation_id||e.body.correlationId,error:typeof e.body.error=="string"?e.body.error:(i=e.body.error)==null?void 0:i.code,error_description:e.body.message||(typeof e.body.error=="string"?e.body.error_description:(s=e.body.error)==null?void 0:s.message),error_codes:e.body.error_codes,timestamp:e.body.timestamp,trace_id:e.body.trace_id}}async acquireTokenWithManagedIdentity(e,t,n,o){let i=this.createRequest(e.resource,t),s=i.headers;s[D.CONTENT_TYPE]=f.URL_FORM_CONTENT_TYPE;let a={headers:s};Object.keys(i.bodyParameters).length&&(a.body=i.computeParametersBodyString());let c=this.disableInternalRetries?this.networkClient:new Qi(this.networkClient,i.retryPolicy),d=Z.nowSeconds(),l;try{i.httpMethod===J.POST?l=await c.sendPostRequestAsync(i.computeUri(),a):l=await c.sendGetRequestAsync(i.computeUri(),a)}catch(m){throw m instanceof N?m:p(z.networkError)}let u=new G(t.id,this.nodeStorage,this.cryptoProvider,this.logger,null,null),g=await this.getServerTokenResponseAsync(l,c,i,a);return u.validateTokenResponse(g,o),u.handleServerTokenResponse(g,n,d,e)}getManagedIdentityUserAssignedIdQueryParameterKey(e,t){switch(e){case He.USER_ASSIGNED_CLIENT_ID:return this.logger.info("[Managed Identity] Adding user assigned client id to the request."),Xi.MANAGED_IDENTITY_CLIENT_ID;case He.USER_ASSIGNED_RESOURCE_ID:return this.logger.info("[Managed Identity] Adding user assigned resource id to the request."),t?Xi.MANAGED_IDENTITY_RESOURCE_ID_IMDS:Xi.MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS;case He.USER_ASSIGNED_OBJECT_ID:return this.logger.info("[Managed Identity] Adding user assigned object id to the request."),Xi.MANAGED_IDENTITY_OBJECT_ID;default:throw fr(eo)}}};ct.getValidatedEnvVariableUrlString=(r,e,t,n)=>{try{return new R(e).urlString}catch(o){throw n.info(`[Managed Identity] ${t} managed identity is unavailable because the '${r}' environment variable is malformed.`),fr(hr[r])}};var Zi=require("fs"),OC=Se(require("path"),1);var Fb={win32:`${process.env.ProgramData}\\AzureConnectedMachineAgent\\Tokens\\`,linux:"/var/opt/azcmagent/tokens/"},$b={win32:`${process.env.ProgramFiles}\\AzureConnectedMachineAgent\\himds.exe`,linux:"/opt/azcmagent/bin/himds"};var NC="/metadata/identity/oauth2/token",Xb=`http://169.254.169.254${NC}`;var Mf=Se(vf()),Cr=Se(require("fs")),bf="https://login.microsoftonline.com/consumers",Dc="http://localhost:5000",xc=["Tasks.ReadWrite","offline_access"],ss=class{constructor(e,t,n,o){this.clientId=e,this.clientSecret=t,this.redirectUrl=n,this.tokenFilePath=o,this.initClient()}initClient(){let e={auth:{clientId:this.clientId,authority:bf,clientSecret:this.clientSecret}};this.cca=new To(e)}saveTokenCache(){let e=this.cca.getTokenCache().serialize();Cr.writeFileSync(this.tokenFilePath,e)}async getAccessToken(){return new Promise((e,t)=>{let n=`${bf}/oauth2/v2.0/authorize?client_id=${this.clientId}&response_type=code&redirect_uri=${encodeURIComponent(Dc)}&response_mode=query&scope=${encodeURIComponent(xc.join(" "))}&prompt=consent`,o=new Mf.BrowserWindow({width:600,height:700,webPreferences:{nodeIntegration:!1,contextIsolation:!0}});o.loadURL(n),o.webContents.on("will-redirect",async(i,s)=>{try{let a=new URL(s),c=a.searchParams.get("error");if(c)throw new Error("OAuth error: "+c);let d=a.searchParams.get("code");if(!d)return;i.preventDefault(),o.close();let l={code:d,scopes:xc,redirectUri:Dc},u=await this.cca.acquireTokenByCode(l);if(!u)throw new Error("No token response received.");this.saveTokenCache(),e({accessToken:u.accessToken})}catch(a){o.isDestroyed()||o.close(),t(a)}})})}async refreshAccessTokenWithCCA(){if(!Cr.existsSync(this.tokenFilePath))throw new Error("No token cache found. Please login first.");let e=Cr.readFileSync(this.tokenFilePath,"utf8");this.cca.getTokenCache().deserialize(e);let t=this.cca.getTokenCache().serialize(),n=JSON.parse(t);if(!n.RefreshToken)throw new Error("No refresh token found in the cache.");let o=n.RefreshToken,i=Object.keys(o)[0],a={refreshToken:o[i].secret,scopes:xc,redirectUri:Dc};try{let c=await this.cca.acquireTokenByRefreshToken(a);if(!c)throw new Error("No token response received from refresh.");return this.saveTokenCache(),{accessToken:c.accessToken}}catch(c){throw c}}async getToken(){return Cr.existsSync(this.tokenFilePath)?this.refreshAccessTokenWithCCA():this.getAccessToken()}};var Pf=require("obsidian"),as=class extends Pf.Modal{constructor(t,n){super(t);this.onSubmit=n}onOpen(){let{contentEl:t}=this;t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="center",t.style.justifyContent="center",t.style.gap="10px",t.style.minHeight="100px",t.createEl("h2",{text:"Enter Task Title"});let n=t.createEl("input",{type:"text",placeholder:"Task Title"});n.style.width="100%",n.focus(),n.onkeydown=o=>{o.key==="Enter"&&(this.result=n.value,this.close(),this.onSubmit(this.result))}}onClose(){this.contentEl.empty()}};var Df=require("obsidian"),Co=class extends Df.FuzzySuggestModal{constructor(t,n,o,i){super(t);this.items=n,this.getText=o,this.onSelect=i}getItems(){return this.items}getItemText(t){return this.getText(t)}async onChooseItem(t){await this.onSelect(t)}};var cs=class extends cn.Plugin{constructor(){super(...arguments);this.sidebarView=null;this.taskCache=null}notify(t,n="info"){let o="";switch(n){case"error":o="\u274C ";break;case"warning":o="\u26A0\uFE0F ";break;case"success":o="\u2705 ";break}new cn.Notice(o+t)}async onload(){let t=this.app.vault.adapter.basePath,n=Lc.join(t,".obsidian/plugins/sync-obsidian-todo-plugin");if(xf.config({path:Lc.join(n,".env"),override:!0}),await this.loadSettings(),this.addSettingTab(new Oo(this.app,this)),this.registerView(vo,o=>{let i=new No(o,this);return this.sidebarView=i,i}),this.initializeCommand(),this.tokenFilePath=`${n}/token_cache.json`,this.settings.clientId&&this.settings.clientSecret&&(this.authManager=new ss(this.settings.clientId,this.settings.clientSecret,this.settings.redirectUrl,this.tokenFilePath)),ds.existsSync(this.tokenFilePath)){let o=ds.readFileSync(this.tokenFilePath,"utf8");this.authManager.cca.getTokenCache().deserialize(o),console.log("Token cache loaded from file.")}this.injectStyles(),this.notify("Microsoft To-Do Plugin Loaded!","info")}initializeCommand(){this.addCommand({id:"open-microsoft-todo-sidebar",name:"Open Microsoft To-Do Sidebar",callback:async()=>{this.activateSidebar()}}),this.addCommand({id:"login-microsoft-todo",name:"Login to Microsoft To-Do (Interactive)",callback:async()=>{try{this.notify("Logging in..."),await this.authManager.getAccessToken(),this.notify("Logged in successfully!","success")}catch(t){console.error("Authentication error:",t),this.notify("Error logining in! Check the console for details.","error")}}}),this.addCommand({id:"refresh-microsoft-todo-token",name:"Refresh Microsoft To-Do Token",callback:async()=>{try{let t=await this.authManager.refreshAccessTokenWithCCA();this.notify("Token refreshed successfully!","success"),console.log("New Access Token:",t.accessToken)}catch(t){console.error("Error refreshing token:",t),this.notify("Error refreshing token. Check the console for details.","error")}}}),this.addCommand({id:"get-tasks-from-selected-list",name:"Get Tasks from Selected List",callback:async()=>{try{this.notify("Fetching tasks..."),await this.getTasksFromSelectedList(),this.notify("Tasks fetched successfully!","success")}catch(t){console.error("Error fetching tasks from selected list:",t),this.notify("Error fetching tasks. Check the console for details.","error")}}}),this.addCommand({id:"push-all-tasks-from-note",name:"Push All Tasks from Note to Microsoft To-Do",callback:async()=>{try{this.notify("Syncing tasks to Microsoft To-Do...");let t=await this.pushTasksFromNote();this.notify(`Tasks synced successfully! ${t} new tasks added.`,"success"),await this.refreshSidebarView()}catch(t){console.error("Error pushing tasks:",t),this.notify("Error pushing tasks. Check the console for details.","error")}}}),this.addCommand({id:"push-one-task",name:"Create and push Task",callback:async()=>{new as(this.app,async t=>{try{this.notify("Syncing tasks to Microsoft To-Do..."),await this.pushOneTask(t),this.notify("Tasks synced successfully!","success"),await this.refreshSidebarView()}catch(n){console.error("Error pushing tasks:",n),this.notify("Error pushing tasks. Check the console for details.","error")}}).open()}}),this.addCommand({id:"show-not-started-tasks",name:"Show Not Started Tasks List",callback:async()=>{try{this.notify("Opening task list..."),await this.openTaskCompleteModal()}catch(t){console.error("Error completing task:",t),this.notify("Error completing task. Check the console for details.","error")}}}),this.addCommand({id:"select-task-list",name:"Select Task List",callback:async()=>{try{this.notify("Selecting task list..."),await this.openTaskListsModal(),this.notify("Task list selected successfully!","success")}catch(t){console.error("Error selecting task list:",t),this.notify("Error selecting task list. Check the console for details.","error")}}}),this.addCommand({id:"organize-tasks",name:"Organize Tasks from All Notes",callback:async()=>{try{await this.gatherTasks(),this.notify("Tasks organized successfully!","success")}catch(t){console.error("Error organizing tasks:",t),this.notify("Error organizing tasks. Check the console for details.","error")}}}),this.addCommand({id:"delete-completed-tasks",name:"Delete Completed Tasks",callback:async()=>{try{this.notify("Deleting completed tasks...");let t=await this.deleteAllCompletedTasks();this.notify(`${t} completed tasks deleted successfully!`,"success")}catch(t){console.error("Error deleting completed tasks:",t),this.notify("Error deleting tasks. Check the console for details.","error")}}}),this.addCommand({id:"hello-world",name:"Hello World",callback:async()=>{try{console.log("Hello World"),this.notify("THE COMMAND WORKS and Hello World","success")}catch(t){console.error("Error testing:",t)}}}),this.addCommand({id:"testing",name:"Testing",callback:async()=>{try{console.log("Testing"),this.deleteAllCompletedTasks(),this.notify("Task deleted successfully!","success")}catch(t){console.error("Error testing:",t)}}})}injectStyles(){let t=document.createElement("style");t.textContent=`
		.task-line {
			display: flex;
			align-items: center;
			gap: 8px;
			padding: 2px 0;
		}

		.task-line input[type="checkbox"] {
			margin: 0;
			transform: scale(1.1);
		}

		.task-line span {
			font-size: 14px;
		}
	`,document.head.appendChild(t)}async activateSidebar(){let t=this.app.workspace.getRightLeaf(!1);if(!t){console.warn("No right leaf available.");return}await t.setViewState({type:vo,active:!0}),this.app.workspace.revealLeaf(t)}async loadSettings(){this.settings=Object.assign({},jc,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async getAccessToken(){try{return(await this.authManager.getToken()).accessToken}catch(t){throw console.error("Error fetching access token:",t),t}}async loadAvailableTaskLists(){this.notify("Loading task lists...");try{let t=await this.getAccessToken(),n=await Ts(t);console.log("Fetched Task Lists:",n),this.settings.taskLists=n.map(o=>({id:o.id,title:o.title})),this.notify("Task lists loaded successfully!","success")}catch(t){console.error("Error loading task lists:",t),this.notify("Error loading task lists. Check the console for details.","error")}}async getTaskLists(){try{let t=await this.getAccessToken();return await Ts(t)}catch(t){throw console.error("Error fetching task lists:",t),t}}async getTasksFromSelectedList(){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");if(this.taskCache&&this.taskCache.tasks)return console.log("Using cached tasks:",this.taskCache.tasks),new Map(this.taskCache.tasks);try{return await this.refreshTaskCache()}catch(t){throw console.error("Error fetching tasks:",t),t}}async pushTasksFromNote(){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");let t=this.app.workspace.getActiveFile();if(!t)throw new Error("No active file found.");let n=await this.app.vault.read(t),o=/^-\s*\[( |x)\]\s+(.+)$/gm,i=[],s;for(;(s=o.exec(n))!==null;){let a=s[1]==="x",c=s[2].trim();i.push({title:c,complete:a})}if(i.length===0)throw new Error("No tasks found in the active note.");try{let a=await this.getAccessToken(),c=await bo(this.settings,a),d=0;for(let l of i){let u=c.get(l.title);if(u){l.complete&&u.status!=="completed"?await Es(this.settings,a,u.id,!0):console.log(`Task already exists: ${l.title}`);continue}let g=l.complete?"completed":"notStarted";await gs(this.settings,a,l.title,g),d++}return console.log("Synced Tasks:",i),d}catch(a){throw console.error("Error syncing tasks:",a),a}}async pushOneTask(t){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");try{let n=await this.getAccessToken();(await bo(this.settings,n)).get(t)&&console.log(`Task already exists: ${t}`),await gs(this.settings,n,t),await this.refreshSidebarView(),console.log("Synced Tasks:",t)}catch(n){throw console.error("Error syncing tasks:",n),n}}async gatherTasks(){let t="Tasks List.md",n=this.app.vault.getMarkdownFiles(),o=new Map,i=/^\s*-\s*\[( |x)\]\s+(.*)$/gm;for(let d of n){let l=await this.app.vault.read(d),u;for(;(u=i.exec(l))!==null;){let g=u[1]==="x"?"[x]":"[ ]",m=u[2].trim();o.has(m)?g==="[x]"&&o.set(m,"[x]"):o.set(m,g)}}let a=Array.from(o.entries()).map(([d,l])=>`- ${l} ${d}`).join(`
`),c=this.app.vault.getAbstractFileByPath(t);if(!c)await this.app.vault.create(t,a);else if(c instanceof cn.TFile)await this.app.vault.modify(c,a);else throw new Error("Unexpected file type for Tasks List");return o}async openTaskListsModal(){let t=this.settings.taskLists;console.log("Task Lists:",t),new Co(this.app,t,n=>n.title,async n=>{this.settings.selectedTaskListId=n.id,await this.saveSettings(),await this.refreshSidebarView()}).open()}async openTaskCompleteModal(){let t=await this.getTasksFromSelectedList(),n=Array.from(t.values()).filter(o=>o.status!=="completed");new Co(this.app,n,o=>o.status!=="completed"?o.title:"",async o=>{let i=await this.getAccessToken();await Es(this.settings,i,o.id,!0),this.notify(`Task "${o.title}" marked as complete and synced.`,"success"),await this.refreshSidebarView()}).open()}async refreshTaskCache(){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");try{let t=await this.getAccessToken(),n=await bo(this.settings,t);console.log("Fetched Tasks:",n);let o=await this.loadData()||{};return o.tasks=Array.from(n.entries()),await this.saveData(o),this.taskCache=o,n}catch(t){throw console.error("Error fetching tasks:",t),t}}async deleteAllCompletedTasks(){if(!this.settings.selectedTaskListId)throw new Error("No task list selected. Please choose one in settings.");let t=0;try{let n=await this.getAccessToken(),o=await this.getTasksFromSelectedList(),i=Array.from(o.values()).filter(s=>s.status==="completed");for(let s of i)console.log("Deleting Task:",s),await zc(this.settings,n,s.id),t++;return this.refreshSidebarView(),t}catch(n){return console.error("Error deleting tasks:",n),t}}async refreshSidebarView(){this.sidebarView?await this.sidebarView.render():console.warn("Sidebar view is not active.")}};
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

@azure/msal-node/dist/cache/serializer/Serializer.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-common/dist/utils/Constants.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/AuthErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/AuthError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ClientAuthErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ClientAuthError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/crypto/ICrypto.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/logger/Logger.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/packageMetadata.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/AuthorityOptions.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/AuthToken.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/TimeUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/cache/utils/CacheHelpers.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ClientConfigurationErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ClientConfigurationError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/StringUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/request/ScopeSet.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/ClientInfo.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/AccountInfo.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/AuthorityType.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/TokenClaims.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/ProtocolMode.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/cache/entities/AccountEntity.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/UrlUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/url/UrlString.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/AuthorityMetadata.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/CacheErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/CacheError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/cache/CacheManager.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/config/ClientConfiguration.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/account/CcsCredential.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/constants/AADServerParamKeys.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/request/RequestParameterBuilder.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/OpenIdConfigResponse.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/CloudInstanceDiscoveryResponse.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/CloudInstanceDiscoveryErrorResponse.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/telemetry/performance/PerformanceEvent.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/FunctionWrappers.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/RegionDiscovery.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/Authority.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/authority/AuthorityFactory.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/ServerError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/network/RequestThumbprint.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/network/ThrottlingUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/NetworkError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/client/BaseClient.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/InteractionRequiredAuthErrorCodes.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/error/InteractionRequiredAuthError.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/ProtocolUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/crypto/PopTokenGenerator.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/cache/persistence/TokenCacheContext.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/response/ResponseHandler.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/request/RequestValidator.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/utils/ClientAssertionUtils.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/client/AuthorizationCodeClient.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/client/RefreshTokenClient.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/client/SilentFlowClient.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/protocol/Authorize.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/telemetry/server/ServerTelemetryManager.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-common/dist/index-node.mjs:
  (*! @azure/msal-common v15.4.0 2025-03-25 *)

@azure/msal-node/dist/cache/serializer/Deserializer.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/internals.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/utils/Constants.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/utils/NetworkUtils.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/network/HttpClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/error/ManagedIdentityErrorCodes.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/error/ManagedIdentityError.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/config/ManagedIdentityId.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/error/NodeAuthError.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/config/Configuration.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/crypto/GuidGenerator.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/utils/EncodingUtils.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/crypto/HashUtils.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/crypto/PkceGenerator.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/crypto/CryptoProvider.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/cache/NodeStorage.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/cache/TokenCache.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ClientAssertion.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/packageMetadata.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/UsernamePasswordClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/protocol/Authorize.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ClientApplication.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/network/LoopbackClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/DeviceCodeClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/PublicClientApplication.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ClientCredentialClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/OnBehalfOfClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ConfidentialClientApplication.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/utils/TimeUtils.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/network/HttpClientWithRetries.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/BaseManagedIdentitySource.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/retry/LinearRetryPolicy.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/config/ManagedIdentityRequestParameters.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/AppService.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/AzureArc.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/CloudShell.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/Imds.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/ServiceFabric.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentitySources/MachineLearning.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentityClient.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/client/ManagedIdentityApplication.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/cache/distributed/DistributedCachePlugin.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)

@azure/msal-node/dist/index.mjs:
  (*! @azure/msal-node v3.4.1 2025-03-25 *)
*/
